Return-Path: <linux-nvdimm-bounces@lists.01.org>
X-Original-To: lists+linux-nvdimm@lfdr.de
Delivered-To: lists+linux-nvdimm@lfdr.de
Received: from ml01.01.org (ml01.01.org [IPv6:2001:19d0:306:5::1])
	by mail.lfdr.de (Postfix) with ESMTPS id C4091FC804
	for <lists+linux-nvdimm@lfdr.de>; Thu, 14 Nov 2019 14:41:54 +0100 (CET)
Received: from new-ml01.vlan13.01.org (localhost [IPv6:::1])
	by ml01.01.org (Postfix) with ESMTP id 9EC7B100DC3CD;
	Thu, 14 Nov 2019 05:43:23 -0800 (PST)
Received-SPF: Pass (mailfrom) identity=mailfrom; client-ip=148.163.156.1; helo=mx0a-001b2d01.pphosted.com; envelope-from=fbarrat@linux.ibm.com; receiver=<UNKNOWN> 
Received: from mx0a-001b2d01.pphosted.com (mx0a-001b2d01.pphosted.com [148.163.156.1])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ml01.01.org (Postfix) with ESMTPS id 0D0ED100DC3CB
	for <linux-nvdimm@lists.01.org>; Thu, 14 Nov 2019 05:43:21 -0800 (PST)
Received: from pps.filterd (m0098394.ppops.net [127.0.0.1])
	by mx0a-001b2d01.pphosted.com (8.16.0.27/8.16.0.27) with SMTP id xAEDTUSM126195
	for <linux-nvdimm@lists.01.org>; Thu, 14 Nov 2019 08:41:50 -0500
Received: from e06smtp04.uk.ibm.com (e06smtp04.uk.ibm.com [195.75.94.100])
	by mx0a-001b2d01.pphosted.com with ESMTP id 2w96mj3p8w-1
	(version=TLSv1.2 cipher=AES256-GCM-SHA384 bits=256 verify=NOT)
	for <linux-nvdimm@lists.01.org>; Thu, 14 Nov 2019 08:41:49 -0500
Received: from localhost
	by e06smtp04.uk.ibm.com with IBM ESMTP SMTP Gateway: Authorized Use Only! Violators will be prosecuted
	for <linux-nvdimm@lists.01.org> from <fbarrat@linux.ibm.com>;
	Thu, 14 Nov 2019 13:41:45 -0000
Received: from b06cxnps4074.portsmouth.uk.ibm.com (9.149.109.196)
	by e06smtp04.uk.ibm.com (192.168.101.134) with IBM ESMTP SMTP Gateway: Authorized Use Only! Violators will be prosecuted;
	(version=TLSv1/SSLv3 cipher=AES256-GCM-SHA384 bits=256/256)
	Thu, 14 Nov 2019 13:41:37 -0000
Received: from d06av23.portsmouth.uk.ibm.com (d06av23.portsmouth.uk.ibm.com [9.149.105.59])
	by b06cxnps4074.portsmouth.uk.ibm.com (8.14.9/8.14.9/NCO v10.0) with ESMTP id xAEDfZDD48955474
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
	Thu, 14 Nov 2019 13:41:35 GMT
Received: from d06av23.portsmouth.uk.ibm.com (unknown [127.0.0.1])
	by IMSVA (Postfix) with ESMTP id A15F0A404D;
	Thu, 14 Nov 2019 13:41:35 +0000 (GMT)
Received: from d06av23.portsmouth.uk.ibm.com (unknown [127.0.0.1])
	by IMSVA (Postfix) with ESMTP id 7BD14A4040;
	Thu, 14 Nov 2019 13:41:34 +0000 (GMT)
Received: from pic2.home (unknown [9.145.79.162])
	by d06av23.portsmouth.uk.ibm.com (Postfix) with ESMTP;
	Thu, 14 Nov 2019 13:41:34 +0000 (GMT)
Subject: Re: [PATCH 08/10] nvdimm: Add driver for OpenCAPI Storage Class
 Memory
To: "Alastair D'Silva" <alastair@au1.ibm.com>, alastair@d-silva.org
References: <20191025044721.16617-1-alastair@au1.ibm.com>
 <20191025044721.16617-9-alastair@au1.ibm.com>
From: Frederic Barrat <fbarrat@linux.ibm.com>
Date: Thu, 14 Nov 2019 14:41:34 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.1.1
MIME-Version: 1.0
In-Reply-To: <20191025044721.16617-9-alastair@au1.ibm.com>
Content-Language: en-US
X-TM-AS-GCONF: 00
x-cbid: 19111413-0016-0000-0000-000002C39DF6
X-IBM-AV-DETECTION: SAVI=unused REMOTE=unused XFE=unused
x-cbparentid: 19111413-0017-0000-0000-00003325400F
Message-Id: <8232c1a6-d52a-6c32-6178-de082174a92a@linux.ibm.com>
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10434:,, definitions=2019-11-14_03:,,
 signatures=0
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0 priorityscore=1501
 malwarescore=0 suspectscore=2 phishscore=0 bulkscore=0 spamscore=0
 clxscore=1015 lowpriorityscore=0 mlxscore=0 impostorscore=0
 mlxlogscore=999 adultscore=0 classifier=spam adjust=0 reason=mlx
 scancount=1 engine=8.0.1-1910280000 definitions=main-1911140125
Message-ID-Hash: EWLNYLHM6F4OOQQB4KSCPEDWD74NU6XD
X-Message-ID-Hash: EWLNYLHM6F4OOQQB4KSCPEDWD74NU6XD
X-MailFrom: fbarrat@linux.ibm.com
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: Oscar Salvador <osalvador@suse.com>, Michal Hocko <mhocko@suse.com>, David Hildenbrand <david@redhat.com>, Alexey Kardashevskiy <aik@ozlabs.ru>, Wei Yang <richard.weiyang@gmail.com>, Masahiro Yamada <yamada.masahiro@socionext.com>, Paul Mackerras <paulus@samba.org>, Thomas Gleixner <tglx@linutronix.de>, Pavel Tatashin <pasha.tatashin@soleen.com>, linux-nvdimm@lists.01.org, Krzysztof Kozlowski <krzk@kernel.org>, Mahesh Salgaonkar <mahesh@linux.vnet.ibm.com>, Andrew Donnellan <ajd@linux.ibm.com>, Arnd Bergmann <arnd@arndb.de>, Greg Kurz <groug@kaod.org>, Nicholas Piggin <npiggin@gmail.com>, Qian Cai <cai@lca.pw>, =?UTF-8?Q?C=c3=a9dric_Le_Goater?= <clg@kaod.org>, Hari Bathini <hbathini@linux.ibm.com>, David Gibson <david@gibson.dropbear.id.au>, linux-mm@kvack.org, Greg Kroah-Hartman <gregkh@linuxfoundation.org>, linux-kernel@vger.kernel.org, Andrew Morton <akpm@linux-foundation.org>, linuxppc-dev@lists.ozlabs.org
X-Mailman-Version: 3.1.1
Precedence: list
List-Id: "Linux-nvdimm developer list." <linux-nvdimm.lists.01.org>
Archived-At: <https://lists.01.org/hyperkitty/list/linux-nvdimm@lists.01.org/message/EWLNYLHM6F4OOQQB4KSCPEDWD74NU6XD/>
List-Archive: <https://lists.01.org/hyperkitty/list/linux-nvdimm@lists.01.org/>
List-Help: <mailto:linux-nvdimm-request@lists.01.org?subject=help>
List-Post: <mailto:linux-nvdimm@lists.01.org>
List-Subscribe: <mailto:linux-nvdimm-join@lists.01.org>
List-Unsubscribe: <mailto:linux-nvdimm-leave@lists.01.org>
Content-Type: text/plain; charset="utf-8"; format="flowed"
Content-Transfer-Encoding: base64

SGkgQWxhc3RhaXIsDQoNClRoZSBwYXRjaCBpcyBodWdlIGFuZCBjb3VsZC9zaG91bGQgcHJvYmFi
bHkgYmUgc3BsaXQgaW4gc21hbGxlciBwaWVjZXMgDQp0byBlYXNlIHRoZSByZXZpZXcuIEhvd2V2
ZXIsIGhhdmluZyBzaW5uZWQgb24gdGhhdCBzYW1lIHRvcGljIGluIHRoZSANCnBhc3QsIEkgbWFk
ZSBhIGZpcnN0IHBhc3MgYW55d2F5LiBJIGhhdmVuJ3QgY292ZXJlZCBldmVyeXRoaW5nIGJ1dCB0
cmllZCANCnRvIGZvY3VzIG9uIHRoZSBnZW5lcmFsIHNldHVwIG9mIHRoZSBkcml2ZXIgZm9yIG5v
dy4NClNpbmNlIHRoZSBwYXRjaCBpcyB2ZXJ5IGxvbmcsIEknbSB3cml0aW5nIGFsbCB0aGUgY29t
bWVudHMgaW4gb25lIGNodW5rIA0KaGVyZSBpbnN0ZWFkIG9mIHNwcmVhZGluZyB0aGVtIG92ZXIg
YSBmZXcgdGhvdXNhbmQgbGluZXMsIHdoZXJlIHNvbWUgDQp3b3VsZCBiZSBlYXN5IHRvIG1pc3Mu
DQoNCg0KVXBkYXRlIE1BSU5UQUlORVJTIGZvciB0aGUgbmV3IGZpbGVzDQoNCkhhdmUgeW91IGRp
c2N1c3NlZCB3aXRoIHRoZSBkaXJlY3Rvcnkgb3duZXIgaWYgaXQncyBvayB0byBzcGxpdCB0aGUg
DQpkcml2ZXIgb3ZlciBzZXZlcmFsIGZpbGVzPw0KDQoNCktjb25maWcNCj09PT09PT0NCkRvZXMg
aXQgbWFrZSBzZW5zZSB0byBrZWVwIE9DWExfU0NNX0RFQlVHIHNlcGFyYXRlPyBXaHkgbm90IGVu
YWJsaW5nIGl0IA0KYnkgZGVmYXVsdD8NCg0KDQpvY3hsX3NjbS5jDQo9PT09PT09PT09DQoNCnNj
bV9maWxlX2luaXQoKQ0KLS0tLS0tLS0tLS0tLS0tDQpvbiBlcnJvciBwYXRocywgc2hvdWxkIGNh
bGwgaWRyX2Rlc3Ryb3koKSAoc2FtZSBwYiBmb3VuZCBpbiBiYXNlIG9jeGwgDQpkcml2ZXIpDQoN
Cg0Kc2NtX3Byb2JlKCkgYW5kIF9mdW5jdGlvbl8wKCkNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tDQoNClRoZSBkaWZmZXJlbnQgaW5pdCBiZXR3ZWVuIGZ1bmN0aW9uIDAgYW5kIDEgbG9v
a3MgYSBiaXQgb2ZmIGFuZCBpdCBzZWVtcyANCnRoZXkgY291bGQgYmUgdW5pZmllZC4gRnVuY3Rp
b24gMSBkb2VzIHRoZSBzYW1lIHRoaW5nIGFzIGZ1bmN0aW9uIDAgDQooY2FsbCBvY3hsX2Z1bmN0
aW9uX29wZW4oKSkgdGhlbiBzb21lIEFGVS1zcGVjaWZpYyBpbml0LCB3aGljaCB3ZSBjb3VsZCAN
CnNraXAgaWYgdGhlcmUncyBubyBBRlUgZm91bmQgb24gdGhlIGZ1bmN0aW9uLiBBbmQgbG9nIGEg
V0FSTiBpZiB3ZSBmaW5kIA0KYW4gQUZVIG9uIHNvbWV0aGluZyBlbHNlIHRoYW4gZnVuY3Rpb24g
MSwgc2luY2UsIHVubGlrZSBvY3hsLCB3ZSBrbm93IA0KZXhhY3RseSB3aGF0IHRoZSBkZXZpY2Ug
aXMgbGlrZSBmb3IgU0NNLiBCdXQga2VlcCBhbiBjb21tb24gcHJvYmUoKSANCmZ1bmN0aW9uLiBJ
dCB3b3VsZCBhbHNvIHNpbXBsaWZ5IHRoZSBmbG93IG9uIHNjbV9yZW1vdmUoKSBhbmQgYXZvaWQg
DQpwcm9ibGVtcyAoY3VycmVudGx5IG9jeGxfZnVuY3Rpb25fY2xvc2UoKSBpcyBub3QgY2FsbGVk
IGZvciBmdW5jdGlvbiAxKS4NCg0Kc2NtLWRhdGEtPnRpbWVvdXRzOiBhcnJheSBvZiBzaXplIDkg
ZGVjbGFyZWQsIHdlIG9ubHkgaW5pdCA3IG1lbWJlcnMuIA0KV2l0aCB0aGUgemFsbG9jKCkgdGhl
IG90aGVycyBhcmUgYXQgMCwgaXMgdGhhdCBjb3JyZWN0Pw0KDQoNClNvbWV0aGluZyBsb29rcyB3
cm9uZyByZWdhcmRpbmcgZGF0YSByZWxlYXNlIGluIHRoZSBlcnJvciBwYXRoKHMpLiBJSVVDLCAN
CndlIHJlZ2lzdGVyIHRoZSBkZXZpY2UgZWFybHkgYW5kIHJlbHkgb24gdGhlIHJlbGVhc2UgY2Fs
bGJhY2sgb2YgdGhlIA0KZGV2aWNlIHRvIGZyZWUgYWxsIHJlc291cmNlcyAoaW4gZnJlZV9zY21f
ZGV2KCkpLiBXZSBzaG91bGQgcHJvYmFibHkgDQpoYXZlIGEgY29tbWVudCBpbiBwcm9iZSgpIHRv
IG1ha2UgaXQgb2J2aW91cy4gT3IgbWF5YmUgYmV0dGVyLCBoYXZlIGEgDQpzdWJmdW5jdGlvbiB0
byBrZWVwIGRvaW5nIHRoZSByZXN0IG9mIHRoZSBpbml0cyB3aGljaCBhcmUgZGVwZW5kZW50IG9u
IA0KdGhlIGRldmljZSByZWxlYXNlIHRvIGJlIGNsZWFuZWQgdXAuIEluIHRoZSBzdWJzZXF1ZW50
IGVycm9yIHBhdGhzIGluIA0Kc2NtX3Byb2JlKCksIHdlIGFyZSBtaXNzaW5nIGEgZGV2aWNlX3Vu
cmVnaXN0ZXIoKQ0KDQpDb3VsZCBsb2cgMTIwIHRpbWVzIHRoZSBzYW1lICJXYWl0aW5nIGZvciBT
Q00gdG8gYmVjb21lIHVzYWJsZSIgbWVzc2FnZSwgDQp3aGljaCBpcyBub3QgcmVhbGx5IGhlbHBp
bmcgbXVjaC4NCg0KDQpmcmVlX3NjbSgpDQotLS0tLS0tLS0NClJlbGF0ZWQgdG8gYWJvdmUgY29t
bWVudCBpbiBwcm9iZSgpLCBpdCB3b3VsZCBoZWxwIHRvIGJlIGFibGUgdG8gZWFzaWx5IA0KbWF0
Y2ggdGhlIHdoYXQncyBkb25lIGluIHByb2JlIHZzLiB1bmRvbmUgaGVyZS4gRm9yIGV4YW1wbGUs
IGluIHByb2JlKCksIA0KdGhlcmUncyBzY21fc2V0dXBfaXJxKCksIHdoZXJlIHdlIGRvIGFsbCB0
aGluZ3MgcmVsYXRlZCB0byBpbnRlcnJ1cHRzLiANCkJ1dCB3ZSBkb24ndCBoYXZlIGEgc3ViZnVu
Y3Rpb24gdG8gY2xlYW4gdGhlIGludGVycnVwdHMgc3RhdGUuIEl0IHdvdWxkIA0KaGVscCBmb3Ig
cmVhZGFiaWxpdHkgYW5kIHRyYWNrIHBvdGVudGlhbCBtaXNzZXMuIEkgZGlkbid0IHRyaWVkIHRv
IG1hdGNoIA0KYWxsIG9mIHRoZW0sIGJ1dCB0aGUgZm9sbG93aW5nIGNhbGxzIHNlZW0gbWlzc2lu
ZzoNCg0Kb2N4bF9jb250ZXh0X2RldGFjaCgpDQpvY3hsX2FmdV9pcnFfZnJlZSgpDQoNCg0Kb2N4
bF9yZW1vdmUoKQ0KLS0tLS0tLS0tLS0tLQ0Kc2VlIGNvbW1lbnQgYWJvdmUgYWJvdXQgdW5pZnlp
bmcgZnVuY3Rpb24gMCBhbmQgMSBjYXNlLg0KV2h5IGlzIG52ZGltbV9idXNfdW5yZWdpc3Rlcigp
IHRyZWF0ZWQgc2VwYXJhdGVseT8gQ2FuJ3QgaXQgYmUgcGFydCBvZiANCnRoZSAibm9ybWFsIiBm
cmVlaW5nIG9mIHJlc291cmNlcyBkb25lIGltcGxpY2l0bHkgd2hlbiBjYWxsaW5nIA0KZGV2aWNl
X3VucmVnaXN0ZXIoKSBpbiB0aGUgZnJlZV9zY20oKSBjYWxsYmFjaz8NCg0KDQpzY21fc2V0dXBf
ZGV2aWNlX21ldGFkYXRhKCkNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KZnVuY3Rpb24g
ZG9lc24ndCBkbyBhbnkgc2V0dXAsIHNvIHRoZSBuYW1lIGlzIG1pc2xlYWRpbmcuDQoNCglmb3Ig
KGkgPSAwOyBpIDwgODsgaSsrKQ0KCQlzY21fZGF0YS0+ZndfdmVyc2lvbltpXSA9ICh2YWwgPj4g
KGkgKiA4KSkgJiAweGZmOw0KPT4gbG9va3MgbGlrZSBhbiBlbmRpYW5lc3MgY29udmVyc2lvbj8g
Q2FuJ3Qgd2UgdXNlIHRoZSBPQ1hMX0JJR19FTkRJQU4gDQp3aGVuIGRvaW5nIHRoZSBtbWlvIHJl
YWQ/DQoNCg0Kc2NtX3NldHVwX2lycSgpDQotLS0tLS0tLS0tLS0tLS0NCmlmIG9jeGxfYWZ1X2ly
cV9nZXRfYWRkcihpcnEgMSkgb3IgdGhlIGlvcmVtYXAoaXJxIDEpIGZhaWwsIHdlIGp1bXAgdG8g
DQp0aGUgbGFiZWwgJ291dF9pcnEwJyBhbmQgd2lsbCBleGl0IHRoZSBmdW5jdGlvbiB3aXRoIHJj
ID0gMCwgaW5zdGVhZCBvZiANCmZhaWxpbmcuDQoNCg0KDQpzY21fc2V0dXBfY29tbWFuZF9tZXRh
ZGF0YSgpDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQppdCB3b3VsZCBtYWtlIHNlbnNl
IHRvIGluaXRpYWxpemUgdGhlIG11dGV4IGluIHRoZSBzdHJ1Y3QgDQpjb21tYW5kX21ldGFkYXRh
IGluIHRoaXMgZnVuY3Rpb24gaW5zdGVhZCBvZiB0aGUgdG9wIG9mIHNjbV9wcm9iZSgpLCB0byAN
Cmdyb3VwIGFsbCB0aGUgcmVsYXRlZCBkYXRhIGluaXRzLg0KDQoNCg0Kc2NtX3Byb2JlX2Z1bmN0
aW9uXzAoKQ0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KY29tbWVudCBhYm92ZSBmdW5jdGlvbjoN
CiAgKiBUaGlzIGlzIGltcG9ydGFudCBhcyBpdCBlbmFibGVzIGhpZ2hlciB0aGFuIDAgYWNyb3Nz
IGFsbCBvdGhlciANCmZ1bmN0aW9ucywNCiAgKiB3aGljaCBpbiB0dXJuIGVuYWJsZXMgaGlnaGVy
IGJhbmR3aWR0aCBhY2Nlc3Nlcw0KDQoiaGlnaGVyIHRoYW4gMCI/DQpJJ20gZ3Vlc3NpbmcgeW91
IHdhbnQgdG8gc2F5IGZ1bmN0aW9uIDAgY29uZmlndXJlcyB0aGUgbGluaywgdG8gZW5zdXJlIA0K
bWF4aW11bSBiYW5kd2lkdGgNCg0KRUZBVUxUIGlzIHVzdWFsbHkgcmVzZXJ2ZWQgZm9yIGFuIGlu
dmFsaWQgbWVtb3J5IGFjY2Vzcy4gV2h5IG5vdCANClBUUl9FUlIoKSBvZiB0aGUgcmV0dXJuZWQg
dmFsdWUgZnJvbSBvY3hsX2Z1bmN0aW9uX29wZW4oKT8NCg0KDQoNCnN0cnVjdCBzY21fZm9wcyBo
YXMgYSB3cm9uZyBpbmRlbnRhdGlvbiAoc3BhY2VzIGJldHdlZW4gLm9wZW4gYW5kICc9JykNCg0K
DQoNCnNjbV9oZWFydGJlYXQoKQ0KLS0tLS0tLS0tLS0tLS0tDQp0aGUgImdvdG8gb3V0IiBhdCB0
aGUgZW5kIG9mIHRoZSBnb29kIHBhdGggaXMgdXNlbGVzcyBhbmQgdW51c3VhbCBpbiB0aGUgDQpr
ZXJuZWwsIEkgdGhpbmsuDQoNCg0Kc2NtX3JlZ2lzdGVyX2xwY19tZW0oKQ0KLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQ0KbHBjX21lbSA9IG9jeGxfYWZ1X2xwY19tZW0oc2NtX2RhdGEtPm9jeGxfYWZ1
KTsNCj0+IGxwY19tZW0gaXMgYWxsb2NhdGVkIGFzIHBhcnQgb2YgdGhlIGFmdSBzdHJ1Y3R1cmUg
aW4gb2N4bCwgc28gdGhhdCANCnNob3VsZG4ndCBiZSBOVUxMLiBTdGlsbCB3b3J0aCBrZWVwaW5n
LCBidXQgSSB0aGluayBscGNfbWVtLT5zdGFydCBpcyANCndoYXQgcmVhbGx5IG5lZWRzIHRlc3Rp
bmcNCg0KDQpzY21faW1uMF9oYW5kbGVyKCkNCi0tLS0tLS0tLS0tLS0tLS0tDQpJIGRvbid0IHRo
aW5rIHdlIHNob3VsZCByZXR1cm4gSVJRX05PTkUuIEFzIGZhciBhcyB0aGUga2VybmVsIGlzIA0K
Y29uY2VybmVkLCBhbiBpbnRlcnJ1cHQgd2FzIHJhaXNlZC4gU28gaXQgc2hvdWxkIGJlIGFja25v
d2xlZGdlZCwgZXZlbiANCmlmIHRoZSBmZ3BhIGlzIHNvbWVob3cgaW4gYW4gaW5jb3JyZWN0IHN0
YXRlLiBTbyB0aGUgSVJRX05PTkUgc2hvdWxkIGJlIA0KSVJRX0hBTkRMRUQNCg0KDQpzY21faW1u
MV9oYW5kbGVyKCkNCi0tLS0tLS0tLS0tLS0tLS0tLQ0KZm9yIHRoZSBzYWtlIG9mIGNsYXJpdHks
IHRoZSBwb3RlbnRpYWwgZXJyb3Igd2hlbiBjYWxsaW5nIHNjbV9jaGkoKSANCnNob3VsZCBiZSB0
cmVhdGVkIHRoZSBzYW1lIGluIHRoZSAyIGhhbmRsZXJzLg0KV2hhdCdzIHRoZSBlZmZlY3Qgb2Yg
bnZkaW1tX2J1c191bnJlZ2lzdGVyKCkgb24gYW55IGFwcGxpY2F0aW9uIHVzaW5nIA0KdGhlIG1l
bW9yeT8NCg0KDQojaWZkZWYgQ09ORklHX09DWExfU0NNX0RFQlVHDQpJdCdzIHVzdWFsIGFuZCBp
dCBoZWxwcyBuYXZpZ2F0ZSB0aGUgY29kZSwgdG8gY29tbWVudCB0aGUgY29uZmlnIG1hY3JvIA0K
b24gdGhlIGVsc2UgYW5kIGVuZGlmIGxpbmVzOg0KI2VuZGlmIC8qIENPTkZJR19PQ1hMX1NDTV9E
RUJVRyAqLw0KDQoNCg0KDQpvY3hsLXNjbV9pbnRlcm5hbC5jDQo9PT09PT09PT09PT09PT09PT09
PQ0KDQpzY21fYWRtaW5fY29tbWFuZF9yZXF1ZXN0DQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
DQpIYXJkZW5pbmc6IHdvdWxkIGl0IG1ha2Ugc2Vuc2UgdG8gdGVzdCBhbmQgZXJyb3Igb3V0IGlm
IHRoZSBBQ1JBIGJpdCANCih1c2VkIHRvIHRlc3QgY29tbWFuZCBpcyBjb21wbGV0ZSkgaXMgYXQg
MCBiZWZvcmUgc3VibWl0dGluZyBhIG5ldyByZXF1ZXN0Pw0KDQoNCnNjbV9hZG1pbl9jb21tYW5k
X2NvbXBsZXRlX3RpbWVvdXQNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCkEg
ZGVsYXkgb2YgMzJtcyBpcyBub3QgdGhhdCB1c3VhbC4gQSBjb21tZW50IGV4cGxhaW5pbmcgd2h5
IHdvdWxkIGJlIA0KaW50ZXJlc3RpbmcuDQoNCldoeSB0aW1lb3V0KysgPw0KDQoNCg0Kb2N4bC1z
Y21fc3lzZnMuYw0KPT09PT09PT09PT09PT09PQ0KTm8gcmVhc29uIHRvIGV4cG9ydCB0aGUgc2Nt
X3N5c2ZzX2FkZCBzeW1ib2wNCg0KDQoNCm9jeGxfc2NtLmgNCj09PT09PT09PT0NCnN0cnVjdCBz
Y21faW9jdGxfZXJyb3JfbG9nOg0KY2hhciAgZndfcmV2aXNpb25bOCsxXQ0KZXhwb3NlZCB0byB1
bmNvbnRyb2xsZWQgcGFkZGluZywgd2hpY2ggaXMgYSBwcm9ibGVtIGZvciBhIEtBQkkNClJlbW92
ZSB0aGUgZXh0cmEgY2hhcj8NCg0KDQoNCm1lbW9yeV9ob3RwbHVnLmMNCj09PT09PT09PT09PT09
PT0NCndoaXRlc3BhY2UgZGlmZiBzaG91bGRuJ3QgYmUgaGVyZQ0KDQoNCiAgIEZyZWQNCg0KDQpM
ZSAyNS8xMC8yMDE5IMOgIDA2OjQ3LCBBbGFzdGFpciBEJ1NpbHZhIGEgw6ljcml0wqA6DQo+IEZy
b206IEFsYXN0YWlyIEQnU2lsdmEgPGFsYXN0YWlyQGQtc2lsdmEub3JnPg0KPiANCj4gVGhpcyBk
cml2ZXIgZXhwb3NlcyBMUEMgbWVtb3J5IG9uIE9wZW5DQVBJIFNDTSBjYXJkcw0KPiBhcyBhbiBO
VkRJTU0sIGFsbG93aW5nIHRoZSBleGlzdGluZyBudnJhbSBpbmZyYXN0cnVjdHVyZQ0KPiB0byBi
ZSB1c2VkLg0KPiANCj4gU2lnbmVkLW9mZi1ieTogQWxhc3RhaXIgRCdTaWx2YSA8YWxhc3RhaXJA
ZC1zaWx2YS5vcmc+DQo+IC0tLQ0KPiAgIGRyaXZlcnMvbnZkaW1tL0tjb25maWcgICAgICAgICAg
ICAgfCAgIDE3ICsNCj4gICBkcml2ZXJzL252ZGltbS9NYWtlZmlsZSAgICAgICAgICAgIHwgICAg
MyArDQo+ICAgZHJpdmVycy9udmRpbW0vb2N4bC1zY20uYyAgICAgICAgICB8IDIyMTAgKysrKysr
KysrKysrKysrKysrKysrKysrKysrKw0KPiAgIGRyaXZlcnMvbnZkaW1tL29jeGwtc2NtX2ludGVy
bmFsLmMgfCAgMjMyICsrKw0KPiAgIGRyaXZlcnMvbnZkaW1tL29jeGwtc2NtX2ludGVybmFsLmgg
fCAgMzMxICsrKysrDQo+ICAgZHJpdmVycy9udmRpbW0vb2N4bC1zY21fc3lzZnMuYyAgICB8ICAy
MTkgKysrDQo+ICAgaW5jbHVkZS91YXBpL2xpbnV4L29jeGwtc2NtLmggICAgICB8ICAxMjggKysN
Cj4gICBtbS9tZW1vcnlfaG90cGx1Zy5jICAgICAgICAgICAgICAgIHwgICAgMiArLQ0KPiAgIDgg
ZmlsZXMgY2hhbmdlZCwgMzE0MSBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pDQo+ICAgY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbnZkaW1tL29jeGwtc2NtLmMNCj4gICBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9udmRpbW0vb2N4bC1zY21faW50ZXJuYWwuYw0KPiAgIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL252ZGltbS9vY3hsLXNjbV9pbnRlcm5hbC5oDQo+ICAgY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvbnZkaW1tL29jeGwtc2NtX3N5c2ZzLmMNCj4gICBjcmVhdGUg
bW9kZSAxMDA2NDQgaW5jbHVkZS91YXBpL2xpbnV4L29jeGwtc2NtLmgNCj4gDQo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL252ZGltbS9LY29uZmlnIGIvZHJpdmVycy9udmRpbW0vS2NvbmZpZw0KPiBp
bmRleCAzNmFmN2FmNmI3Y2YuLmU0ZjdiNmIwOGVmZCAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9u
dmRpbW0vS2NvbmZpZw0KPiArKysgYi9kcml2ZXJzL252ZGltbS9LY29uZmlnDQo+IEBAIC0xMzAs
NCArMTMwLDIxIEBAIGNvbmZpZyBOVkRJTU1fVEVTVF9CVUlMRA0KPiAgIAkgIGNvcmUgZGV2bV9t
ZW1yZW1hcF9wYWdlcygpIGltcGxlbWVudGF0aW9uIGFuZCBvdGhlcg0KPiAgIAkgIGluZnJhc3Ry
dWN0dXJlLg0KPiAgIA0KPiArY29uZmlnIE9DWExfU0NNDQo+ICsJdHJpc3RhdGUgIk9wZW5DQVBJ
IFN0b3JhZ2UgQ2xhc3MgTWVtb3J5Ig0KPiArCWRlcGVuZHMgb24gTElCTlZESU1NDQo+ICsJc2Vs
ZWN0IFpPTkVfREVWSUNFDQo+ICsJc2VsZWN0IE9DWEwNCj4gKwloZWxwDQo+ICsJICBFeHBvc2Vz
IGRldmljZXMgdGhhdCBpbXBsZW1lbnQgdGhlIE9wZW5DQVBJIFN0b3JhZ2UgQ2xhc3MgTWVtb3J5
DQo+ICsJICBzcGVjaWZpY2F0aW9uIGFzIHBlcnNpc3RlbnQgbWVtb3J5IHJlZ2lvbnMuDQo+ICsN
Cj4gKwkgIFNlbGVjdCBOIGlmIHVuc3VyZS4NCj4gKw0KPiArY29uZmlnIE9DWExfU0NNX0RFQlVH
DQo+ICsJYm9vbCAiT3BlbkNBUEkgU3RvcmFnZSBDbGFzcyBNZW1vcnkgZGVidWdnaW5nIg0KPiAr
CWRlcGVuZHMgb24gT0NYTF9TQ00NCj4gKwloZWxwDQo+ICsJICBFbmFibGVzIGxvdyBsZXZlbCBJ
T0NUTHMgZm9yIE9wZW5DQVBJIFNDTSBmaXJtd2FyZSBkZXZlbG9wbWVudA0KPiArDQo+ICAgZW5k
aWYNCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbnZkaW1tL01ha2VmaWxlIGIvZHJpdmVycy9udmRp
bW0vTWFrZWZpbGUNCj4gaW5kZXggMjkyMDNmM2QzMDY5Li40M2Q4MjYzOTdiZmMgMTAwNjQ0DQo+
IC0tLSBhL2RyaXZlcnMvbnZkaW1tL01ha2VmaWxlDQo+ICsrKyBiL2RyaXZlcnMvbnZkaW1tL01h
a2VmaWxlDQo+IEBAIC02LDYgKzYsOSBAQCBvYmotJChDT05GSUdfTkRfQkxLKSArPSBuZF9ibGsu
bw0KPiAgIG9iai0kKENPTkZJR19YODZfUE1FTV9MRUdBQ1kpICs9IG5kX2U4MjAubw0KPiAgIG9i
ai0kKENPTkZJR19PRl9QTUVNKSArPSBvZl9wbWVtLm8NCj4gICBvYmotJChDT05GSUdfVklSVElP
X1BNRU0pICs9IHZpcnRpb19wbWVtLm8gbmRfdmlydGlvLm8NCj4gK29iai0kKENPTkZJR19PQ1hM
X1NDTSkgKz0gb2N4bHNjbS5vDQo+ICsNCj4gK29jeGxzY20teSA6PSBvY3hsLXNjbS5vIG9jeGwt
c2NtX2ludGVybmFsLm8gb2N4bC1zY21fc3lzZnMubw0KPiAgIA0KPiAgIG5kX3BtZW0teSA6PSBw
bWVtLm8NCj4gICANCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbnZkaW1tL29jeGwtc2NtLmMgYi9k
cml2ZXJzL252ZGltbS9vY3hsLXNjbS5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGluZGV4
IDAwMDAwMDAwMDAwMC4uZjRlNmNjMDIyZGU4DQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIvZHJp
dmVycy9udmRpbW0vb2N4bC1zY20uYw0KPiBAQCAtMCwwICsxLDIyMTAgQEANCj4gKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KPiArLy8gQ29weXJpZ2h0IDIwMTkgSUJNIENv
cnAuDQo+ICsNCj4gKy8qDQo+ICsgKiBBIGRyaXZlciBmb3IgU3RvcmFnZSBDbGFzcyBNZW1vcnks
IGNvbm5lY3RlZCB2aWEgT3BlbkNBUEkNCj4gKyAqLw0KPiArDQo+ICsjaW5jbHVkZSA8bGludXgv
bW9kdWxlLmg+DQo+ICsjaW5jbHVkZSA8bWlzYy9vY3hsLmg+DQo+ICsjaW5jbHVkZSA8bGludXgv
ZGVsYXkuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9uZGN0bC5oPg0KPiArI2luY2x1ZGUgPGxpbnV4
L2V2ZW50ZmQuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9mcy5oPg0KPiArI2luY2x1ZGUgPGxpbnV4
L21tX3R5cGVzLmg+DQo+ICsjaW5jbHVkZSA8bGludXgvbWVtb3J5X2hvdHBsdWcuaD4NCj4gKyNp
bmNsdWRlICJvY3hsLXNjbV9pbnRlcm5hbC5oIg0KPiArDQo+ICsNCj4gK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgcGNpX2RldmljZV9pZCBzY21fcGNpX3RibFtdID0gew0KPiArCXsgUENJX0RFVklDRShQ
Q0lfVkVORE9SX0lEX0lCTSwgMHgwNjI1KSwgfSwNCj4gKwl7IH0NCj4gK307DQo+ICsNCj4gK01P
RFVMRV9ERVZJQ0VfVEFCTEUocGNpLCBzY21fcGNpX3RibCk7DQo+ICsNCj4gKyNkZWZpbmUgU0NN
X05VTV9NSU5PUlMgMjU2IC8vIFRvdGFsIHRvIHJlc2VydmUNCj4gKyNkZWZpbmUgU0NNX1VTQUJM
RV9USU1FT1VUIDEyMCAvLyBzZWNvbmRzDQo+ICsNCj4gK3N0YXRpYyBkZXZfdCBzY21fZGV2Ow0K
PiArc3RhdGljIHN0cnVjdCBjbGFzcyAqc2NtX2NsYXNzOw0KPiArc3RhdGljIHN0cnVjdCBtdXRl
eCBtaW5vcnNfaWRyX2xvY2s7DQo+ICtzdGF0aWMgc3RydWN0IGlkciBtaW5vcnNfaWRyOw0KPiAr
DQo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqc2NtX3BtZW1fYXR0cmli
dXRlX2dyb3Vwc1tdID0gew0KPiArCSZudmRpbW1fYnVzX2F0dHJpYnV0ZV9ncm91cCwNCj4gKwlO
VUxMLA0KPiArfTsNCj4gKw0KPiArc3RhdGljIGNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAg
KnNjbV9wbWVtX3JlZ2lvbl9hdHRyaWJ1dGVfZ3JvdXBzW10gPSB7DQo+ICsJJm5kX3JlZ2lvbl9h
dHRyaWJ1dGVfZ3JvdXAsDQo+ICsJJm5kX2RldmljZV9hdHRyaWJ1dGVfZ3JvdXAsDQo+ICsJJm5k
X21hcHBpbmdfYXR0cmlidXRlX2dyb3VwLA0KPiArCSZuZF9udW1hX2F0dHJpYnV0ZV9ncm91cCwN
Cj4gKwlOVUxMLA0KPiArfTsNCj4gKw0KPiArLyoqDQo+ICsgKiBzY21fbmRjdGxfY29uZmlnX3dy
aXRlKCkgLSBIYW5kbGUgYSBORF9DTURfU0VUX0NPTkZJR19EQVRBIGNvbW1hbmQgZnJvbSBuZGN0
bA0KPiArICogQHNjbV9kYXRhOiB0aGUgU0NNIG1ldGFkYXRhDQo+ICsgKiBAY29tbWFuZDogdGhl
IGluY29taW5nIGRhdGEgdG8gd3JpdGUNCj4gKyAqIFJldHVybjogMCBvbiBzdWNjZXNzLCBuZWdh
dGl2ZSBvbiBmYWlsdXJlDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgc2NtX25kY3RsX2NvbmZpZ193
cml0ZShzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJCSAgc3RydWN0IG5kX2NtZF9z
ZXRfY29uZmlnX2hkciAqY29tbWFuZCkNCj4gK3sNCj4gKwlpZiAoY29tbWFuZC0+aW5fb2Zmc2V0
ICsgY29tbWFuZC0+aW5fbGVuZ3RoID4gU0NNX0xBQkVMX0FSRUFfU0laRSkNCj4gKwkJcmV0dXJu
IC1FSU5WQUw7DQo+ICsNCj4gKwltZW1jcHlfZmx1c2hjYWNoZShzY21fZGF0YS0+bWV0YWRhdGFf
YWRkciArIGNvbW1hbmQtPmluX29mZnNldCwgY29tbWFuZC0+aW5fYnVmLA0KPiArCQkJICBjb21t
YW5kLT5pbl9sZW5ndGgpOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gKy8qKg0K
PiArICogc2NtX25kY3RsX2NvbmZpZ19yZWFkKCkgLSBIYW5kbGUgYSBORF9DTURfR0VUX0NPTkZJ
R19EQVRBIGNvbW1hbmQgZnJvbSBuZGN0bA0KPiArICogQHNjbV9kYXRhOiB0aGUgU0NNIG1ldGFk
YXRhDQo+ICsgKiBAY29tbWFuZDogdGhlIHJlYWQgcmVxdWVzdA0KPiArICogUmV0dXJuOiAwIG9u
IHN1Y2Nlc3MsIG5lZ2F0aXZlIG9uIGZhaWx1cmUNCj4gKyAqLw0KPiArc3RhdGljIGludCBzY21f
bmRjdGxfY29uZmlnX3JlYWQoc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCQkgc3Ry
dWN0IG5kX2NtZF9nZXRfY29uZmlnX2RhdGFfaGRyICpjb21tYW5kKQ0KPiArew0KPiArCWlmIChj
b21tYW5kLT5pbl9vZmZzZXQgKyBjb21tYW5kLT5pbl9sZW5ndGggPiBTQ01fTEFCRUxfQVJFQV9T
SVpFKQ0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArCW1lbWNweShjb21tYW5kLT5vdXRf
YnVmLCBzY21fZGF0YS0+bWV0YWRhdGFfYWRkciArIGNvbW1hbmQtPmluX29mZnNldCwNCj4gKwkg
ICAgICAgY29tbWFuZC0+aW5fbGVuZ3RoKTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiAr
DQo+ICsvKioNCj4gKyAqIHNjbV9uZGN0bF9jb25maWdfc2l6ZSgpIC0gSGFuZGxlIGEgTkRfQ01E
X0dFVF9DT05GSUdfU0laRSBjb21tYW5kIGZyb20gbmRjdGwNCj4gKyAqIEBzY21fZGF0YTogdGhl
IFNDTSBtZXRhZGF0YQ0KPiArICogQGNvbW1hbmQ6IHRoZSByZWFkIHJlcXVlc3QNCj4gKyAqIFJl
dHVybjogMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBmYWlsdXJlDQo+ICsgKi8NCj4gK3N0YXRp
YyBpbnQgc2NtX25kY3RsX2NvbmZpZ19zaXplKHN0cnVjdCBuZF9jbWRfZ2V0X2NvbmZpZ19zaXpl
ICpjb21tYW5kKQ0KPiArew0KPiArCWNvbW1hbmQtPnN0YXR1cyA9IDA7DQo+ICsJY29tbWFuZC0+
Y29uZmlnX3NpemUgPSBTQ01fTEFCRUxfQVJFQV9TSVpFOw0KPiArCWNvbW1hbmQtPm1heF94ZmVy
ID0gUEFHRV9TSVpFOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBp
bnQgcmVhZF9zbWFydF9hdHRyaWIoc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwgdTE2IG9mZnNl
dCwNCj4gKwkJCSAgICAgc3RydWN0IHNjbV9zbWFydF9hdHRyaWJzICphdHRyaWJzKQ0KPiArew0K
PiArCXU2NCB2YWw7DQo+ICsJaW50IHJjOw0KPiArCXN0cnVjdCBzY21fc21hcnRfYXR0cmliICph
dHRyaWI7DQo+ICsJdTggYXR0cmliX2lkOw0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlv
X3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsIG9mZnNldCwgT0NYTF9MSVRUTEVfRU5ESUFOLA0K
PiArCQkJCSAgICAgJnZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4g
KwlhdHRyaWJfaWQgPSAodmFsID4+IDU2KSAmIDB4ZmY7DQo+ICsJc3dpdGNoIChhdHRyaWJfaWQp
IHsNCj4gKwljYXNlIFNDTV9TTUFSVF9BVFRSX1BPV0VSX09OX0hPVVJTOg0KPiArCQlhdHRyaWIg
PSAmYXR0cmlicy0+cG93ZXJfb25faG91cnM7DQo+ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBT
Q01fU01BUlRfQVRUUl9URU1QRVJBVFVSRToNCj4gKwkJYXR0cmliID0gJmF0dHJpYnMtPnRlbXBl
cmF0dXJlOw0KPiArCQlicmVhazsNCj4gKw0KPiArCWNhc2UgU0NNX1NNQVJUX0FUVFJfTElGRV9S
RU1BSU5JTkc6DQo+ICsJCWF0dHJpYiA9ICZhdHRyaWJzLT5saWZlX3JlbWFpbmluZzsNCj4gKwkJ
YnJlYWs7DQo+ICsNCj4gKwlkZWZhdWx0Og0KPiArCQlkZXZfZXJyKCZzY21fZGF0YS0+ZGV2LCAi
VW5rbm93biBzbWFydCBhdHRyaWIgJyVkJyIsIGF0dHJpYl9pZCk7DQo+ICsJCXJldHVybiAtRUZB
VUxUOw0KPiArCX0NCj4gKw0KPiArCWF0dHJpYi0+aWQgPSBhdHRyaWJfaWQ7DQo+ICsJYXR0cmli
LT5hdHRyaWJ1dGVfZmxhZ3MgPSAodmFsID4+IDQwKSAmIDB4ZmZmZjsNCj4gKwlhdHRyaWItPmN1
cnJlbnRfdmFsID0gKHZhbCA+PiAzMikgJiAweGZmOw0KPiArCWF0dHJpYi0+dGhyZXNob2xkX3Zh
bCA9ICh2YWwgPj4gMjQpICYgMHhmZjsNCj4gKwlhdHRyaWItPndvcnN0X3ZhbCA9ICh2YWwgPj4g
MTYpICYgMHhmZjsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2Rh
dGEtPm9jeGxfYWZ1LCBvZmZzZXQgKyAweDA4LA0KPiArCQkJCSAgICAgT0NYTF9MSVRUTEVfRU5E
SUFOLCAmdmFsKTsNCj4gKwlpZiAocmMpDQo+ICsJCXJldHVybiByYzsNCj4gKw0KPiArCWF0dHJp
Yi0+cmF3X3ZhbCA9IHZhbDsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0
aWMgaW50IHNjbV9zbWFydF9vZmZzZXRfMHgwMChzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLCB1
MzIgKmxlbmd0aCkNCj4gK3sNCj4gKwlpbnQgcmM7DQo+ICsJdTY0IHZhbDsNCj4gKw0KPiArCXUx
NiBkYXRhX2lkZW50aWZpZXI7DQo+ICsJdTMyIGRhdGFfbGVuZ3RoOw0KPiArDQo+ICsJcmMgPSBv
Y3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJICAgICBz
Y21fZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCwNCj4gKwkJCQkgICAgIE9DWExfTElU
VExFX0VORElBTiwgJnZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4g
KwlkYXRhX2lkZW50aWZpZXIgPSB2YWwgPj4gNDg7DQo+ICsJZGF0YV9sZW5ndGggPSB2YWwgJiAw
eEZGRkZGRkZGOw0KPiArDQo+ICsJaWYgKGRhdGFfaWRlbnRpZmllciAhPSAweDUzNEQpIHsNCj4g
KwkJZGV2X2Vycigmc2NtX2RhdGEtPmRldiwNCj4gKwkJCSJCYWQgZGF0YSBpZGVudGlmaWVyIGZv
ciBzbWFydCBkYXRhLCBleHBlY3RlZCAnU00nLCBnb3QgJyUtLipzJ1xuIiwNCj4gKwkJCTIsIChj
aGFyICopJmRhdGFfaWRlbnRpZmllcik7DQo+ICsJCXJldHVybiAtRUZBVUxUOw0KPiArCX0NCj4g
Kw0KPiArCSpsZW5ndGggPSBkYXRhX2xlbmd0aDsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0K
PiArc3RhdGljIGludCBzY21fc21hcnRfdXBkYXRlKHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEp
DQo+ICt7DQo+ICsJdTMyIGxlbmd0aCwgaTsNCj4gKwlpbnQgcmM7DQo+ICsNCj4gKwltdXRleF9s
b2NrKCZzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5sb2NrKTsNCj4gKw0KPiArCXJjID0gc2NtX2Fk
bWluX2NvbW1hbmRfcmVxdWVzdChzY21fZGF0YSwgQURNSU5fQ09NTUFORF9TTUFSVCk7DQo+ICsJ
aWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXJjID0gc2NtX2FkbWluX2NvbW1hbmRf
ZXhlY3V0ZShzY21fZGF0YSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiAr
CXJjID0gc2NtX2FkbWluX2NvbW1hbmRfY29tcGxldGVfdGltZW91dChzY21fZGF0YSwgQURNSU5f
Q09NTUFORF9TTUFSVCk7DQo+ICsJaWYgKHJjIDwgMCkgew0KPiArCQlkZXZfZXJyKCZzY21fZGF0
YS0+ZGV2LCAiU01BUlQgdGltZW91dFxuIik7DQo+ICsJCWdvdG8gb3V0Ow0KPiArCX0NCj4gKw0K
PiArCXJjID0gc2NtX2FkbWluX3Jlc3BvbnNlKHNjbV9kYXRhKTsNCj4gKwlpZiAocmMgPCAwKQ0K
PiArCQlnb3RvIG91dDsNCj4gKwlpZiAocmMgIT0gU1RBVFVTX1NVQ0NFU1MpIHsNCj4gKwkJc2Nt
X3dhcm5fc3RhdHVzKHNjbV9kYXRhLCAiVW5leHBlY3RlZCBzdGF0dXMgZnJvbSBTTUFSVCIsIHJj
KTsNCj4gKwkJZ290byBvdXQ7DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBzY21fc21hcnRfb2Zmc2V0
XzB4MDAoc2NtX2RhdGEsICZsZW5ndGgpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+
ICsNCj4gKwlsZW5ndGggLz0gMHgxMDsgLy8gTGVuZ3RoIG5vdyBjb250YWlucyB0aGUgbnVtYmVy
IG9mIGF0dHJpYnV0ZXMNCj4gKw0KPiArCWZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykNCj4g
KwkJcmVhZF9zbWFydF9hdHRyaWIoc2NtX2RhdGEsDQo+ICsJCQkJICBzY21fZGF0YS0+YWRtaW5f
Y29tbWFuZC5kYXRhX29mZnNldCArIDB4MDggKyBpICogMHgxMCwNCj4gKwkJCQkgICZzY21fZGF0
YS0+c21hcnQpOw0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fcmVzcG9uc2VfaGFuZGxlZChzY21f
ZGF0YSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXJjID0gMDsNCj4g
Kwlnb3RvIG91dDsNCj4gKw0KPiArb3V0Og0KPiArCW11dGV4X3VubG9jaygmc2NtX2RhdGEtPmFk
bWluX2NvbW1hbmQubG9jayk7DQo+ICsJcmV0dXJuIHJjOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMg
aW50IHNjbV9uZGN0bF9zbWFydChzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLCB2b2lkICpidWYs
DQo+ICsJCQkgICB1bnNpZ25lZCBpbnQgYnVmX2xlbikNCj4gK3sNCj4gKwlpbnQgcmM7DQo+ICsN
Cj4gKwlpZiAoYnVmX2xlbiAhPSBzaXplb2Yoc2NtX2RhdGEtPnNtYXJ0KSkNCj4gKwkJcmV0dXJu
IC1FSU5WQUw7DQo+ICsNCj4gKwlyYyA9IHNjbV9zbWFydF91cGRhdGUoc2NtX2RhdGEpOw0KPiAr
CWlmIChyYykNCj4gKwkJcmV0dXJuIHJjOw0KPiArDQo+ICsJbWVtY3B5KGJ1ZiwgJnNjbV9kYXRh
LT5zbWFydCwgYnVmX2xlbik7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArDQo+
ICtzdGF0aWMgaW50IHNjbV9uZGN0bChzdHJ1Y3QgbnZkaW1tX2J1c19kZXNjcmlwdG9yICpuZF9k
ZXNjLA0KPiArCQkgICAgIHN0cnVjdCBudmRpbW0gKm52ZGltbSwNCj4gKwkJICAgICB1bnNpZ25l
ZCBpbnQgY21kLCB2b2lkICpidWYsIHVuc2lnbmVkIGludCBidWZfbGVuLCBpbnQgKmNtZF9yYykN
Cj4gK3sNCj4gKwlzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhID0gY29udGFpbmVyX29mKG5kX2Rl
c2MsIHN0cnVjdCBzY21fZGF0YSwgYnVzX2Rlc2MpOw0KPiArDQo+ICsJc3dpdGNoIChjbWQpIHsN
Cj4gKwljYXNlIE5EX0NNRF9TTUFSVDoNCj4gKwkJKmNtZF9yYyA9IHNjbV9uZGN0bF9zbWFydChz
Y21fZGF0YSwgYnVmLCBidWZfbGVuKTsNCj4gKwkJcmV0dXJuIDA7DQo+ICsNCj4gKwljYXNlIE5E
X0NNRF9HRVRfQ09ORklHX1NJWkU6DQo+ICsJCSpjbWRfcmMgPSBzY21fbmRjdGxfY29uZmlnX3Np
emUoYnVmKTsNCj4gKwkJcmV0dXJuIDA7DQo+ICsNCj4gKwljYXNlIE5EX0NNRF9HRVRfQ09ORklH
X0RBVEE6DQo+ICsJCSpjbWRfcmMgPSBzY21fbmRjdGxfY29uZmlnX3JlYWQoc2NtX2RhdGEsIGJ1
Zik7DQo+ICsJCXJldHVybiAwOw0KPiArDQo+ICsJY2FzZSBORF9DTURfU0VUX0NPTkZJR19EQVRB
Og0KPiArCQkqY21kX3JjID0gc2NtX25kY3RsX2NvbmZpZ193cml0ZShzY21fZGF0YSwgYnVmKTsN
Cj4gKwkJcmV0dXJuIDA7DQo+ICsNCj4gKwlkZWZhdWx0Og0KPiArCQlyZXR1cm4gLUVOT1RUWTsN
Cj4gKwl9DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBzc2l6ZV90IHNlcmlhbF9zaG93KHN0cnVjdCBk
ZXZpY2UgKmRldiwNCj4gKwkJCSAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFy
ICpidWYpDQo+ICt7DQo+ICsJc3RydWN0IG52ZGltbSAqbnZkaW1tID0gdG9fbnZkaW1tKGRldik7
DQo+ICsJc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSA9IG52ZGltbV9wcm92aWRlcl9kYXRhKG52
ZGltbSk7DQo+ICsJY29uc3Qgc3RydWN0IG9jeGxfZm5fY29uZmlnICpjb25maWcgPSBvY3hsX2Z1
bmN0aW9uX2NvbmZpZyhzY21fZGF0YS0+b2N4bF9mbik7DQo+ICsNCj4gKwlyZXR1cm4gc3ByaW50
ZihidWYsICIweCVsbHhcbiIsIGNvbmZpZy0+c2VyaWFsKTsNCj4gK30NCj4gK3N0YXRpYyBERVZJ
Q0VfQVRUUl9STyhzZXJpYWwpOw0KPiArDQo+ICtzdGF0aWMgc3RydWN0IGF0dHJpYnV0ZSAqc2Nt
X2RpbW1fYXR0cmlidXRlc1tdID0gew0KPiArCSZkZXZfYXR0cl9zZXJpYWwuYXR0ciwNCj4gKwlO
VUxMLA0KPiArfTsNCj4gKw0KPiArc3RhdGljIHVtb2RlX3Qgc2NtX2RpbW1fYXR0cl92aXNpYmxl
KHN0cnVjdCBrb2JqZWN0ICprb2JqLA0KPiArCQkJCSAgICAgc3RydWN0IGF0dHJpYnV0ZSAqYSwg
aW50IG4pDQo+ICt7DQo+ICsJcmV0dXJuIGEtPm1vZGU7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIHNjbV9kaW1tX2F0dHJpYnV0ZV9ncm91cCA9IHsN
Cj4gKwkubmFtZSA9ICJzY20iLA0KPiArCS5hdHRycyA9IHNjbV9kaW1tX2F0dHJpYnV0ZXMsDQo+
ICsJLmlzX3Zpc2libGUgPSBzY21fZGltbV9hdHRyX3Zpc2libGUsDQo+ICt9Ow0KPiArDQo+ICtz
dGF0aWMgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqc2NtX2RpbW1fYXR0cmlidXRlX2dy
b3Vwc1tdID0gew0KPiArCSZudmRpbW1fYXR0cmlidXRlX2dyb3VwLA0KPiArCSZuZF9kZXZpY2Vf
YXR0cmlidXRlX2dyb3VwLA0KPiArCSZzY21fZGltbV9hdHRyaWJ1dGVfZ3JvdXAsDQo+ICsJTlVM
TCwNCj4gK307DQo+ICsNCj4gKy8qKg0KPiArICogc2NtX3Jlc2VydmVfbWV0YWRhdGEoKSAtIFJl
c2VydmUgc3BhY2UgZm9yIG52ZGltbSBtZXRhZGF0YQ0KPiArICogQHNjbV9kYXRhOiBUaGUgU0NN
IGRldmljZSBkYXRhDQo+ICsgKiBAbHBjX21lbTogVGhlIHJlc291cmNlIHJlcHJlc2VudGluZyB0
aGUgTFBDIG1lbW9yeSBvZiB0aGUgU0NNIGRldmljZQ0KPiArICovDQo+ICtzdGF0aWMgaW50IHNj
bV9yZXNlcnZlX21ldGFkYXRhKHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEsDQo+ICsJCQkJc3Ry
dWN0IHJlc291cmNlICpscGNfbWVtKQ0KPiArew0KPiArCXNjbV9kYXRhLT5tZXRhZGF0YV9hZGRy
ID0gZGV2bV9tZW1yZW1hcCgmc2NtX2RhdGEtPmRldiwgbHBjX21lbS0+c3RhcnQsDQo+ICsJCQkJ
CQlTQ01fTEFCRUxfQVJFQV9TSVpFLCBNRU1SRU1BUF9XQik7DQo+ICsJaWYgKElTX0VSUihzY21f
ZGF0YS0+bWV0YWRhdGFfYWRkcikpDQo+ICsJCXJldHVybiBQVFJfRVJSKHNjbV9kYXRhLT5tZXRh
ZGF0YV9hZGRyKTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAq
IHNjbV9vdmVyd3JpdGUoKSAtIE92ZXJ3cml0ZSBhbGwgZGF0YSBvbiB0aGUgY2FyZA0KPiArICog
QHNjbV9kYXRhOiBUaGUgU0NNIGRldmljZSBkYXRhDQo+ICsgKiBSZXR1cm46IDAgb24gc3VjY2Vz
cw0KPiArICovDQo+ICtpbnQgc2NtX292ZXJ3cml0ZShzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRh
KQ0KPiArew0KPiArCWludCByYzsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNjbV9kYXRhLT5uc19j
b21tYW5kLmxvY2spOw0KPiArDQo+ICsJcmMgPSBzY21fbnNfY29tbWFuZF9yZXF1ZXN0KHNjbV9k
YXRhLCBOU19DT01NQU5EX1NFQ1VSRV9FUkFTRSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91
dDsNCj4gKw0KPiArCXJjID0gc2NtX25zX2NvbW1hbmRfZXhlY3V0ZShzY21fZGF0YSk7DQo+ICsJ
aWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXNjbV9kYXRhLT5vdmVyd3JpdGVfc3Rh
dGUgPSBTQ01fT1ZFUldSSVRFX0JVU1k7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gKw0KPiArb3V0
Og0KPiArCW11dGV4X3VubG9jaygmc2NtX2RhdGEtPm5zX2NvbW1hbmQubG9jayk7DQo+ICsJcmV0
dXJuIHJjOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHNjbV9zZWNvcF9vdmVyd3JpdGUoKSAt
IE92ZXJ3cml0ZSBhbGwgZGF0YSBvbiB0aGUgY2FyZA0KPiArICogQG52ZGltbTogVGhlIG52ZGlt
bSByZXByZXNlbnRhdGlvbiBvZiB0aGUgU0NNIGRldmljZSB0byBzdGFydCB0aGUgb3ZlcndyaXRl
IG9uDQo+ICsgKiBAa2V5X2RhdGE6IFVudXNlZCAobm8gc2VjdXJpdHkga2V5IGltcGxlbWVudGF0
aW9uKQ0KPiArICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MNCj4gKyAqLw0KPiArc3RhdGljIGludCBz
Y21fc2Vjb3Bfb3ZlcndyaXRlKHN0cnVjdCBudmRpbW0gKm52ZGltbSwNCj4gKwkJCSAgICAgICBj
b25zdCBzdHJ1Y3QgbnZkaW1tX2tleV9kYXRhICprZXlfZGF0YSkNCj4gK3sNCj4gKwlzdHJ1Y3Qg
c2NtX2RhdGEgKnNjbV9kYXRhID0gbnZkaW1tX3Byb3ZpZGVyX2RhdGEobnZkaW1tKTsNCj4gKw0K
PiArCXJldHVybiBzY21fb3ZlcndyaXRlKHNjbV9kYXRhKTsNCj4gK30NCj4gKw0KPiArLyoqDQo+
ICsgKiBzY21fc2Vjb3BfcXVlcnlfb3ZlcndyaXRlKCkgLSBHZXQgdGhlIGN1cnJlbnQgb3Zlcndy
aXRlIHN0YXRlDQo+ICsgKiBAbnZkaW1tOiBUaGUgbnZkaW1tIHJlcHJlc2VudGF0aW9uIG9mIHRo
ZSBTQ00gZGV2aWNlIHRvIHN0YXJ0IHRoZSBvdmVyd3JpdGUgb24NCj4gKyAqIFJldHVybjogMCBp
ZiBzdWNjZXNzZnVsIG9yIGlkbGUsIC1FQlVTWSBpZiBidXN5LCAtRUZBVUxUIGlmIGZhaWxlZA0K
PiArICovDQo+ICtzdGF0aWMgaW50IHNjbV9zZWNvcF9xdWVyeV9vdmVyd3JpdGUoc3RydWN0IG52
ZGltbSAqbnZkaW1tKQ0KPiArew0KPiArCXN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEgPSBudmRp
bW1fcHJvdmlkZXJfZGF0YShudmRpbW0pOw0KPiArDQo+ICsJaWYgKHNjbV9kYXRhLT5vdmVyd3Jp
dGVfc3RhdGUgPT0gU0NNX09WRVJXUklURV9CVVNZKQ0KPiArCQlyZXR1cm4gLUVCVVNZOw0KPiAr
DQo+ICsJaWYgKHNjbV9kYXRhLT5vdmVyd3JpdGVfc3RhdGUgPT0gU0NNX09WRVJXUklURV9GQUlM
RUQpDQo+ICsJCXJldHVybiAtRUZBVUxUOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsN
Cj4gKy8qKg0KPiArICogc2NtX3NlY29wX2dldF9mbGFncygpIC0gcmV0dXJuIHRoZSBzZWN1cml0
eSBmbGFncyBmb3IgdGhlIFNDTSBkZXZpY2UNCj4gKyAqLw0KPiArc3RhdGljIHVuc2lnbmVkIGxv
bmcgc2NtX3NlY29wX2dldF9mbGFncyhzdHJ1Y3QgbnZkaW1tICpudmRpbW0sDQo+ICsJCWVudW0g
bnZkaW1tX3Bhc3NwaHJhc2VfdHlwZSBwdHlwZSkNCj4gK3sNCj4gKwlzdHJ1Y3Qgc2NtX2RhdGEg
KnNjbV9kYXRhID0gbnZkaW1tX3Byb3ZpZGVyX2RhdGEobnZkaW1tKTsNCj4gKw0KPiArCWlmIChz
Y21fZGF0YS0+b3ZlcndyaXRlX3N0YXRlID09IFNDTV9PVkVSV1JJVEVfQlVTWSkNCj4gKwkJcmV0
dXJuIEJJVChOVkRJTU1fU0VDVVJJVFlfT1ZFUldSSVRFKTsNCj4gKw0KPiArCXJldHVybiBCSVQo
TlZESU1NX1NFQ1VSSVRZX0RJU0FCTEVEKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGNvbnN0IHN0
cnVjdCBudmRpbW1fc2VjdXJpdHlfb3BzIHNlY19vcHMgID0gew0KPiArCS5nZXRfZmxhZ3MgPSBz
Y21fc2Vjb3BfZ2V0X2ZsYWdzLA0KPiArCS5vdmVyd3JpdGUgPSBzY21fc2Vjb3Bfb3ZlcndyaXRl
LA0KPiArCS5xdWVyeV9vdmVyd3JpdGUgPSBzY21fc2Vjb3BfcXVlcnlfb3ZlcndyaXRlLA0KPiAr
fTsNCj4gKw0KPiArLyoqDQo+ICsgKiBzY21fcmVnaXN0ZXJfbHBjX21lbSgpIC0gRGlzY292ZXIg
cGVyc2lzdGVudCBtZW1vcnkgb24gYSBkZXZpY2UgYW5kIHJlZ2lzdGVyIGl0IHdpdGggdGhlIE5W
RElNTSBzdWJzeXN0ZW0NCj4gKyAqIEBzY21fZGF0YTogVGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiAr
ICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MNCj4gKyAqLw0KPiArc3RhdGljIGludCBzY21fcmVnaXN0
ZXJfbHBjX21lbShzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCXN0cnVjdCBu
ZF9yZWdpb25fZGVzYyByZWdpb25fZGVzYzsNCj4gKwlzdHJ1Y3QgbmRfbWFwcGluZ19kZXNjIG5k
X21hcHBpbmdfZGVzYzsNCj4gKwlzdHJ1Y3QgcmVzb3VyY2UgKmxwY19tZW07DQo+ICsJY29uc3Qg
c3RydWN0IG9jeGxfYWZ1X2NvbmZpZyAqY29uZmlnOw0KPiArCWNvbnN0IHN0cnVjdCBvY3hsX2Zu
X2NvbmZpZyAqZm5fY29uZmlnOw0KPiArCWludCByYzsNCj4gKwl1bnNpZ25lZCBsb25nIG52ZGlt
bV9jbWRfbWFzayA9IDA7DQo+ICsJdW5zaWduZWQgbG9uZyBudmRpbW1fZmxhZ3MgPSAwOw0KPiAr
CWludCB0YXJnZXRfbm9kZTsNCj4gKwljaGFyIHNlcmlhbFsxNisxXTsNCj4gKw0KPiArCS8vIFNl
dCB1cCB0aGUgcmVzZXJ2ZWQgbWV0YWRhdGEgYXJlYQ0KPiArCXJjID0gb2N4bF9hZnVfbWFwX2xw
Y19tZW0oc2NtX2RhdGEtPm9jeGxfYWZ1KTsNCj4gKwlpZiAocmMgPCAwKQ0KPiArCQlyZXR1cm4g
cmM7DQo+ICsNCj4gKwlscGNfbWVtID0gb2N4bF9hZnVfbHBjX21lbShzY21fZGF0YS0+b2N4bF9h
ZnUpOw0KPiArCWlmIChscGNfbWVtID09IE5VTEwpDQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiAr
DQo+ICsJY29uZmlnID0gb2N4bF9hZnVfY29uZmlnKHNjbV9kYXRhLT5vY3hsX2FmdSk7DQo+ICsJ
Zm5fY29uZmlnID0gb2N4bF9mdW5jdGlvbl9jb25maWcoc2NtX2RhdGEtPm9jeGxfZm4pOw0KPiAr
DQo+ICsJcmMgPSBzY21fcmVzZXJ2ZV9tZXRhZGF0YShzY21fZGF0YSwgbHBjX21lbSk7DQo+ICsJ
aWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwlzY21fZGF0YS0+YnVzX2Rlc2MuYXR0
cl9ncm91cHMgPSBzY21fcG1lbV9hdHRyaWJ1dGVfZ3JvdXBzOw0KPiArCXNjbV9kYXRhLT5idXNf
ZGVzYy5wcm92aWRlcl9uYW1lID0gInNjbSI7DQo+ICsJc2NtX2RhdGEtPmJ1c19kZXNjLm5kY3Rs
ID0gc2NtX25kY3RsOw0KPiArCXNjbV9kYXRhLT5idXNfZGVzYy5tb2R1bGUgPSBUSElTX01PRFVM
RTsNCj4gKw0KPiArCXNjbV9kYXRhLT5udmRpbW1fYnVzID0gbnZkaW1tX2J1c19yZWdpc3Rlcigm
c2NtX2RhdGEtPmRldiwNCj4gKwkJCSAgICAgICAmc2NtX2RhdGEtPmJ1c19kZXNjKTsNCj4gKwlp
ZiAoIXNjbV9kYXRhLT5udmRpbW1fYnVzKQ0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiAr
CXNjbV9kYXRhLT5zY21fcmVzLnN0YXJ0ID0gKHU2NClscGNfbWVtLT5zdGFydCArIFNDTV9MQUJF
TF9BUkVBX1NJWkU7DQo+ICsJc2NtX2RhdGEtPnNjbV9yZXMuZW5kID0gKHU2NClscGNfbWVtLT5z
dGFydCArIGNvbmZpZy0+bHBjX21lbV9zaXplIC0gMTsNCj4gKwlzY21fZGF0YS0+c2NtX3Jlcy5u
YW1lID0gIlNDTSBwZXJzaXN0ZW50IG1lbW9yeSI7DQo+ICsNCj4gKwlzZXRfYml0KE5EX0NNRF9H
RVRfQ09ORklHX1NJWkUsICZudmRpbW1fY21kX21hc2spOw0KPiArCXNldF9iaXQoTkRfQ01EX0dF
VF9DT05GSUdfREFUQSwgJm52ZGltbV9jbWRfbWFzayk7DQo+ICsJc2V0X2JpdChORF9DTURfU0VU
X0NPTkZJR19EQVRBLCAmbnZkaW1tX2NtZF9tYXNrKTsNCj4gKwlzZXRfYml0KE5EX0NNRF9TTUFS
VCwgJm52ZGltbV9jbWRfbWFzayk7DQo+ICsNCj4gKwlzZXRfYml0KE5ERF9BTElBU0lORywgJm52
ZGltbV9mbGFncyk7DQo+ICsNCj4gKwlzbnByaW50ZihzZXJpYWwsIHNpemVvZihzZXJpYWwpLCAi
JWxseCIsIGZuX2NvbmZpZy0+c2VyaWFsKTsNCj4gKwluZF9tYXBwaW5nX2Rlc2MubnZkaW1tID0g
X19udmRpbW1fY3JlYXRlKHNjbV9kYXRhLT5udmRpbW1fYnVzLCBzY21fZGF0YSwNCj4gKwkJCQkg
c2NtX2RpbW1fYXR0cmlidXRlX2dyb3VwcywNCj4gKwkJCQkgbnZkaW1tX2ZsYWdzLCBudmRpbW1f
Y21kX21hc2ssDQo+ICsJCQkJIDAsIE5VTEwsIHNlcmlhbCwgJnNlY19vcHMpOw0KPiArCWlmICgh
bmRfbWFwcGluZ19kZXNjLm52ZGltbSkNCj4gKwkJcmV0dXJuIC1FTk9NRU07DQo+ICsNCj4gKwlp
ZiAobnZkaW1tX2J1c19jaGVja19kaW1tX2NvdW50KHNjbV9kYXRhLT5udmRpbW1fYnVzLCAxKSkN
Cj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwluZF9tYXBwaW5nX2Rlc2Muc3RhcnQgPSBz
Y21fZGF0YS0+c2NtX3Jlcy5zdGFydDsNCj4gKwluZF9tYXBwaW5nX2Rlc2Muc2l6ZSA9IHJlc291
cmNlX3NpemUoJnNjbV9kYXRhLT5zY21fcmVzKTsNCj4gKwluZF9tYXBwaW5nX2Rlc2MucG9zaXRp
b24gPSAwOw0KPiArDQo+ICsJc2NtX2RhdGEtPm5kX3NldC5jb29raWUxID0gZm5fY29uZmlnLT5z
ZXJpYWwgKyAxOyAvLyBhbGxvdyBmb3IgZW1wdHkgc2VyaWFsDQo+ICsJc2NtX2RhdGEtPm5kX3Nl
dC5jb29raWUyID0gZm5fY29uZmlnLT5zZXJpYWwgKyAxOw0KPiArDQo+ICsJdGFyZ2V0X25vZGUg
PSBvZl9ub2RlX3RvX25pZChzY21fZGF0YS0+cGRldi0+ZGV2Lm9mX25vZGUpOw0KPiArDQo+ICsJ
bWVtc2V0KCZyZWdpb25fZGVzYywgMCwgc2l6ZW9mKHJlZ2lvbl9kZXNjKSk7DQo+ICsJcmVnaW9u
X2Rlc2MucmVzID0gJnNjbV9kYXRhLT5zY21fcmVzOw0KPiArCXJlZ2lvbl9kZXNjLmF0dHJfZ3Jv
dXBzID0gc2NtX3BtZW1fcmVnaW9uX2F0dHJpYnV0ZV9ncm91cHM7DQo+ICsJcmVnaW9uX2Rlc2Mu
bnVtYV9ub2RlID0gTlVNQV9OT19OT0RFOw0KPiArCXJlZ2lvbl9kZXNjLnRhcmdldF9ub2RlID0g
dGFyZ2V0X25vZGU7DQo+ICsJcmVnaW9uX2Rlc2MubnVtX21hcHBpbmdzID0gMTsNCj4gKwlyZWdp
b25fZGVzYy5tYXBwaW5nID0gJm5kX21hcHBpbmdfZGVzYzsNCj4gKwlyZWdpb25fZGVzYy5uZF9z
ZXQgPSAmc2NtX2RhdGEtPm5kX3NldDsNCj4gKw0KPiArCXNldF9iaXQoTkRfUkVHSU9OX1BBR0VN
QVAsICZyZWdpb25fZGVzYy5mbGFncyk7DQo+ICsJLyoNCj4gKwkgKiBOQjogbGlibnZkaW1tIGNv
cGllcyB0aGUgZGF0YSBmcm9tIG5kcl9kZXNjIGludG8gaXQncyBvd24NCj4gKwkgKiBzdHJ1Y3R1
cmVzIHNvIHBhc3NpbmcgYSBzdGFjayBwb2ludGVyIGlzIGZpbmUuDQo+ICsJICovDQo+ICsJc2Nt
X2RhdGEtPm5kX3JlZ2lvbiA9IG52ZGltbV9wbWVtX3JlZ2lvbl9jcmVhdGUoc2NtX2RhdGEtPm52
ZGltbV9idXMsDQo+ICsJCQkgICAgICAmcmVnaW9uX2Rlc2MpOw0KPiArCWlmICghc2NtX2RhdGEt
Pm5kX3JlZ2lvbikNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwlkZXZfaW5mbygmc2Nt
X2RhdGEtPmRldiwNCj4gKwkJICJPbmxpbmluZyAlbGx1TUIgb2YgcGVyc2lzdGVudCBtZW1vcnlc
biIsDQo+ICsJCSBuZF9tYXBwaW5nX2Rlc2Muc2l6ZSAvIFNaXzFNKTsNCj4gKw0KPiArCXJldHVy
biAwOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHNjbV9pc19tZW1vcnlfYXZhaWxhYmxlKCkg
LSBEb2VzIHRoZSBjb250cm9sbGVyIGhhdmUgbWVtb3J5IGF2YWlsYWJsZT8NCj4gKyAqIEBzY21f
ZGF0YTogYSBwb2ludGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqIFJldHVybjogdHJ1
ZSBpZiB0aGUgY29udHJvbGxlciBoYXMgbWVtb3J5IGF2YWlsYWJsZQ0KPiArICovDQo+ICtzdGF0
aWMgYm9vbCBzY21faXNfbWVtb3J5X2F2YWlsYWJsZShjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNj
bV9kYXRhKQ0KPiArew0KPiArCXU2NCB2YWwgPSAwOw0KPiArCWludCByYyA9IHNjbV9jaGkoc2Nt
X2RhdGEsICZ2YWwpOw0KPiArDQo+ICsJV0FSTl9PTihyYyA8IDApOw0KPiArDQo+ICsJcmV0dXJu
ICh2YWwgJiBHTE9CQUxfTU1JT19DSElfTUEpICE9IDA7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiAr
ICogc2NtX2V4dHJhY3RfY29tbWFuZF9tZXRhZGF0YSgpIC0gRXh0cmFjdCBjb21tYW5kIGRhdGEg
ZnJvbSBNTUlPICYgc2F2ZSBpdCBmb3IgZnVydGhlciB1c2UNCj4gKyAqIEBzY21fZGF0YTogYSBw
b2ludGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqIEBvZmZzZXQ6IFRoZSBiYXNlIGFk
ZHJlc3Mgb2YgdGhlIGNvbW1hbmQgZGF0YSBzdHJ1Y3R1cmVzIChhZGRyZXNzIG9mIENSRVFPKQ0K
PiArICogQGNvbW1hbmRfbWV0YWRhdGE6IEEgcG9pbnRlciB0byB0aGUgY29tbWFuZCBtZXRhZGF0
YSB0byBwb3B1bGF0ZQ0KPiArICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIG9uIGZh
aWx1cmUNCj4gKyAqLw0KPiArc3RhdGljIGludCBzY21fZXh0cmFjdF9jb21tYW5kX21ldGFkYXRh
KHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEsIHUzMiBvZmZzZXQsDQo+ICsJCQkJCXN0cnVjdCBj
b21tYW5kX21ldGFkYXRhICpjb21tYW5kX21ldGFkYXRhKQ0KPiArew0KPiArCWludCByYzsNCj4g
Kwl1NjQgdG1wOw0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0
YS0+b2N4bF9hZnUsIG9mZnNldCwgT0NYTF9MSVRUTEVfRU5ESUFOLA0KPiArCQkJCSAgICAgJnRt
cCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwljb21tYW5kX21ldGFk
YXRhLT5yZXF1ZXN0X29mZnNldCA9IHRtcCA+PiAzMjsNCj4gKwljb21tYW5kX21ldGFkYXRhLT5y
ZXNwb25zZV9vZmZzZXQgPSB0bXAgJiAweEZGRkZGRkZGOw0KPiArDQo+ICsJcmMgPSBvY3hsX2ds
b2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsIG9mZnNldCArIDgsIE9DWExfTElU
VExFX0VORElBTiwNCj4gKwkJCQkgICAgICZ0bXApOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJu
IHJjOw0KPiArDQo+ICsJY29tbWFuZF9tZXRhZGF0YS0+ZGF0YV9vZmZzZXQgPSB0bXAgPj4gMzI7
DQo+ICsJY29tbWFuZF9tZXRhZGF0YS0+ZGF0YV9zaXplID0gdG1wICYgMHhGRkZGRkZGRjsNCj4g
Kw0KPiArCWNvbW1hbmRfbWV0YWRhdGEtPmlkID0gMDsNCj4gKw0KPiArCXJldHVybiAwOw0KPiAr
fQ0KPiArDQo+ICsvKioNCj4gKyAqIHNjbV9zZXR1cF9jb21tYW5kX21ldGFkYXRhKCkgLSBTZXQg
dXAgdGhlIGNvbW1hbmQgbWV0YWRhdGENCj4gKyAqIEBzY21fZGF0YTogYSBwb2ludGVyIHRvIHRo
ZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqLw0KPiArc3RhdGljIGludCBzY21fc2V0dXBfY29tbWFu
ZF9tZXRhZGF0YShzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCWludCByYzsN
Cj4gKw0KPiArCXJjID0gc2NtX2V4dHJhY3RfY29tbWFuZF9tZXRhZGF0YShzY21fZGF0YSwgR0xP
QkFMX01NSU9fQUNNQV9DUkVRTywNCj4gKwkJCQkJICAmc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQp
Ow0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJuIHJjOw0KPiArDQo+ICsJcmMgPSBzY21fZXh0cmFj
dF9jb21tYW5kX21ldGFkYXRhKHNjbV9kYXRhLCBHTE9CQUxfTU1JT19OU0NNQV9DUkVRTywNCj4g
KwkJCQkJICAmc2NtX2RhdGEtPm5zX2NvbW1hbmQpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJu
IHJjOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogc2NtX2hl
YXJ0YmVhdCgpIC0gSXNzdWUgYSBoZWFydGJlYXQgY29tbWFuZCB0byB0aGUgY29udHJvbGxlcg0K
PiArICogQHNjbV9kYXRhOiBhIHBvaW50ZXIgdG8gdGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiArICog
UmV0dXJuOiAwIGlmIHRoZSBjb250cm9sbGVyIHJlc3BvbmRlZCBjb3JyZWN0bHksIG5lZ2F0aXZl
IG9uIGVycm9yDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgc2NtX2hlYXJ0YmVhdChzdHJ1Y3Qgc2Nt
X2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCWludCByYzsNCj4gKw0KPiArCW11dGV4X2xvY2so
JnNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmxvY2spOw0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5f
Y29tbWFuZF9yZXF1ZXN0KHNjbV9kYXRhLCBBRE1JTl9DT01NQU5EX0hFQVJUQkVBVCk7DQo+ICsJ
aWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXJjID0gc2NtX2FkbWluX2NvbW1hbmRf
ZXhlY3V0ZShzY21fZGF0YSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiAr
CXJjID0gc2NtX2FkbWluX2NvbW1hbmRfY29tcGxldGVfdGltZW91dChzY21fZGF0YSwgQURNSU5f
Q09NTUFORF9IRUFSVEJFQVQpOw0KPiArCWlmIChyYyA8IDApIHsNCj4gKwkJZGV2X2Vycigmc2Nt
X2RhdGEtPmRldiwgIkhlYXJ0YmVhdCB0aW1lb3V0XG4iKTsNCj4gKwkJZ290byBvdXQ7DQo+ICsJ
fQ0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fcmVzcG9uc2Uoc2NtX2RhdGEpOw0KPiArCWlmIChy
YyA8IDApDQo+ICsJCWdvdG8gb3V0Ow0KPiArCWlmIChyYyAhPSBTVEFUVVNfU1VDQ0VTUykNCj4g
KwkJc2NtX3dhcm5fc3RhdHVzKHNjbV9kYXRhLCAiVW5leHBlY3RlZCBzdGF0dXMgZnJvbSBoZWFy
dGJlYXQiLCByYyk7DQo+ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9yZXNwb25zZV9oYW5kbGVkKHNj
bV9kYXRhKTsNCj4gKw0KPiArCWdvdG8gb3V0Ow0KPiArDQo+ICtvdXQ6DQo+ICsJbXV0ZXhfdW5s
b2NrKCZzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5sb2NrKTsNCj4gKwlyZXR1cm4gcmM7DQo+ICt9
DQo+ICsNCj4gKy8qKg0KPiArICogc2NtX2lzX3VzYWJsZSgpIC0gSXMgYSBjb250cm9sbGVyIHVz
YWJsZT8NCj4gKyAqIEBzY21fZGF0YTogYSBwb2ludGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGEN
Cj4gKyAqIFJldHVybjogdHJ1ZSBpZiB0aGUgY29udHJvbGxlciBpcyB1c2FibGUNCj4gKyAqLw0K
PiArc3RhdGljIGJvb2wgc2NtX2lzX3VzYWJsZShjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9k
YXRhKQ0KPiArew0KPiArCWlmICghc2NtX2NvbnRyb2xsZXJfaXNfcmVhZHkoc2NtX2RhdGEpKSB7
DQo+ICsJCWRldl9lcnIoJnNjbV9kYXRhLT5kZXYsICJTQ00gY29udHJvbGxlciBpcyBub3QgcmVh
ZHkuXG4iKTsNCj4gKwkJcmV0dXJuIGZhbHNlOw0KPiArCX0NCj4gKw0KPiArCWlmICghc2NtX2lz
X21lbW9yeV9hdmFpbGFibGUoc2NtX2RhdGEpKSB7DQo+ICsJCWRldl9lcnIoJnNjbV9kYXRhLT5k
ZXYsDQo+ICsJCQkiU0NNIGNvbnRyb2xsZXIgZG9lcyBub3QgaGF2ZSBtZW1vcnkgYXZhaWxhYmxl
LlxuIik7DQo+ICsJCXJldHVybiBmYWxzZTsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gdHJ1ZTsN
Cj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBhbGxvY2F0ZV9zY21fbWlub3IoKSAtIEFsbG9jYXRl
IGEgbWlub3IgbnVtYmVyIHRvIHVzZSBmb3IgYW4gU0NNIGRldmljZQ0KPiArICogQHNjbV9kYXRh
OiBUaGUgU0NNIGRldmljZSB0byBhc3NvY2lhdGUgdGhlIG1pbm9yIHdpdGgNCj4gKyAqIFJldHVy
bjogdGhlIGFsbG9jYXRlZCBtaW5vciBudW1iZXINCj4gKyAqLw0KPiArc3RhdGljIGludCBhbGxv
Y2F0ZV9zY21fbWlub3Ioc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSkNCj4gK3sNCj4gKwlpbnQg
bWlub3I7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZtaW5vcnNfaWRyX2xvY2spOw0KPiArCW1pbm9y
ID0gaWRyX2FsbG9jKCZtaW5vcnNfaWRyLCBzY21fZGF0YSwgMCwgU0NNX05VTV9NSU5PUlMsIEdG
UF9LRVJORUwpOw0KPiArCW11dGV4X3VubG9jaygmbWlub3JzX2lkcl9sb2NrKTsNCj4gKwlyZXR1
cm4gbWlub3I7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGZyZWVfc2NtX21pbm9yKHN0cnVj
dCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJbXV0ZXhfbG9jaygmbWlub3JzX2lkcl9s
b2NrKTsNCj4gKwlpZHJfcmVtb3ZlKCZtaW5vcnNfaWRyLCBNSU5PUihzY21fZGF0YS0+ZGV2LmRl
dnQpKTsNCj4gKwltdXRleF91bmxvY2soJm1pbm9yc19pZHJfbG9jayk7DQo+ICt9DQo+ICsNCj4g
Ky8qKg0KPiArICogZnJlZV9zY20oKSAtIEZyZWUgYWxsIG1lbWJlcnMgb2YgYW4gU0NNIHN0cnVj
dA0KPiArICogQHNjbV9kYXRhOiB0aGUgU0NNIG1ldGFkYXRhIHRvIGNsZWFyDQo+ICsgKi8NCj4g
K3N0YXRpYyB2b2lkIGZyZWVfc2NtKHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+
ICsJLy8gRGlzYWJsZSBkb29yYmVsbHMNCj4gKwkodm9pZClvY3hsX2dsb2JhbF9tbWlvX3NldDY0
KHNjbV9kYXRhLT5vY3hsX2FmdSwgR0xPQkFMX01NSU9fQ0hJRUMsDQo+ICsJCQkJICAgICBPQ1hM
X0xJVFRMRV9FTkRJQU4sDQo+ICsJCQkJICAgICBHTE9CQUxfTU1JT19DSElfQUxMKTsNCj4gKw0K
PiArCWZyZWVfc2NtX21pbm9yKHNjbV9kYXRhKTsNCj4gKw0KPiArCWlmIChzY21fZGF0YS0+aXJx
X2FkZHJbMV0pDQo+ICsJCWlvdW5tYXAoc2NtX2RhdGEtPmlycV9hZGRyWzFdKTsNCj4gKw0KPiAr
CWlmIChzY21fZGF0YS0+aXJxX2FkZHJbMF0pDQo+ICsJCWlvdW5tYXAoc2NtX2RhdGEtPmlycV9h
ZGRyWzBdKTsNCj4gKw0KPiArCWlmIChzY21fZGF0YS0+Y2Rldi5vd25lcikNCj4gKwkJY2Rldl9k
ZWwoJnNjbV9kYXRhLT5jZGV2KTsNCj4gKw0KPiArCWlmIChzY21fZGF0YS0+bWV0YWRhdGFfYWRk
cikNCj4gKwkJZGV2bV9tZW11bm1hcCgmc2NtX2RhdGEtPmRldiwgc2NtX2RhdGEtPm1ldGFkYXRh
X2FkZHIpOw0KPiArDQo+ICsJaWYgKHNjbV9kYXRhLT5vY3hsX2NvbnRleHQpDQo+ICsJCW9jeGxf
Y29udGV4dF9mcmVlKHNjbV9kYXRhLT5vY3hsX2NvbnRleHQpOw0KPiArDQo+ICsJaWYgKHNjbV9k
YXRhLT5vY3hsX2FmdSkNCj4gKwkJb2N4bF9hZnVfcHV0KHNjbV9kYXRhLT5vY3hsX2FmdSk7DQo+
ICsNCj4gKwlpZiAoc2NtX2RhdGEtPm9jeGxfZm4pDQo+ICsJCW9jeGxfZnVuY3Rpb25fY2xvc2Uo
c2NtX2RhdGEtPm9jeGxfZm4pOw0KPiArDQo+ICsJa2ZyZWUoc2NtX2RhdGEpOw0KPiArfQ0KPiAr
DQo+ICsvKioNCj4gKyAqIGZyZWVfc2NtX2RldiAtIEZyZWUgYW4gU0NNIGRldmljZQ0KPiArICog
QGRldjogVGhlIGRldmljZSBzdHJ1Y3QNCj4gKyAqLw0KPiArc3RhdGljIHZvaWQgZnJlZV9zY21f
ZGV2KHN0cnVjdCBkZXZpY2UgKmRldikNCj4gK3sNCj4gKwlzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9k
YXRhID0gY29udGFpbmVyX29mKGRldiwgc3RydWN0IHNjbV9kYXRhLCBkZXYpOw0KPiArDQo+ICsJ
ZnJlZV9zY20oc2NtX2RhdGEpOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHNjbV9yZWdpc3Rl
ciAtIFJlZ2lzdGVyIGFuIFNDTSBkZXZpY2Ugd2l0aCB0aGUga2VybmVsDQo+ICsgKiBAc2NtX2Rh
dGE6IHRoZSBTQ00gbWV0YWRhdGENCj4gKyAqIFJldHVybjogMCBvbiBzdWNjZXNzLCBuZWdhdGl2
ZSBvbiBmYWlsdXJlDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgc2NtX3JlZ2lzdGVyKHN0cnVjdCBz
Y21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJaW50IHJjOw0KPiArCWludCBtaW5vciA9IGFs
bG9jYXRlX3NjbV9taW5vcihzY21fZGF0YSk7DQo+ICsNCj4gKwlpZiAobWlub3IgPCAwKQ0KPiAr
CQlyZXR1cm4gbWlub3I7DQo+ICsNCj4gKwlzY21fZGF0YS0+ZGV2LnJlbGVhc2UgPSBmcmVlX3Nj
bV9kZXY7DQo+ICsJcmMgPSBkZXZfc2V0X25hbWUoJnNjbV9kYXRhLT5kZXYsICJzY20lZCIsIG1p
bm9yKTsNCj4gKwlpZiAocmMgPCAwKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwlzY21fZGF0
YS0+ZGV2LmRldnQgPSBNS0RFVihNQUpPUihzY21fZGV2KSwgbWlub3IpOw0KPiArCXNjbV9kYXRh
LT5kZXYuY2xhc3MgPSBzY21fY2xhc3M7DQo+ICsJc2NtX2RhdGEtPmRldi5wYXJlbnQgPSAmc2Nt
X2RhdGEtPnBkZXYtPmRldjsNCj4gKw0KPiArCXJjID0gZGV2aWNlX3JlZ2lzdGVyKCZzY21fZGF0
YS0+ZGV2KTsNCj4gKwlyZXR1cm4gcmM7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHNjbV9w
dXQoc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSkNCj4gK3sNCj4gKwlwdXRfZGV2aWNlKCZzY21f
ZGF0YS0+ZGV2KTsNCj4gK30NCj4gKw0KPiArc3RydWN0IHNjbV9kYXRhICpzY21fZ2V0KHN0cnVj
dCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJcmV0dXJuIChnZXRfZGV2aWNlKCZzY21f
ZGF0YS0+ZGV2KSA9PSBOVUxMKSA/IE5VTEwgOiBzY21fZGF0YTsNCj4gK30NCj4gKw0KPiArc3Rh
dGljIHN0cnVjdCBzY21fZGF0YSAqZmluZF9hbmRfZ2V0X3NjbShkZXZfdCBkZXZubykNCj4gK3sN
Cj4gKwlzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhOw0KPiArCWludCBtaW5vciA9IE1JTk9SKGRl
dm5vKTsNCj4gKwkvKg0KPiArCSAqIFdlIGRvbid0IGRlY2xhcmUgYW4gUkNVIGNyaXRpY2FsIHNl
Y3Rpb24gaGVyZSwgYXMgb3VyIEFGVQ0KPiArCSAqIGlzIHByb3RlY3RlZCBieSBhIHJlZmVyZW5j
ZSBjb3VudGVyIG9uIHRoZSBkZXZpY2UuIEJ5IHRoZSB0aW1lIHRoZQ0KPiArCSAqIG1pbm9yIG51
bWJlciBvZiBhIGRldmljZSBpcyByZW1vdmVkIGZyb20gdGhlIGlkciwgdGhlIHJlZiBjb3VudCBv
Zg0KPiArCSAqIHRoZSBkZXZpY2UgaXMgYWxyZWFkeSBhdCAwLCBzbyBubyB1c2VyIEFQSSB3aWxs
IGFjY2VzcyB0aGF0IEFGVSBhbmQNCj4gKwkgKiB0aGlzIGZ1bmN0aW9uIGNhbid0IHJldHVybiBp
dC4NCj4gKwkgKi8NCj4gKwlzY21fZGF0YSA9IGlkcl9maW5kKCZtaW5vcnNfaWRyLCBtaW5vcik7
DQo+ICsJaWYgKHNjbV9kYXRhKQ0KPiArCQlzY21fZ2V0KHNjbV9kYXRhKTsNCj4gKwlyZXR1cm4g
c2NtX2RhdGE7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2ZpbGVfb3BlbihzdHJ1Y3Qg
aW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkNCj4gK3sNCj4gKwlzdHJ1Y3Qgc2NtX2Rh
dGEgKnNjbV9kYXRhOw0KPiArDQo+ICsJc2NtX2RhdGEgPSBmaW5kX2FuZF9nZXRfc2NtKGlub2Rl
LT5pX3JkZXYpOw0KPiArCWlmICghc2NtX2RhdGEpDQo+ICsJCXJldHVybiAtRU5PREVWOw0KPiAr
DQo+ICsJZmlsZS0+cHJpdmF0ZV9kYXRhID0gc2NtX2RhdGE7DQo+ICsJcmV0dXJuIDA7DQo+ICt9
DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2ZpbGVfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2Rl
LCBzdHJ1Y3QgZmlsZSAqZmlsZSkNCj4gK3sNCj4gKwlzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRh
ID0gZmlsZS0+cHJpdmF0ZV9kYXRhOw0KPiArDQo+ICsJaWYgKHNjbV9kYXRhLT5ldl9jdHgpIHsN
Cj4gKwkJZXZlbnRmZF9jdHhfcHV0KHNjbV9kYXRhLT5ldl9jdHgpOw0KPiArCQlzY21fZGF0YS0+
ZXZfY3R4ID0gTlVMTDsNCj4gKwl9DQo+ICsNCj4gKwlzY21fcHV0KHNjbV9kYXRhKTsNCj4gKwly
ZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBzY21faW9jdGxfYnVmZmVyX2luZm8o
c3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCQkgc3RydWN0IHNjbV9pb2N0bF9idWZm
ZXJfaW5mbyBfX3VzZXIgKnVhcmcpDQo+ICt7DQo+ICsJc3RydWN0IHNjbV9pb2N0bF9idWZmZXJf
aW5mbyBhcmdzOw0KPiArDQo+ICsJYXJncy5hZG1pbl9jb21tYW5kX2J1ZmZlcl9zaXplID0gc2Nt
X2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9zaXplOw0KPiArCWFyZ3MubmVhcl9zdG9yYWdlX2J1
ZmZlcl9zaXplID0gc2NtX2RhdGEtPm5zX2NvbW1hbmQuZGF0YV9zaXplOw0KPiArDQo+ICsJaWYg
KGNvcHlfdG9fdXNlcih1YXJnLCAmYXJncywgc2l6ZW9mKGFyZ3MpKSkNCj4gKwkJcmV0dXJuIC1F
RkFVTFQ7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBzY21f
ZXJyb3JfbG9nX29mZnNldF8weDAwKHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEsIHUxNiAqbGVu
Z3RoKQ0KPiArew0KPiArCWludCByYzsNCj4gKwl1NjQgdmFsOw0KPiArDQo+ICsJdTE2IGRhdGFf
aWRlbnRpZmllcjsNCj4gKwl1MzIgZGF0YV9sZW5ndGg7DQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xv
YmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkgICAgIHNjbV9kYXRh
LT5hZG1pbl9jb21tYW5kLmRhdGFfb2Zmc2V0LA0KPiArCQkJCSAgICAgT0NYTF9MSVRUTEVfRU5E
SUFOLCAmdmFsKTsNCj4gKwlpZiAocmMpDQo+ICsJCXJldHVybiByYzsNCj4gKw0KPiArCWRhdGFf
aWRlbnRpZmllciA9IHZhbCA+PiA0ODsNCj4gKwlkYXRhX2xlbmd0aCA9IHZhbCAmIDB4RkZGRjsN
Cj4gKw0KPiArCWlmIChkYXRhX2lkZW50aWZpZXIgIT0gMHg0NTRDKSB7DQo+ICsJCWRldl9lcnIo
JnNjbV9kYXRhLT5kZXYsDQo+ICsJCQkiQmFkIGRhdGEgaWRlbnRpZmllciBmb3IgZXJyb3IgbG9n
IGRhdGEsIGV4cGVjdGVkICdFTCcsIGdvdCAnJTJzJyAoJSN4KSwgZGF0YV9sZW5ndGg9JXVcbiIs
DQo+ICsJCQkoY2hhciAqKSZkYXRhX2lkZW50aWZpZXIsDQo+ICsJCQkodW5zaWduZWQgaW50KWRh
dGFfaWRlbnRpZmllciwgZGF0YV9sZW5ndGgpOw0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4gKwl9
DQo+ICsNCj4gKwkqbGVuZ3RoID0gZGF0YV9sZW5ndGg7DQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+
ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2Vycm9yX2xvZ19vZmZzZXRfMHgwOChzdHJ1Y3Qgc2NtX2Rh
dGEgKnNjbV9kYXRhLA0KPiArCQkJCSAgICAgdTMyICpsb2dfaWRlbnRpZmllciwgdTMyICpwcm9n
cmFtX3JlZl9jb2RlKQ0KPiArew0KPiArCWludCByYzsNCj4gKwl1NjQgdmFsOw0KPiArDQo+ICsJ
cmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJ
ICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCArIDB4MDgsDQo+ICsJCQkJ
ICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sICZ2YWwpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJu
IHJjOw0KPiArDQo+ICsJKmxvZ19pZGVudGlmaWVyID0gdmFsID4+IDMyOw0KPiArCSpwcm9ncmFt
X3JlZl9jb2RlID0gdmFsICYgMHhGRkZGRkZGRjsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0K
PiArDQo+ICtzdGF0aWMgaW50IHNjbV9yZWFkX2Vycm9yX2xvZyhzdHJ1Y3Qgc2NtX2RhdGEgKnNj
bV9kYXRhLA0KPiArCQkJICAgICAgc3RydWN0IHNjbV9pb2N0bF9lcnJvcl9sb2cgKmxvZywgYm9v
bCBidWZfaXNfdXNlcikNCj4gK3sNCj4gKwl1NjQgdmFsOw0KPiArCXUxNiB1c2VyX2J1Zl9sZW5n
dGg7DQo+ICsJdTE2IGJ1Zl9sZW5ndGg7DQo+ICsJdTE2IGk7DQo+ICsJaW50IHJjOw0KPiArDQo+
ICsJaWYgKGxvZy0+YnVmX3NpemUgJSA4KQ0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiAr
CXJjID0gc2NtX2NoaShzY21fZGF0YSwgJnZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91
dDsNCj4gKw0KPiArCWlmICghKHZhbCAmIEdMT0JBTF9NTUlPX0NISV9FTEEpKQ0KPiArCQlyZXR1
cm4gLUVBR0FJTjsNCj4gKw0KPiArCXVzZXJfYnVmX2xlbmd0aCA9IGxvZy0+YnVmX3NpemU7DQo+
ICsNCj4gKwltdXRleF9sb2NrKCZzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5sb2NrKTsNCj4gKw0K
PiArCXJjID0gc2NtX2FkbWluX2NvbW1hbmRfcmVxdWVzdChzY21fZGF0YSwgQURNSU5fQ09NTUFO
RF9FUlJMT0cpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKwlyYyA9IHNj
bV9hZG1pbl9jb21tYW5kX2V4ZWN1dGUoc2NtX2RhdGEpOw0KPiArCWlmIChyYykNCj4gKwkJZ290
byBvdXQ7DQo+ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9jb21tYW5kX2NvbXBsZXRlX3RpbWVvdXQo
c2NtX2RhdGEsIEFETUlOX0NPTU1BTkRfRVJSTE9HKTsNCj4gKwlpZiAocmMgPCAwKSB7DQo+ICsJ
CWRldl93YXJuKCZzY21fZGF0YS0+ZGV2LCAiUmVhZCBlcnJvciBsb2cgdGltZWQgb3V0XG4iKTsN
Cj4gKwkJZ290byBvdXQ7DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fcmVzcG9uc2Uo
c2NtX2RhdGEpOw0KPiArCWlmIChyYyA8IDApDQo+ICsJCWdvdG8gb3V0Ow0KPiArCWlmIChyYyAh
PSBTVEFUVVNfU1VDQ0VTUykgew0KPiArCQlzY21fd2Fybl9zdGF0dXMoc2NtX2RhdGEsICJVbmV4
cGVjdGVkIHN0YXR1cyBmcm9tIHJldHJpZXZlIGVycm9yIGxvZyIsIHJjKTsNCj4gKwkJZ290byBv
dXQ7DQo+ICsJfQ0KPiArDQo+ICsNCj4gKwlyYyA9IHNjbV9lcnJvcl9sb2dfb2Zmc2V0XzB4MDAo
c2NtX2RhdGEsICZsb2ctPmJ1Zl9zaXplKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0K
PiArCS8vIGxvZy0+YnVmX3NpemUgbm93IGNvbnRhaW5zIHRoZSBzY20gYnVmZmVyIHNpemUsIG5v
dCB0aGUgdXNlciBzaXplDQo+ICsNCj4gKwlyYyA9IHNjbV9lcnJvcl9sb2dfb2Zmc2V0XzB4MDgo
c2NtX2RhdGEsICZsb2ctPmxvZ19pZGVudGlmaWVyLA0KPiArCQkJCSAgICAgICAmbG9nLT5wcm9n
cmFtX3JlZmVyZW5jZV9jb2RlKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+
ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJ
CQkJICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCArIDB4MTAsDQo+ICsJ
CQkJICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sICZ2YWwpOw0KPiArCWlmIChyYykNCj4gKwkJZ290
byBvdXQ7DQo+ICsNCj4gKwlsb2ctPmVycm9yX2xvZ190eXBlID0gdmFsID4+IDU2Ow0KPiArCWxv
Zy0+YWN0aW9uX2ZsYWdzID0gKGxvZy0+ZXJyb3JfbG9nX3R5cGUgPT0gU0NNX0VSUk9SX0xPR19U
WVBFX0dFTkVSQUwpID8NCj4gKwkJCSAgICAodmFsID4+IDMyKSAmIDB4RkZGRkZGIDogMDsNCj4g
Kwlsb2ctPnBvd2VyX29uX3NlY29uZHMgPSB2YWwgJiAweEZGRkZGRkZGOw0KPiArDQo+ICsJcmMg
PSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJICAg
ICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCArIDB4MTgsDQo+ICsJCQkJICAg
ICBPQ1hMX0xJVFRMRV9FTkRJQU4sICZsb2ctPnRpbWVzdGFtcCk7DQo+ICsJaWYgKHJjKQ0KPiAr
CQlnb3RvIG91dDsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2Rh
dGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9v
ZmZzZXQgKyAweDIwLA0KPiArCQkJCSAgICAgT0NYTF9IT1NUX0VORElBTiwgJmxvZy0+d3dpZFsw
XSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9i
YWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgc2NtX2RhdGEt
PmFkbWluX2NvbW1hbmQuZGF0YV9vZmZzZXQgKyAweDI4LA0KPiArCQkJCSAgICAgT0NYTF9IT1NU
X0VORElBTiwgJmxvZy0+d3dpZFsxXSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4g
Kw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0K
PiArCQkJCSAgICAgc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9vZmZzZXQgKyAweDMwLA0K
PiArCQkJCSAgICAgT0NYTF9IT1NUX0VORElBTiwgKHU2NCAqKWxvZy0+ZndfcmV2aXNpb24pOw0K
PiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsJbG9nLT5md19yZXZpc2lvbls4XSA9ICdc
MCc7DQo+ICsNCj4gKwlidWZfbGVuZ3RoID0gKHVzZXJfYnVmX2xlbmd0aCA8IGxvZy0+YnVmX3Np
emUpID8NCj4gKwkJICAgICB1c2VyX2J1Zl9sZW5ndGggOiBsb2ctPmJ1Zl9zaXplOw0KPiArCWZv
ciAoaSA9IDA7IGkgPCBidWZfbGVuZ3RoICsgMHg0ODsgaSArPSA4KSB7DQo+ICsJCXU2NCB2YWw7
DQo+ICsNCj4gKwkJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9h
ZnUsDQo+ICsJCQkJCSAgICAgc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9vZmZzZXQgKyBp
LA0KPiArCQkJCQkgICAgIE9DWExfSE9TVF9FTkRJQU4sICZ2YWwpOw0KPiArCQlpZiAocmMpDQo+
ICsJCQlnb3RvIG91dDsNCj4gKw0KPiArCQlpZiAoYnVmX2lzX3VzZXIpIHsNCj4gKwkJCWlmIChj
b3B5X3RvX3VzZXIoJmxvZy0+YnVmW2ldLCAmdmFsLCBzaXplb2YodTY0KSkpIHsNCj4gKwkJCQly
YyA9IC1FRkFVTFQ7DQo+ICsJCQkJZ290byBvdXQ7DQo+ICsJCQl9DQo+ICsJCX0gZWxzZQ0KPiAr
CQkJbG9nLT5idWZbaV0gPSB2YWw7DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fcmVz
cG9uc2VfaGFuZGxlZChzY21fZGF0YSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4g
Kw0KPiArb3V0Og0KPiArCW11dGV4X3VubG9jaygmc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQubG9j
ayk7DQo+ICsJcmV0dXJuIHJjOw0KPiArDQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2lv
Y3RsX2Vycm9yX2xvZyhzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJICAgICAgIHN0
cnVjdCBzY21faW9jdGxfZXJyb3JfbG9nIF9fdXNlciAqdWFyZykNCj4gK3sNCj4gKwlzdHJ1Y3Qg
c2NtX2lvY3RsX2Vycm9yX2xvZyBhcmdzOw0KPiArCWludCByYzsNCj4gKw0KPiArCWlmIChjb3B5
X2Zyb21fdXNlcigmYXJncywgdWFyZywgc2l6ZW9mKGFyZ3MpKSkNCj4gKwkJcmV0dXJuIC1FRkFV
TFQ7DQo+ICsNCj4gKwlyYyA9IHNjbV9yZWFkX2Vycm9yX2xvZyhzY21fZGF0YSwgJmFyZ3MsIHRy
dWUpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJuIHJjOw0KPiArDQo+ICsJaWYgKGNvcHlfdG9f
dXNlcih1YXJnLCAmYXJncywgc2l6ZW9mKGFyZ3MpKSkNCj4gKwkJcmV0dXJuIC1FRkFVTFQ7DQo+
ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBzY21faW9jdGxfY29u
dHJvbGxlcl9kdW1wX2RhdGEoc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwlzdHJ1Y3Qg
c2NtX2lvY3RsX2NvbnRyb2xsZXJfZHVtcF9kYXRhIF9fdXNlciAqdWFyZykNCj4gK3sNCj4gKwlz
dHJ1Y3Qgc2NtX2lvY3RsX2NvbnRyb2xsZXJfZHVtcF9kYXRhIGFyZ3M7DQo+ICsJdTE2IGk7DQo+
ICsJdTY0IHZhbDsNCj4gKwlpbnQgcmM7DQo+ICsNCj4gKwlpZiAoY29weV9mcm9tX3VzZXIoJmFy
Z3MsIHVhcmcsIHNpemVvZihhcmdzKSkpDQo+ICsJCXJldHVybiAtRUZBVUxUOw0KPiArDQo+ICsJ
aWYgKGFyZ3MuYnVmX3NpemUgJSA4KQ0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArCWlm
IChhcmdzLmJ1Zl9zaXplID4gc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9zaXplKQ0KPiAr
CQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArCW11dGV4X2xvY2soJnNjbV9kYXRhLT5hZG1pbl9j
b21tYW5kLmxvY2spOw0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fY29tbWFuZF9yZXF1ZXN0KHNj
bV9kYXRhLCBBRE1JTl9DT01NQU5EX0NPTlRST0xMRVJfRFVNUCk7DQo+ICsJaWYgKHJjKQ0KPiAr
CQlnb3RvIG91dDsNCj4gKw0KPiArCXZhbCA9ICgodTY0KWFyZ3Mub2Zmc2V0KSA8PCAzMjsNCj4g
Kwl2YWwgfD0gYXJncy5idWZfc2l6ZTsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21taW9fd3JpdGU2
NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJICAgICAgc2NtX2RhdGEtPmFkbWluX2NvbW1h
bmQucmVxdWVzdF9vZmZzZXQgKyAweDA4LA0KPiArCQkJCSAgICAgIE9DWExfTElUVExFX0VORElB
TiwgdmFsKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMgPSBzY21f
YWRtaW5fY29tbWFuZF9leGVjdXRlKHNjbV9kYXRhKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8g
b3V0Ow0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fY29tbWFuZF9jb21wbGV0ZV90aW1lb3V0KHNj
bV9kYXRhLA0KPiArCQkJCQkJQURNSU5fQ09NTUFORF9DT05UUk9MTEVSX0RVTVApOw0KPiArCWlm
IChyYyA8IDApIHsNCj4gKwkJZGV2X3dhcm4oJnNjbV9kYXRhLT5kZXYsICJDb250cm9sbGVyIGR1
bXAgdGltZWQgb3V0XG4iKTsNCj4gKwkJZ290byBvdXQ7DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBz
Y21fYWRtaW5fcmVzcG9uc2Uoc2NtX2RhdGEpOw0KPiArCWlmIChyYyA8IDApDQo+ICsJCWdvdG8g
b3V0Ow0KPiArCWlmIChyYyAhPSBTVEFUVVNfU1VDQ0VTUykgew0KPiArCQlzY21fd2Fybl9zdGF0
dXMoc2NtX2RhdGEsDQo+ICsJCQkJIlVuZXhwZWN0ZWQgc3RhdHVzIGZyb20gcmV0cmlldmUgZXJy
b3IgbG9nIiwNCj4gKwkJCQlyYyk7DQo+ICsJCWdvdG8gb3V0Ow0KPiArCX0NCj4gKw0KPiArCWZv
ciAoaSA9IDA7IGkgPCBhcmdzLmJ1Zl9zaXplOyBpICs9IDgpIHsNCj4gKwkJdTY0IHZhbDsNCj4g
Kw0KPiArCQlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwN
Cj4gKwkJCQkJICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCArIGksDQo+
ICsJCQkJCSAgICAgT0NYTF9IT1NUX0VORElBTiwgJnZhbCk7DQo+ICsJCWlmIChyYykNCj4gKwkJ
CWdvdG8gb3V0Ow0KPiArDQo+ICsJCWlmIChjb3B5X3RvX3VzZXIoJmFyZ3MuYnVmW2ldLCAmdmFs
LCBzaXplb2YodTY0KSkpIHsNCj4gKwkJCXJjID0gLUVGQVVMVDsNCj4gKwkJCWdvdG8gb3V0Ow0K
PiArCQl9DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGNvcHlfdG9fdXNlcih1YXJnLCAmYXJncywgc2l6
ZW9mKGFyZ3MpKSkgew0KPiArCQlyYyA9IC1FRkFVTFQ7DQo+ICsJCWdvdG8gb3V0Ow0KPiArCX0N
Cj4gKw0KPiArCXJjID0gc2NtX2FkbWluX3Jlc3BvbnNlX2hhbmRsZWQoc2NtX2RhdGEpOw0KPiAr
CWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gK291dDoNCj4gKwltdXRleF91bmxvY2so
JnNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmxvY2spOw0KPiArCXJldHVybiByYzsNCj4gK30NCj4g
Kw0KPiAraW50IHNjbV9yZXF1ZXN0X2NvbnRyb2xsZXJfZHVtcChzdHJ1Y3Qgc2NtX2RhdGEgKnNj
bV9kYXRhKQ0KPiArew0KPiArCWludCByYzsNCj4gKwl1NjQgYnVzeSA9IDE7DQo+ICsNCj4gKwly
YyA9IG9jeGxfZ2xvYmFsX21taW9fc2V0NjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1J
T19DSElDLA0KPiArCQkJCSAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sDQo+ICsJCQkJICAgIEdMT0JB
TF9NTUlPX0NISV9DREEpOw0KPiArDQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21taW9fc2V0
NjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1JT19IQ0ksDQo+ICsJCQkJICAgIE9DWExf
TElUVExFX0VORElBTiwNCj4gKwkJCQkgICAgR0xPQkFMX01NSU9fSENJX0NPTlRST0xMRVJfRFVN
UCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwl3aGlsZSAoYnVzeSkg
ew0KPiArCQlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwN
Cj4gKwkJCQkJICAgICBHTE9CQUxfTU1JT19IQ0ksDQo+ICsJCQkJCSAgICAgT0NYTF9MSVRUTEVf
RU5ESUFOLCAmYnVzeSk7DQo+ICsJCWlmIChyYykNCj4gKwkJCXJldHVybiByYzsNCj4gKw0KPiAr
CQlidXN5ICY9IEdMT0JBTF9NTUlPX0hDSV9DT05UUk9MTEVSX0RVTVA7DQo+ICsJCWNvbmRfcmVz
Y2hlZCgpOw0KPiArCX0NCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMg
aW50IHNjbV9pb2N0bF9jb250cm9sbGVyX2R1bXBfY29tcGxldGUoc3RydWN0IHNjbV9kYXRhICpz
Y21fZGF0YSkNCj4gK3sNCj4gKwlpbnQgcmM7DQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21t
aW9fc2V0NjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1JT19IQ0ksDQo+ICsJCQkJICAg
IE9DWExfTElUVExFX0VORElBTiwNCj4gKwkJCQkgICAgR0xPQkFMX01NSU9fSENJX0NPTlRST0xM
RVJfRFVNUF9DT0xMRUNURUQpOw0KPiArDQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gLUVGQVVM
VDsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IHNjbV9jb250
cm9sbGVyX3N0YXRzX29mZnNldF8weDAwKHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEsDQo+ICsJ
dTMyICpsZW5ndGgpDQo+ICt7DQo+ICsJaW50IHJjOw0KPiArCXU2NCB2YWw7DQo+ICsNCj4gKwl1
MTYgZGF0YV9pZGVudGlmaWVyOw0KPiArCXUzMiBkYXRhX2xlbmd0aDsNCj4gKw0KPiArCXJjID0g
b2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAg
c2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9vZmZzZXQsDQo+ICsJCQkJICAgICBPQ1hMX0xJ
VFRMRV9FTkRJQU4sICZ2YWwpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJuIHJjOw0KPiArDQo+
ICsJZGF0YV9pZGVudGlmaWVyID0gdmFsID4+IDQ4Ow0KPiArCWRhdGFfbGVuZ3RoID0gdmFsICYg
MHhGRkZGRkZGRjsNCj4gKw0KPiArCWlmIChkYXRhX2lkZW50aWZpZXIgIT0gMHg0MzUzKSB7DQo+
ICsJCWRldl9lcnIoJnNjbV9kYXRhLT5kZXYsDQo+ICsJCQkiQmFkIGRhdGEgaWRlbnRpZmllciBm
b3IgY29udHJvbGxlciBzdGF0cywgZXhwZWN0ZWQgJ0NTJywgZ290ICclLS4qcydcbiIsDQo+ICsJ
CQkyLCAoY2hhciAqKSZkYXRhX2lkZW50aWZpZXIpOw0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4g
Kwl9DQo+ICsNCj4gKwkqbGVuZ3RoID0gZGF0YV9sZW5ndGg7DQo+ICsJcmV0dXJuIDA7DQo+ICt9
DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2lvY3RsX2NvbnRyb2xsZXJfc3RhdHMoc3RydWN0IHNj
bV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCQkgICAgICBzdHJ1Y3Qgc2NtX2lvY3RsX2NvbnRyb2xs
ZXJfc3RhdHMgX191c2VyICp1YXJnKQ0KPiArew0KPiArCXN0cnVjdCBzY21faW9jdGxfY29udHJv
bGxlcl9zdGF0cyBhcmdzOw0KPiArCXUzMiBsZW5ndGg7DQo+ICsJaW50IHJjOw0KPiArCXU2NCB2
YWw7DQo+ICsNCj4gKwltZW1zZXQoJmFyZ3MsICdcMCcsIHNpemVvZihhcmdzKSk7DQo+ICsNCj4g
KwltdXRleF9sb2NrKCZzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5sb2NrKTsNCj4gKw0KPiArCXJj
ID0gc2NtX2FkbWluX2NvbW1hbmRfcmVxdWVzdChzY21fZGF0YSwgQURNSU5fQ09NTUFORF9DT05U
Uk9MTEVSX1NUQVRTKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMg
PSBvY3hsX2dsb2JhbF9tbWlvX3dyaXRlNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAg
ICAgIHNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLnJlcXVlc3Rfb2Zmc2V0ICsgMHgwOCwNCj4gKwkJ
CQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sIDApOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBv
dXQ7DQo+ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9jb21tYW5kX2V4ZWN1dGUoc2NtX2RhdGEpOw0K
PiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKw0KPiArCXJjID0gc2NtX2FkbWlu
X2NvbW1hbmRfY29tcGxldGVfdGltZW91dChzY21fZGF0YSwNCj4gKwkJCQkJCUFETUlOX0NPTU1B
TkRfQ09OVFJPTExFUl9TVEFUUyk7DQo+ICsJaWYgKHJjIDwgMCkgew0KPiArCQlkZXZfd2Fybigm
c2NtX2RhdGEtPmRldiwgIkNvbnRyb2xsZXIgc3RhdHMgdGltZWQgb3V0XG4iKTsNCj4gKwkJZ290
byBvdXQ7DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fcmVzcG9uc2Uoc2NtX2RhdGEp
Ow0KPiArCWlmIChyYyA8IDApDQo+ICsJCWdvdG8gb3V0Ow0KPiArCWlmIChyYyAhPSBTVEFUVVNf
U1VDQ0VTUykgew0KPiArCQlzY21fd2Fybl9zdGF0dXMoc2NtX2RhdGEsDQo+ICsJCQkJIlVuZXhw
ZWN0ZWQgc3RhdHVzIGZyb20gY29udHJvbGxlciBzdGF0cyIsIHJjKTsNCj4gKwkJZ290byBvdXQ7
DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBzY21fY29udHJvbGxlcl9zdGF0c19vZmZzZXRfMHgwMChz
Y21fZGF0YSwgJmxlbmd0aCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiAr
CWlmIChsZW5ndGggIT0gMHgxNDApDQo+ICsJCXNjbV93YXJuX3N0YXR1cyhzY21fZGF0YSwNCj4g
KwkJCQkiVW5leHBlY3RlZCBsZW5ndGggZm9yIGNvbnRyb2xsZXIgc3RhdHMgZGF0YSwgZXhwZWN0
ZWQgMHgxNDAsIGdvdCAweCV4IiwNCj4gKwkJCQlsZW5ndGgpOw0KPiArDQo+ICsJcmMgPSBvY3hs
X2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJICAgICBzY21f
ZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCArIDB4MDggKyAweDA4LA0KPiArCQkJCSAg
ICAgT0NYTF9MSVRUTEVfRU5ESUFOLCAmdmFsKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0
Ow0KPiArDQo+ICsJYXJncy5yZXNldF9jb3VudCA9IHZhbCA+PiAzMjsNCj4gKwlhcmdzLnJlc2V0
X3VwdGltZSA9IHZhbCAmIDB4RkZGRkZGRkY7DQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21t
aW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkgICAgIHNjbV9kYXRhLT5hZG1p
bl9jb21tYW5kLmRhdGFfb2Zmc2V0ICsgMHgwOCArIDB4MTAsDQo+ICsJCQkJICAgICBPQ1hMX0xJ
VFRMRV9FTkRJQU4sICZ2YWwpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4g
KwlhcmdzLnBvd2VyX29uX3VwdGltZSA9IHZhbCA+PiAzMjsNCj4gKw0KPiArCXJjID0gb2N4bF9n
bG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgc2NtX2Rh
dGEtPmFkbWluX2NvbW1hbmQuZGF0YV9vZmZzZXQgKyAweDA4ICsgMHg0MCArIDB4MDgsDQo+ICsJ
CQkJICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sICZhcmdzLmhvc3RfbG9hZF9jb3VudCk7DQo+ICsJ
aWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19y
ZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgc2NtX2RhdGEtPmFkbWluX2Nv
bW1hbmQuZGF0YV9vZmZzZXQgKyAweDA4ICsgMHg0MCArIDB4MTAsDQo+ICsJCQkJICAgICBPQ1hM
X0xJVFRMRV9FTkRJQU4sICZhcmdzLmhvc3Rfc3RvcmVfY291bnQpOw0KPiArCWlmIChyYykNCj4g
KwkJZ290byBvdXQ7DQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9k
YXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkgICAgIHNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmRhdGFf
b2Zmc2V0ICsgMHgwOCArIDB4NDAgKyAweDE4LA0KPiArCQkJCSAgICAgT0NYTF9MSVRUTEVfRU5E
SUFOLCAmYXJncy5tZWRpYV9yZWFkX2NvdW50KTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0
Ow0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0YS0+b2N4bF9h
ZnUsDQo+ICsJCQkJICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5kYXRhX29mZnNldCArIDB4
MDggKyAweDQwICsgMHgyMCwNCj4gKwkJCQkgICAgIE9DWExfTElUVExFX0VORElBTiwgJmFyZ3Mu
bWVkaWFfd3JpdGVfY291bnQpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4g
KwlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJ
CQkgICAgIHNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmRhdGFfb2Zmc2V0ICsgMHgwOCArIDB4NDAg
KyAweDI4LA0KPiArCQkJCSAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLCAmYXJncy5jYWNoZV9oaXRf
Y291bnQpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKwlyYyA9IG9jeGxf
Z2xvYmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkgICAgIHNjbV9k
YXRhLT5hZG1pbl9jb21tYW5kLmRhdGFfb2Zmc2V0ICsgMHgwOCArIDB4NDAgKyAweDMwLA0KPiAr
CQkJCSAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLCAmYXJncy5jYWNoZV9taXNzX2NvdW50KTsNCj4g
KwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlv
X3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJICAgICBzY21fZGF0YS0+YWRtaW5f
Y29tbWFuZC5kYXRhX29mZnNldCArIDB4MDggKyAweDQwICsgMHgzOCwNCj4gKwkJCQkgICAgIE9D
WExfTElUVExFX0VORElBTiwgJmFyZ3MubWVkaWFfcmVhZF9sYXRlbmN5KTsNCj4gKwlpZiAocmMp
DQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChz
Y21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5k
YXRhX29mZnNldCArIDB4MDggKyAweDQwICsgMHg0MCwNCj4gKwkJCQkgICAgIE9DWExfTElUVExF
X0VORElBTiwgJmFyZ3MubWVkaWFfd3JpdGVfbGF0ZW5jeSk7DQo+ICsJaWYgKHJjKQ0KPiArCQln
b3RvIG91dDsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEt
Pm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9vZmZz
ZXQgKyAweDA4ICsgMHg0MCArIDB4NDgsDQo+ICsJCQkJICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4s
ICZhcmdzLmNhY2hlX3JlYWRfbGF0ZW5jeSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsN
Cj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1
LA0KPiArCQkJCSAgICAgc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9vZmZzZXQgKyAweDA4
ICsgMHg0MCArIDB4NTAsDQo+ICsJCQkJICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sICZhcmdzLmNh
Y2hlX3dyaXRlX2xhdGVuY3kpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4g
KwlpZiAoY29weV90b191c2VyKHVhcmcsICZhcmdzLCBzaXplb2YoYXJncykpKSB7DQo+ICsJCXJj
ID0gLUVGQVVMVDsNCj4gKwkJZ290byBvdXQ7DQo+ICsJfQ0KPiArDQo+ICsJcmMgPSBzY21fYWRt
aW5fcmVzcG9uc2VfaGFuZGxlZChzY21fZGF0YSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91
dDsNCj4gKw0KPiArCXJjID0gMDsNCj4gKwlnb3RvIG91dDsNCj4gKw0KPiArb3V0Og0KPiArCW11
dGV4X3VubG9jaygmc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQubG9jayk7DQo+ICsJcmV0dXJuIHJj
Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IHNjbV9pb2N0bF9ldmVudGZkKHN0cnVjdCBzY21f
ZGF0YSAqc2NtX2RhdGEsDQo+ICsJCQkgICAgIHN0cnVjdCBzY21faW9jdGxfZXZlbnRmZCBfX3Vz
ZXIgKnVhcmcpDQo+ICt7DQo+ICsJc3RydWN0IHNjbV9pb2N0bF9ldmVudGZkIGFyZ3M7DQo+ICsN
Cj4gKwlpZiAoY29weV9mcm9tX3VzZXIoJmFyZ3MsIHVhcmcsIHNpemVvZihhcmdzKSkpDQo+ICsJ
CXJldHVybiAtRUZBVUxUOw0KPiArDQo+ICsJaWYgKHNjbV9kYXRhLT5ldl9jdHgpDQo+ICsJCXJl
dHVybiAtRUZBVUxUOw0KPiArDQo+ICsJc2NtX2RhdGEtPmV2X2N0eCA9IGV2ZW50ZmRfY3R4X2Zk
Z2V0KGFyZ3MuZXZlbnRmZCk7DQo+ICsJaWYgKCFzY21fZGF0YS0+ZXZfY3R4KQ0KPiArCQlyZXR1
cm4gLUVGQVVMVDsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50
IHNjbV9pb2N0bF9ldmVudF9jaGVjayhzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLCB1NjQgX191
c2VyICp1YXJnKQ0KPiArew0KPiArCXU2NCB2YWwgPSAwOw0KPiArCWludCByYzsNCj4gKwl1NjQg
Y2hpID0gMDsNCj4gKw0KPiArCXJjID0gc2NtX2NoaShzY21fZGF0YSwgJmNoaSk7DQo+ICsJaWYg
KHJjIDwgMCkNCj4gKwkJcmV0dXJuIC1FRkFVTFQ7DQo+ICsNCj4gKwlpZiAoY2hpICYgR0xPQkFM
X01NSU9fQ0hJX0VMQSkNCj4gKwkJdmFsIHw9IFNDTV9JT0NUTF9FVkVOVF9FUlJPUl9MT0dfQVZB
SUxBQkxFOw0KPiArDQo+ICsJaWYgKGNoaSAmIEdMT0JBTF9NTUlPX0NISV9DREEpDQo+ICsJCXZh
bCB8PSBTQ01fSU9DVExfRVZFTlRfQ09OVFJPTExFUl9EVU1QX0FWQUlMQUJMRTsNCj4gKw0KPiAr
CWlmIChjaGkgJiBHTE9CQUxfTU1JT19DSElfQ0ZGUykNCj4gKwkJdmFsIHw9IFNDTV9JT0NUTF9F
VkVOVF9GSVJNV0FSRV9GQVRBTDsNCj4gKw0KPiArCWlmIChjaGkgJiBHTE9CQUxfTU1JT19DSElf
Q0hGUykNCj4gKwkJdmFsIHw9IFNDTV9JT0NUTF9FVkVOVF9IQVJEV0FSRV9GQVRBTDsNCj4gKw0K
PiArCXJjID0gY29weV90b191c2VyKCh1NjQgX191c2VyICopIHVhcmcsICZ2YWwsIHNpemVvZih2
YWwpKTsNCj4gKw0KPiArCXJldHVybiByYzsNCj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBzY21f
cmVxX2NvbnRyb2xsZXJfaGVhbHRoX3BlcmYoKSAtIFJlcXVlc3QgY29udHJvbGxlciBoZWFsdGgg
JiBwZXJmb3JtYW5jZSBkYXRhDQo+ICsgKiBAc2NtX2RhdGE6IHRoZSBTQ00gbWV0YWRhdGENCj4g
KyAqIFJldHVybjogMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBmYWlsdXJlDQo+ICsgKi8NCj4g
K2ludCBzY21fcmVxX2NvbnRyb2xsZXJfaGVhbHRoX3BlcmYoc3RydWN0IHNjbV9kYXRhICpzY21f
ZGF0YSkNCj4gK3sNCj4gKwlyZXR1cm4gb2N4bF9nbG9iYWxfbW1pb19zZXQ2NChzY21fZGF0YS0+
b2N4bF9hZnUsIEdMT0JBTF9NTUlPX0hDSSwNCj4gKwkJCQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJ
QU4sDQo+ICsJCQkJICAgICAgR0xPQkFMX01NSU9fSENJX1JFUV9IRUFMVEhfUEVSRik7DQo+ICt9
DQo+ICsNCj4gKyNpZmRlZiBDT05GSUdfT0NYTF9TQ01fREVCVUcNCj4gKy8qKg0KPiArICogc2Nt
X2VuYWJsZV9md2RlYnVnKCkgLSBFbmFibGUgRlcgZGVidWcgb24gdGhlIGNvbnRyb2xsZXINCj4g
KyAqIEBzY21fZGF0YTogYSBwb2ludGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqIFJl
dHVybjogMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBmYWlsdXJlDQo+ICsgKi8NCj4gK3N0YXRp
YyBpbnQgc2NtX2VuYWJsZV9md2RlYnVnKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEp
DQo+ICt7DQo+ICsJcmV0dXJuIG9jeGxfZ2xvYmFsX21taW9fc2V0NjQoc2NtX2RhdGEtPm9jeGxf
YWZ1LCBHTE9CQUxfTU1JT19IQ0ksDQo+ICsJCQkJICAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLA0K
PiArCQkJCSAgICAgIEdMT0JBTF9NTUlPX0hDSV9GV19ERUJVRyk7DQo+ICt9DQo+ICsNCj4gKy8q
Kg0KPiArICogc2NtX2Rpc2FibGVfZndkZWJ1ZygpIC0gRGlzYWJsZSBGVyBkZWJ1ZyBvbiB0aGUg
Y29udHJvbGxlcg0KPiArICogQHNjbV9kYXRhOiBhIHBvaW50ZXIgdG8gdGhlIFNDTSBkZXZpY2Ug
ZGF0YQ0KPiArICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIG9uIGZhaWx1cmUNCj4g
KyAqLw0KPiArc3RhdGljIGludCBzY21fZGlzYWJsZV9md2RlYnVnKGNvbnN0IHN0cnVjdCBzY21f
ZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJcmV0dXJuIG9jeGxfZ2xvYmFsX21taW9fc2V0NjQo
c2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1JT19IQ0lDLA0KPiArCQkJCSAgICAgIE9DWExf
TElUVExFX0VORElBTiwNCj4gKwkJCQkgICAgICBHTE9CQUxfTU1JT19IQ0lfRldfREVCVUcpOw0K
PiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IHNjbV9pb2N0bF9md2RlYnVnKHN0cnVjdCBzY21fZGF0
YSAqc2NtX2RhdGEsDQo+ICsJCQkgICAgIHN0cnVjdCBzY21faW9jdGxfZndkZWJ1ZyBfX3VzZXIg
KnVhcmcpDQo+ICt7DQo+ICsJc3RydWN0IHNjbV9pb2N0bF9md2RlYnVnIGFyZ3M7DQo+ICsJdTY0
IHZhbDsNCj4gKwlpbnQgaTsNCj4gKwlpbnQgcmM7DQo+ICsNCj4gKwlpZiAoY29weV9mcm9tX3Vz
ZXIoJmFyZ3MsIHVhcmcsIHNpemVvZihhcmdzKSkpDQo+ICsJCXJldHVybiAtRUZBVUxUOw0KPiAr
DQo+ICsJLy8gQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDgNCj4gKwlpZiAoKGFy
Z3MuYnVmX3NpemUgJiAweDA3KSkNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwlpZiAo
YXJncy5idWZfc2l6ZSA+IHNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmRhdGFfc2l6ZSkNCj4gKwkJ
cmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwltdXRleF9sb2NrKCZzY21fZGF0YS0+YWRtaW5fY29t
bWFuZC5sb2NrKTsNCj4gKw0KPiArCXJjID0gc2NtX2VuYWJsZV9md2RlYnVnKHNjbV9kYXRhKTsN
Cj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fY29t
bWFuZF9yZXF1ZXN0KHNjbV9kYXRhLCBBRE1JTl9DT01NQU5EX0ZXX0RFQlVHKTsNCj4gKwlpZiAo
cmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJLy8gV3JpdGUgRGVidWdBY3Rpb24gJiBGdW5j
dGlvbkNvZGUNCj4gKwl2YWwgPSAoKHU2NClhcmdzLmRlYnVnX2FjdGlvbiA8PCA1NikgfCAoKHU2
NClhcmdzLmZ1bmN0aW9uX2NvZGUgPDwgNDApOw0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9t
bWlvX3dyaXRlNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgIHNjbV9kYXRhLT5h
ZG1pbl9jb21tYW5kLnJlcXVlc3Rfb2Zmc2V0ICsgMHgwOCwNCj4gKwkJCQkgICAgICBPQ1hMX0xJ
VFRMRV9FTkRJQU4sIHZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dDsNCj4gKw0KPiAr
CXJjID0gb2N4bF9nbG9iYWxfbW1pb193cml0ZTY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJ
CQkgICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5yZXF1ZXN0X29mZnNldCArIDB4MTAsDQo+
ICsJCQkJICAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLCBhcmdzLmRlYnVnX3BhcmFtZXRlcl8xKTsN
Cj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMgPSBvY3hsX2dsb2JhbF9t
bWlvX3dyaXRlNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCSAgICAgIHNjbV9kYXRhLT5h
ZG1pbl9jb21tYW5kLnJlcXVlc3Rfb2Zmc2V0ICsgMHgxOCwNCj4gKwkJCQkgICAgICBPQ1hMX0xJ
VFRMRV9FTkRJQU4sIGFyZ3MuZGVidWdfcGFyYW1ldGVyXzIpOw0KPiArCWlmIChyYykNCj4gKwkJ
Z290byBvdXQ7DQo+ICsNCj4gKwlmb3IgKGkgPSAweDIwOyBpIDwgMHgzODsgaSArPSAweDA4KQ0K
PiArCQlyYyA9IG9jeGxfZ2xvYmFsX21taW9fd3JpdGU2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+
ICsJCQkJCSAgICAgIHNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLnJlcXVlc3Rfb2Zmc2V0ICsgaSwN
Cj4gKwkJCQkJICAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLCAwKTsNCj4gKwlpZiAocmMpDQo+ICsJ
CWdvdG8gb3V0Ow0KPiArDQo+ICsNCj4gKwkvLyBQb3B1bGF0ZSBhZG1pbiBjb21tYW5kIGJ1ZmZl
cg0KPiArCWlmIChhcmdzLmJ1Zl9zaXplKSB7DQo+ICsJCWZvciAoaSA9IDA7IGkgPCBhcmdzLmJ1
Zl9zaXplOyBpICs9IHNpemVvZih1NjQpKSB7DQo+ICsJCQl1NjQgdmFsOw0KPiArDQo+ICsJCQlp
ZiAoY29weV9mcm9tX3VzZXIoJnZhbCwgJmFyZ3MuYnVmW2ldLCBzaXplb2YodTY0KSkpDQo+ICsJ
CQkJcmV0dXJuIC1FRkFVTFQ7DQo+ICsNCj4gKwkJCXJjID0gb2N4bF9nbG9iYWxfbW1pb193cml0
ZTY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkJCSAgICAgIHNjbV9kYXRhLT5hZG1pbl9j
b21tYW5kLmRhdGFfb2Zmc2V0ICsgaSwNCj4gKwkJCQkJCSAgICAgIE9DWExfSE9TVF9FTkRJQU4s
IHZhbCk7DQo+ICsJCQlpZiAocmMpDQo+ICsJCQkJZ290byBvdXQ7DQo+ICsJCX0NCj4gKwl9DQo+
ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9jb21tYW5kX2V4ZWN1dGUoc2NtX2RhdGEpOw0KPiArCWlm
IChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9jb21tYW5kX2Nv
bXBsZXRlX3RpbWVvdXQoc2NtX2RhdGEsDQo+ICsJCQkJCQlzY21fZGF0YS0+dGltZW91dHNbQURN
SU5fQ09NTUFORF9GV19ERUJVR10pOw0KPiArCWlmIChyYyA8IDApDQo+ICsJCWdvdG8gb3V0Ow0K
PiArDQo+ICsJcmMgPSBzY21fYWRtaW5fcmVzcG9uc2Uoc2NtX2RhdGEpOw0KPiArCWlmIChyYyA8
IDApDQo+ICsJCWdvdG8gb3V0Ow0KPiArCWlmIChyYyAhPSBTVEFUVVNfU1VDQ0VTUykgew0KPiAr
CQlzY21fd2Fybl9zdGF0dXMoc2NtX2RhdGEsICJVbmV4cGVjdGVkIHN0YXR1cyBmcm9tIEZXIERl
YnVnIiwgcmMpOw0KPiArCQlnb3RvIG91dDsNCj4gKwl9DQo+ICsNCj4gKwlpZiAoYXJncy5idWZf
c2l6ZSkgew0KPiArCQlmb3IgKGkgPSAwOyBpIDwgYXJncy5idWZfc2l6ZTsgaSArPSBzaXplb2Yo
dTY0KSkgew0KPiArCQkJdTY0IHZhbDsNCj4gKw0KPiArCQkJcmMgPSBvY3hsX2dsb2JhbF9tbWlv
X3JlYWQ2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+ICsJCQkJCQkgICAgIHNjbV9kYXRhLT5hZG1p
bl9jb21tYW5kLmRhdGFfb2Zmc2V0ICsgaSwNCj4gKwkJCQkJCSAgICAgT0NYTF9IT1NUX0VORElB
TiwgJnZhbCk7DQo+ICsJCQlpZiAocmMpDQo+ICsJCQkJZ290byBvdXQ7DQo+ICsNCj4gKwkJCWlm
IChjb3B5X3RvX3VzZXIoJmFyZ3MuYnVmW2ldLCAmdmFsLCBzaXplb2YodTY0KSkpIHsNCj4gKwkJ
CQlyYyA9IC1FRkFVTFQ7DQo+ICsJCQkJZ290byBvdXQ7DQo+ICsJCQl9DQo+ICsJCX0NCj4gKwl9
DQo+ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9yZXNwb25zZV9oYW5kbGVkKHNjbV9kYXRhKTsNCj4g
KwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICsJcmMgPSBzY21fZGlzYWJsZV9md2Rl
YnVnKHNjbV9kYXRhKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0Ow0KPiArDQo+ICtvdXQ6
DQo+ICsJbXV0ZXhfdW5sb2NrKCZzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5sb2NrKTsNCj4gKwly
ZXR1cm4gcmM7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2lvY3RsX3NodXRkb3duKHN0
cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJaW50IHJjOw0KPiArDQo+ICsJbXV0
ZXhfbG9jaygmc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQubG9jayk7DQo+ICsNCj4gKwlyYyA9IHNj
bV9hZG1pbl9jb21tYW5kX3JlcXVlc3Qoc2NtX2RhdGEsIEFETUlOX0NPTU1BTkRfU0hVVERPV04p
Ow0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9j
b21tYW5kX2V4ZWN1dGUoc2NtX2RhdGEpOw0KPiArCWlmIChyYykNCj4gKwkJZ290byBvdXQ7DQo+
ICsNCj4gKwlyYyA9IHNjbV9hZG1pbl9jb21tYW5kX2NvbXBsZXRlX3RpbWVvdXQoc2NtX2RhdGEs
IEFETUlOX0NPTU1BTkRfU0hVVERPV04pOw0KPiArCWlmIChyYyA8IDApIHsNCj4gKwkJZGV2X3dh
cm4oJnNjbV9kYXRhLT5kZXYsICJTaHV0ZG93biB0aW1lZCBvdXRcbiIpOw0KPiArCQlnb3RvIG91
dDsNCj4gKwl9DQo+ICsNCj4gKwlyYyA9IDA7DQo+ICsJZ290byBvdXQ7DQo+ICsNCj4gK291dDoN
Cj4gKwltdXRleF91bmxvY2soJnNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmxvY2spOw0KPiArCXJl
dHVybiByYzsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBzY21faW9jdGxfbW1pb193cml0ZShz
dHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJCXN0cnVjdCBzY21faW9jdGxfbW1pbyBf
X3VzZXIgKnVhcmcpDQo+ICt7DQo+ICsJc3RydWN0IHNjbV9pb2N0bF9tbWlvIGFyZ3M7DQo+ICsN
Cj4gKwlpZiAoY29weV9mcm9tX3VzZXIoJmFyZ3MsIHVhcmcsIHNpemVvZihhcmdzKSkpDQo+ICsJ
CXJldHVybiAtRUZBVUxUOw0KPiArDQo+ICsJcmV0dXJuIG9jeGxfZ2xvYmFsX21taW9fd3JpdGU2
NChzY21fZGF0YS0+b2N4bF9hZnUsIGFyZ3MuYWRkcmVzcywNCj4gKwkJCQkJT0NYTF9MSVRUTEVf
RU5ESUFOLCBhcmdzLnZhbCk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2lvY3RsX21t
aW9fcmVhZChzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJICAgICAgIHN0cnVjdCBz
Y21faW9jdGxfbW1pbyBfX3VzZXIgKnVhcmcpDQo+ICt7DQo+ICsJc3RydWN0IHNjbV9pb2N0bF9t
bWlvIGFyZ3M7DQo+ICsJaW50IHJjOw0KPiArDQo+ICsJaWYgKGNvcHlfZnJvbV91c2VyKCZhcmdz
LCB1YXJnLCBzaXplb2YoYXJncykpKQ0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4gKw0KPiArCXJj
ID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBhcmdzLmFkZHJl
c3MsDQo+ICsJCQkJICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sICZhcmdzLnZhbCk7DQo+ICsJaWYg
KHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwlpZiAoY29weV90b191c2VyKHVhcmcsICZh
cmdzLCBzaXplb2YoYXJncykpKQ0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4gKw0KPiArCXJldHVy
biAwOw0KPiArfQ0KPiArI2Vsc2UNCj4gK3N0YXRpYyBpbnQgc2NtX2lvY3RsX2Z3ZGVidWcoc3Ry
dWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCSAgICAgc3RydWN0IHNjbV9pb2N0bF9md2Rl
YnVnIF9fdXNlciAqdWFyZykNCj4gK3sNCj4gKwlyZXR1cm4gLUVQRVJNOw0KPiArfQ0KPiArDQo+
ICtzdGF0aWMgaW50IHNjbV9pb2N0bF9zaHV0ZG93bihzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRh
KQ0KPiArew0KPiArCXJldHVybiAtRVBFUk07DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2Nt
X2lvY3RsX21taW9fd3JpdGUoc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCQlzdHJ1
Y3Qgc2NtX2lvY3RsX21taW8gX191c2VyICp1YXJnKQ0KPiArew0KPiArCXJldHVybiAtRVBFUk07
DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2lvY3RsX21taW9fcmVhZChzdHJ1Y3Qgc2Nt
X2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJICAgICAgIHN0cnVjdCBzY21faW9jdGxfbW1pbyBfX3Vz
ZXIgKnVhcmcpDQo+ICt7DQo+ICsJcmV0dXJuIC1FUEVSTTsNCj4gK30NCj4gKyNlbmRpZg0KPiAr
DQo+ICtzdGF0aWMgbG9uZyBzY21fZmlsZV9pb2N0bChzdHJ1Y3QgZmlsZSAqZmlsZSwgdW5zaWdu
ZWQgaW50IGNtZCwNCj4gKwkJCSAgIHVuc2lnbmVkIGxvbmcgYXJncykNCj4gK3sNCj4gKwlzdHJ1
Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhID0gZmlsZS0+cHJpdmF0ZV9kYXRhOw0KPiArCWludCByYyA9
IC1FSU5WQUw7DQo+ICsNCj4gKwlzd2l0Y2ggKGNtZCkgew0KPiArCWNhc2UgU0NNX0lPQ1RMX0JV
RkZFUl9JTkZPOg0KPiArCQlyYyA9IHNjbV9pb2N0bF9idWZmZXJfaW5mbyhzY21fZGF0YSwNCj4g
KwkJCQkJICAgKHN0cnVjdCBzY21faW9jdGxfYnVmZmVyX2luZm8gX191c2VyICopYXJncyk7DQo+
ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBTQ01fSU9DVExfRVJST1JfTE9HOg0KPiArCQlyYyA9
IHNjbV9pb2N0bF9lcnJvcl9sb2coc2NtX2RhdGEsDQo+ICsJCQkJCSAoc3RydWN0IHNjbV9pb2N0
bF9lcnJvcl9sb2cgX191c2VyICopYXJncyk7DQo+ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBT
Q01fSU9DVExfQ09OVFJPTExFUl9EVU1QOg0KPiArCQlyYyA9IHNjbV9yZXF1ZXN0X2NvbnRyb2xs
ZXJfZHVtcChzY21fZGF0YSk7DQo+ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBTQ01fSU9DVExf
Q09OVFJPTExFUl9EVU1QX0RBVEE6DQo+ICsJCXJjID0gc2NtX2lvY3RsX2NvbnRyb2xsZXJfZHVt
cF9kYXRhKHNjbV9kYXRhLA0KPiArCQkJCQkJICAgIChzdHJ1Y3Qgc2NtX2lvY3RsX2NvbnRyb2xs
ZXJfZHVtcF9kYXRhIF9fdXNlciAqKWFyZ3MpOw0KPiArCQlicmVhazsNCj4gKw0KPiArCWNhc2Ug
U0NNX0lPQ1RMX0NPTlRST0xMRVJfRFVNUF9DT01QTEVURToNCj4gKwkJcmMgPSBzY21faW9jdGxf
Y29udHJvbGxlcl9kdW1wX2NvbXBsZXRlKHNjbV9kYXRhKTsNCj4gKwkJYnJlYWs7DQo+ICsNCj4g
KwljYXNlIFNDTV9JT0NUTF9DT05UUk9MTEVSX1NUQVRTOg0KPiArCQlyYyA9IHNjbV9pb2N0bF9j
b250cm9sbGVyX3N0YXRzKHNjbV9kYXRhLA0KPiArCQkJCQkJKHN0cnVjdCBzY21faW9jdGxfY29u
dHJvbGxlcl9zdGF0cyBfX3VzZXIgKilhcmdzKTsNCj4gKwkJYnJlYWs7DQo+ICsNCj4gKwljYXNl
IFNDTV9JT0NUTF9FVkVOVEZEOg0KPiArCQlyYyA9IHNjbV9pb2N0bF9ldmVudGZkKHNjbV9kYXRh
LA0KPiArCQkJCSAgICAgICAoc3RydWN0IHNjbV9pb2N0bF9ldmVudGZkIF9fdXNlciAqKWFyZ3Mp
Ow0KPiArCQlicmVhazsNCj4gKw0KPiArCWNhc2UgU0NNX0lPQ1RMX0VWRU5UX0NIRUNLOg0KPiAr
CQlyYyA9IHNjbV9pb2N0bF9ldmVudF9jaGVjayhzY21fZGF0YSwgKHU2NCBfX3VzZXIgKilhcmdz
KTsNCj4gKwkJYnJlYWs7DQo+ICsNCj4gKwljYXNlIFNDTV9JT0NUTF9SRVFVRVNUX0hFQUxUSDoN
Cj4gKwkJcmMgPSBzY21fcmVxX2NvbnRyb2xsZXJfaGVhbHRoX3BlcmYoc2NtX2RhdGEpOw0KPiAr
CQlicmVhazsNCj4gKw0KPiArCWNhc2UgU0NNX0lPQ1RMX0ZXREVCVUc6DQo+ICsJCXJjID0gc2Nt
X2lvY3RsX2Z3ZGVidWcoc2NtX2RhdGEsDQo+ICsJCQkJICAgICAgIChzdHJ1Y3Qgc2NtX2lvY3Rs
X2Z3ZGVidWcgX191c2VyICopYXJncyk7DQo+ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBTQ01f
SU9DVExfU0hVVERPV046DQo+ICsJCXJjID0gc2NtX2lvY3RsX3NodXRkb3duKHNjbV9kYXRhKTsN
Cj4gKwkJYnJlYWs7DQo+ICsNCj4gKwljYXNlIFNDTV9JT0NUTF9NTUlPX1dSSVRFOg0KPiArCQly
YyA9IHNjbV9pb2N0bF9tbWlvX3dyaXRlKHNjbV9kYXRhLA0KPiArCQkJCQkgIChzdHJ1Y3Qgc2Nt
X2lvY3RsX21taW8gX191c2VyICopYXJncyk7DQo+ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBT
Q01fSU9DVExfTU1JT19SRUFEOg0KPiArCQlyYyA9IHNjbV9pb2N0bF9tbWlvX3JlYWQoc2NtX2Rh
dGEsDQo+ICsJCQkJCSAoc3RydWN0IHNjbV9pb2N0bF9tbWlvIF9fdXNlciAqKWFyZ3MpOw0KPiAr
CQlicmVhazsNCj4gKw0KPiArCX0NCj4gKw0KPiArCXJldHVybiByYzsNCj4gK30NCj4gKw0KPiAr
c3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgc2NtX2ZvcHMgPSB7DQo+ICsJLm93
bmVyCQk9IFRISVNfTU9EVUxFLA0KPiArCS5vcGVuCSAgID0gc2NtX2ZpbGVfb3BlbiwNCj4gKwku
cmVsZWFzZQk9IHNjbV9maWxlX3JlbGVhc2UsDQo+ICsJLnVubG9ja2VkX2lvY3RsID0gc2NtX2Zp
bGVfaW9jdGwsDQo+ICsJLmNvbXBhdF9pb2N0bCAgID0gc2NtX2ZpbGVfaW9jdGwsDQo+ICt9Ow0K
PiArDQo+ICsvKioNCj4gKyAqIHNjbV9jcmVhdGVfY2RldigpIC0gQ3JlYXRlIHRoZSBjaGFyZGV2
IGluIC9kZXYgZm9yIHRoaXMgc2NtIGRldmljZQ0KPiArICogQHNjbV9kYXRhOiB0aGUgU0NNIG1l
dGFkYXRhDQo+ICsgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgbmVnYXRpdmUgb24gZmFpbHVyZQ0K
PiArICovDQo+ICtzdGF0aWMgaW50IHNjbV9jcmVhdGVfY2RldihzdHJ1Y3Qgc2NtX2RhdGEgKnNj
bV9kYXRhKQ0KPiArew0KPiArCWludCByYzsNCj4gKw0KPiArCWNkZXZfaW5pdCgmc2NtX2RhdGEt
PmNkZXYsICZzY21fZm9wcyk7DQo+ICsJcmMgPSBjZGV2X2FkZCgmc2NtX2RhdGEtPmNkZXYsIHNj
bV9kYXRhLT5kZXYuZGV2dCwgMSk7DQo+ICsJaWYgKHJjKSB7DQo+ICsJCWRldl9lcnIoJnNjbV9k
YXRhLT5kZXYsICJVbmFibGUgdG8gYWRkIGFmdSBjaGFyIGRldmljZTogJWRcbiIsIHJjKTsNCj4g
KwkJcmV0dXJuIHJjOw0KPiArCX0NCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArLyoqDQo+
ICsgKiBzY21fcmVtb3ZlKCkgLSBGcmVlIGFuIE9wZW5DQVBJIFN0b3JhZ2UgQ2xhc3MgTWVtb3J5
IGRldmljZQ0KPiArICogQHBkZXY6IHRoZSBQQ0kgZGV2aWNlIGluZm9ybWF0aW9uIHN0cnVjdA0K
PiArICovDQo+ICtzdGF0aWMgdm9pZCBzY21fcmVtb3ZlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQ0K
PiArew0KPiArCWlmIChQQ0lfRlVOQyhwZGV2LT5kZXZmbikgPT0gMCkgew0KPiArCQlzdHJ1Y3Qg
c2NtX2Z1bmN0aW9uXzAgKnNjbV9mdW5jXzAgPSBwY2lfZ2V0X2RydmRhdGEocGRldik7DQo+ICsN
Cj4gKwkJaWYgKHNjbV9mdW5jXzApIHsNCj4gKwkJCW9jeGxfZnVuY3Rpb25fY2xvc2Uoc2NtX2Z1
bmNfMC0+b2N4bF9mbik7DQo+ICsJCQlzY21fZnVuY18wLT5vY3hsX2ZuID0gTlVMTDsNCj4gKwkJ
fQ0KPiArCX0gZWxzZSB7DQo+ICsJCXN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEgPSBwY2lfZ2V0
X2RydmRhdGEocGRldik7DQo+ICsNCj4gKwkJaWYgKHNjbV9kYXRhKSB7DQo+ICsJCQlpZiAoc2Nt
X2RhdGEtPm52ZGltbV9idXMpDQo+ICsJCQkJbnZkaW1tX2J1c191bnJlZ2lzdGVyKHNjbV9kYXRh
LT5udmRpbW1fYnVzKTsNCj4gKw0KPiArCQkJZGV2aWNlX3VucmVnaXN0ZXIoJnNjbV9kYXRhLT5k
ZXYpOw0KPiArCQl9DQo+ICsJfQ0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHNjbV9zZXR1cF9k
ZXZpY2VfbWV0YWRhdGEoKSAtIFJldHJpZXZlIGNvbmZpZyBpbmZvcm1hdGlvbiBmcm9tIHRoZSBB
RlUgYW5kIHNhdmUgaXQgZm9yIGZ1dHVyZSB1c2UNCj4gKyAqIEBzY21fZGF0YTogdGhlIFNDTSBt
ZXRhZGF0YQ0KPiArICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIG9uIGZhaWx1cmUN
Cj4gKyAqLw0KPiArc3RhdGljIGludCBzY21fc2V0dXBfZGV2aWNlX21ldGFkYXRhKHN0cnVjdCBz
Y21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJdTY0IHZhbDsNCj4gKwlpbnQgcmM7DQo+ICsJ
aW50IGk7DQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5v
Y3hsX2FmdSwgR0xPQkFMX01NSU9fQ0NBUDAsDQo+ICsJCQkJICAgICBPQ1hMX0xJVFRMRV9FTkRJ
QU4sICZ2YWwpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJuIHJjOw0KPiArDQo+ICsJc2NtX2Rh
dGEtPnNjbV9yZXZpc2lvbiA9IHZhbCAmIDB4RkZGRjsNCj4gKwlzY21fZGF0YS0+cmVhZF9sYXRl
bmN5ID0gKHZhbCA+PiAzMikgJiAweEZGOw0KPiArCXNjbV9kYXRhLT5yZWFkaW5lc3NfdGltZW91
dCA9IHZhbCA+PiA0ODsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2Nt
X2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1JT19DQ0FQMSwNCj4gKwkJCQkgICAgIE9DWExfTElU
VExFX0VORElBTiwgJnZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4g
KwlzY21fZGF0YS0+bWF4X2NvbnRyb2xsZXJfZHVtcF9zaXplID0gdmFsICYgMHhGRkZGRkZGRjsN
Cj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb19yZWFkNjQoc2NtX2RhdGEtPm9jeGxfYWZ1
LCBHTE9CQUxfTU1JT19GV1ZFUiwNCj4gKwkJCQkgICAgIE9DWExfTElUVExFX0VORElBTiwgJnZh
bCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwlmb3IgKGkgPSAwOyBp
IDwgODsgaSsrKQ0KPiArCQlzY21fZGF0YS0+ZndfdmVyc2lvbltpXSA9ICh2YWwgPj4gKGkgKiA4
KSkgJiAweGZmOw0KPiArDQo+ICsJc2NtX2RhdGEtPmZ3X3ZlcnNpb25bOF0gPSAnXDAnOw0KPiAr
DQo+ICsJZGV2X2luZm8oJnNjbV9kYXRhLT5kZXYsDQo+ICsJCSAiRmlybXdhcmUgdmVyc2lvbiAn
JXMnIFNDTSByZXZpc2lvbiAlZDolZFxuIiwgc2NtX2RhdGEtPmZ3X3ZlcnNpb24sDQo+ICsJCSBz
Y21fZGF0YS0+c2NtX3JldmlzaW9uID4+IDQsIHNjbV9kYXRhLT5zY21fcmV2aXNpb24gJiAweDBG
KTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgY29uc3QgY2hhciAq
c2NtX2RlY29kZV9lcnJvcl9sb2dfdHlwZSh1OCBlcnJvcl9sb2dfdHlwZSkNCj4gK3sNCj4gKwlz
d2l0Y2ggKGVycm9yX2xvZ190eXBlKSB7DQo+ICsJY2FzZSAweDAwOg0KPiArCQlyZXR1cm4gImdl
bmVyYWwiOw0KPiArCWNhc2UgMHgwMToNCj4gKwkJcmV0dXJuICJwcmVkaWN0aXZlIGZhaWx1cmUi
Ow0KPiArCWNhc2UgMHgwMjoNCj4gKwkJcmV0dXJuICJ0aGVybWFsIHdhcm5pbmciOw0KPiArCWNh
c2UgMHgwMzoNCj4gKwkJcmV0dXJuICJkYXRhIGxvc3MiOw0KPiArCWNhc2UgMHgwNDoNCj4gKwkJ
cmV0dXJuICJoZWFsdGggJiBwZXJmb3JtYW5jZSI7DQo+ICsJZGVmYXVsdDoNCj4gKwkJcmV0dXJu
ICJ1bmtub3duIjsNCj4gKwl9DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHNjbV9kdW1wX2Vy
cm9yX2xvZyhzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCXN0cnVjdCBzY21f
aW9jdGxfZXJyb3JfbG9nIGxvZzsNCj4gKwl1MzIgYnVmX3NpemU7DQo+ICsJdTggKmJ1ZjsNCj4g
KwlpbnQgcmM7DQo+ICsNCj4gKwlpZiAoc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQuZGF0YV9zaXpl
ID09IDApDQo+ICsJCXJldHVybjsNCj4gKw0KPiArCWJ1Zl9zaXplID0gc2NtX2RhdGEtPmFkbWlu
X2NvbW1hbmQuZGF0YV9zaXplIC0gMHg0ODsNCj4gKwlidWYgPSBremFsbG9jKGJ1Zl9zaXplLCBH
RlBfS0VSTkVMKTsNCj4gKwlpZiAoIWJ1ZikNCj4gKwkJcmV0dXJuOw0KPiArDQo+ICsJbG9nLmJ1
ZiA9IGJ1ZjsNCj4gKwlsb2cuYnVmX3NpemUgPSBidWZfc2l6ZTsNCj4gKw0KPiArCXJjID0gc2Nt
X3JlYWRfZXJyb3JfbG9nKHNjbV9kYXRhLCAmbG9nLCBmYWxzZSk7DQo+ICsJaWYgKHJjIDwgMCkN
Cj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKwlkZXZfd2Fybigmc2NtX2RhdGEtPmRldiwNCj4gKwkJ
ICJTQ00gRXJyb3IgbG9nOiBXV0lEPTB4JTAxNmxseCUwMTZsbHggTElEPTB4JXggUFJDPSV4IHR5
cGU9MHgleCAlcywgVXB0aW1lPSV1IHNlY29uZHMgdGltZXN0YW1wPTB4JWxseFxuIiwNCj4gKwkJ
IGxvZy53d2lkWzBdLCBsb2cud3dpZFsxXSwNCj4gKwkJIGxvZy5sb2dfaWRlbnRpZmllciwgbG9n
LnByb2dyYW1fcmVmZXJlbmNlX2NvZGUsDQo+ICsJCSBsb2cuZXJyb3JfbG9nX3R5cGUsDQo+ICsJ
CSBzY21fZGVjb2RlX2Vycm9yX2xvZ190eXBlKGxvZy5lcnJvcl9sb2dfdHlwZSksDQo+ICsJCSBs
b2cucG93ZXJfb25fc2Vjb25kcywgbG9nLnRpbWVzdGFtcCk7DQo+ICsJcHJpbnRfaGV4X2R1bXAo
S0VSTl9XQVJOSU5HLCAiYnVmIiwgRFVNUF9QUkVGSVhfT0ZGU0VULCAxNiwgMSwgYnVmLA0KPiAr
CQkgICAgICAgbG9nLmJ1Zl9zaXplLCBmYWxzZSk7DQo+ICsNCj4gK291dDoNCj4gKwlrZnJlZShi
dWYpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBzY21faGFuZGxlX25zY3JhX2Rvb3JiZWxs
KHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJaW50IHJjOw0KPiArDQo+ICsJ
aWYgKHNjbV9kYXRhLT5uc19jb21tYW5kLm9wX2NvZGUgPT0gTlNfQ09NTUFORF9TRUNVUkVfRVJB
U0UpIHsNCj4gKwkJdTY0IHN1Y2Nlc3MsIGF0dGVtcHRlZDsNCj4gKw0KPiArDQo+ICsJCXJjID0g
c2NtX25zX3Jlc3BvbnNlKHNjbV9kYXRhKTsNCj4gKwkJaWYgKHJjIDwgMCkgew0KPiArCQkJc2Nt
X2RhdGEtPm92ZXJ3cml0ZV9zdGF0ZSA9IFNDTV9PVkVSV1JJVEVfRkFJTEVEOw0KPiArCQkJbXV0
ZXhfdW5sb2NrKCZzY21fZGF0YS0+bnNfY29tbWFuZC5sb2NrKTsNCj4gKwkJCXJldHVybjsNCj4g
KwkJfQ0KPiArCQlpZiAocmMgIT0gU1RBVFVTX1NVQ0NFU1MpDQo+ICsJCQlzY21fd2Fybl9zdGF0
dXMoc2NtX2RhdGEsICJVbmV4cGVjdGVkIHN0YXR1cyBmcm9tIG92ZXJ3cml0ZSIsIHJjKTsNCj4g
Kw0KPiArCQlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwN
Cj4gKwkJCQkJICAgICBzY21fZGF0YS0+bnNfY29tbWFuZC5yZXNwb25zZV9vZmZzZXQgKw0KPiAr
CQkJCQkgICAgIE5TX1JFU1BPTlNFX1NFQ1VSRV9FUkFTRV9BQ0NFU1NJQkxFX1NVQ0NFU1MsDQo+
ICsJCQkJCSAgICAgT0NYTF9IT1NUX0VORElBTiwgJnN1Y2Nlc3MpOw0KPiArCQlpZiAocmMpIHsN
Cj4gKwkJCXNjbV9kYXRhLT5vdmVyd3JpdGVfc3RhdGUgPSBTQ01fT1ZFUldSSVRFX0ZBSUxFRDsN
Cj4gKwkJCW11dGV4X3VubG9jaygmc2NtX2RhdGEtPm5zX2NvbW1hbmQubG9jayk7DQo+ICsJCQly
ZXR1cm47DQo+ICsJCX0NCj4gKw0KPiArCQlyYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNj
bV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkJICAgICBzY21fZGF0YS0+bnNfY29tbWFuZC5yZXNw
b25zZV9vZmZzZXQgKw0KPiArCQkJCQkgICAgIE5TX1JFU1BPTlNFX1NFQ1VSRV9FUkFTRV9BQ0NF
U1NJQkxFX0FUVEVNUFRFRCwNCj4gKwkJCQkJICAgICBPQ1hMX0hPU1RfRU5ESUFOLCAmYXR0ZW1w
dGVkKTsNCj4gKwkJaWYgKHJjKSB7DQo+ICsJCQlzY21fZGF0YS0+b3ZlcndyaXRlX3N0YXRlID0g
U0NNX09WRVJXUklURV9GQUlMRUQ7DQo+ICsJCQltdXRleF91bmxvY2soJnNjbV9kYXRhLT5uc19j
b21tYW5kLmxvY2spOw0KPiArCQkJcmV0dXJuOw0KPiArCQl9DQo+ICsNCj4gKwkJc2NtX2RhdGEt
Pm92ZXJ3cml0ZV9zdGF0ZSA9IFNDTV9PVkVSV1JJVEVfU1VDQ0VTUzsNCj4gKwkJaWYgKHN1Y2Nl
c3MgIT0gYXR0ZW1wdGVkKQ0KPiArCQkJc2NtX2RhdGEtPm92ZXJ3cml0ZV9zdGF0ZSA9IFNDTV9P
VkVSV1JJVEVfRkFJTEVEOw0KPiArDQo+ICsJCWRldl9pbmZvKCZzY21fZGF0YS0+ZGV2LA0KPiAr
CQkJICJPdmVyd3JpdHRlbiAlbGx1LyVsbHUgYWNjZXNzaWJsZSBwYWdlcyIsIHN1Y2Nlc3MsIGF0
dGVtcHRlZCk7DQo+ICsNCj4gKwkJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChzY21fZGF0
YS0+b2N4bF9hZnUsDQo+ICsJCQkJCSAgICAgc2NtX2RhdGEtPm5zX2NvbW1hbmQucmVzcG9uc2Vf
b2Zmc2V0ICsNCj4gKwkJCQkJICAgICBOU19SRVNQT05TRV9TRUNVUkVfRVJBU0VfREVGRUNUSVZF
X1NVQ0NFU1MsDQo+ICsJCQkJCSAgICAgT0NYTF9IT1NUX0VORElBTiwgJnN1Y2Nlc3MpOw0KPiAr
CQlpZiAocmMpIHsNCj4gKwkJCXNjbV9kYXRhLT5vdmVyd3JpdGVfc3RhdGUgPSBTQ01fT1ZFUldS
SVRFX0ZBSUxFRDsNCj4gKwkJCW11dGV4X3VubG9jaygmc2NtX2RhdGEtPm5zX2NvbW1hbmQubG9j
ayk7DQo+ICsJCQlyZXR1cm47DQo+ICsJCX0NCj4gKw0KPiArCQlyYyA9IG9jeGxfZ2xvYmFsX21t
aW9fcmVhZDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkJICAgICBzY21fZGF0YS0+bnNf
Y29tbWFuZC5yZXNwb25zZV9vZmZzZXQgKw0KPiArCQkJCQkgICAgIE5TX1JFU1BPTlNFX1NFQ1VS
RV9FUkFTRV9ERUZFQ1RJVkVfQVRURU1QVEVELA0KPiArCQkJCQkgICAgIE9DWExfSE9TVF9FTkRJ
QU4sICZhdHRlbXB0ZWQpOw0KPiArCQlpZiAocmMpIHsNCj4gKwkJCXNjbV9kYXRhLT5vdmVyd3Jp
dGVfc3RhdGUgPSBTQ01fT1ZFUldSSVRFX0ZBSUxFRDsNCj4gKwkJCW11dGV4X3VubG9jaygmc2Nt
X2RhdGEtPm5zX2NvbW1hbmQubG9jayk7DQo+ICsJCQlyZXR1cm47DQo+ICsJCX0NCj4gKw0KPiAr
CQlpZiAoc3VjY2VzcyAhPSBhdHRlbXB0ZWQpDQo+ICsJCQlzY21fZGF0YS0+b3ZlcndyaXRlX3N0
YXRlID0gU0NNX09WRVJXUklURV9GQUlMRUQ7DQo+ICsNCj4gKwkJZGV2X2luZm8oJnNjbV9kYXRh
LT5kZXYsDQo+ICsJCQkgIk92ZXJ3cml0dGVuICVsbHUvJWxsdSBkZWZlY3RpdmUgcGFnZXMiLCBz
dWNjZXNzLCBhdHRlbXB0ZWQpOw0KPiArDQo+ICsJCXNjbV9uc19yZXNwb25zZV9oYW5kbGVkKHNj
bV9kYXRhKTsNCj4gKw0KPiArCQltdXRleF91bmxvY2soJnNjbV9kYXRhLT5uc19jb21tYW5kLmxv
Y2spOw0KPiArCQlyZXR1cm47DQo+ICsJfQ0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaXJxcmV0dXJu
X3Qgc2NtX2ltbjBfaGFuZGxlcih2b2lkICpwcml2YXRlKQ0KPiArew0KPiArCXN0cnVjdCBzY21f
ZGF0YSAqc2NtX2RhdGEgPSBwcml2YXRlOw0KPiArCWludCByYzsNCj4gKwl1NjQgY2hpID0gMDsN
Cj4gKw0KPiArCXJjID0gc2NtX2NoaShzY21fZGF0YSwgJmNoaSk7DQo+ICsJaWYgKHJjIDwgMCkN
Cj4gKwkJcmV0dXJuIElSUV9OT05FOw0KPiArDQo+ICsJaWYgKGNoaSAmIEdMT0JBTF9NTUlPX0NI
SV9OU0NSQSkNCj4gKwkJc2NtX2hhbmRsZV9uc2NyYV9kb29yYmVsbChzY21fZGF0YSk7DQo+ICsN
Cj4gKwlpZiAoY2hpICYgR0xPQkFMX01NSU9fQ0hJX0VMQSkgew0KPiArCQlkZXZfd2Fybigmc2Nt
X2RhdGEtPmRldiwgIkVycm9yIGxvZyBpcyBhdmFpbGFibGVcbiIpOw0KPiArDQo+ICsJCWlmIChz
Y21fZGF0YS0+ZXZfY3R4KQ0KPiArCQkJZXZlbnRmZF9zaWduYWwoc2NtX2RhdGEtPmV2X2N0eCwg
MSk7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGNoaSAmIEdMT0JBTF9NTUlPX0NISV9DREEpIHsNCj4g
KwkJZGV2X3dhcm4oJnNjbV9kYXRhLT5kZXYsICJDb250cm9sbGVyIGR1bXAgaXMgYXZhaWxhYmxl
XG4iKTsNCj4gKw0KPiArCQlpZiAoc2NtX2RhdGEtPmV2X2N0eCkNCj4gKwkJCWV2ZW50ZmRfc2ln
bmFsKHNjbV9kYXRhLT5ldl9jdHgsIDEpOw0KPiArCX0NCj4gKw0KPiArDQo+ICsJcmV0dXJuIElS
UV9IQU5ETEVEOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaXJxcmV0dXJuX3Qgc2NtX2ltbjFfaGFu
ZGxlcih2b2lkICpwcml2YXRlKQ0KPiArew0KPiArCXN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEg
PSBwcml2YXRlOw0KPiArCXU2NCBjaGkgPSAwOw0KPiArDQo+ICsJKHZvaWQpc2NtX2NoaShzY21f
ZGF0YSwgJmNoaSk7DQo+ICsNCj4gKwlpZiAoY2hpICYgKEdMT0JBTF9NTUlPX0NISV9DRkZTIHwg
R0xPQkFMX01NSU9fQ0hJX0NIRlMpKSB7DQo+ICsJCWRldl9lcnIoJnNjbV9kYXRhLT5kZXYsDQo+
ICsJCQkiQ29udHJvbGxlciBzdGF0dXMgaXMgZmF0YWwsIGNoaT0weCVsbHgsIGdvaW5nIG9mZmxp
bmVcbiIsIGNoaSk7DQo+ICsNCj4gKwkJaWYgKHNjbV9kYXRhLT5udmRpbW1fYnVzKSB7DQo+ICsJ
CQludmRpbW1fYnVzX3VucmVnaXN0ZXIoc2NtX2RhdGEtPm52ZGltbV9idXMpOw0KPiArCQkJc2Nt
X2RhdGEtPm52ZGltbV9idXMgPSBOVUxMOw0KPiArCQl9DQo+ICsNCj4gKwkJaWYgKHNjbV9kYXRh
LT5ldl9jdHgpDQo+ICsJCQlldmVudGZkX3NpZ25hbChzY21fZGF0YS0+ZXZfY3R4LCAxKTsNCj4g
Kwl9DQo+ICsNCj4gKwlyZXR1cm4gSVJRX0hBTkRMRUQ7DQo+ICt9DQo+ICsNCj4gKw0KPiArLyoq
DQo+ICsgKiBzY21fc2V0dXBfaXJxKCkgLSBTZXQgdXAgdGhlIElSUXMgZm9yIHRoZSBTQ00gZGV2
aWNlDQo+ICsgKiBAc2NtX2RhdGE6IHRoZSBTQ00gbWV0YWRhdGENCj4gKyAqIFJldHVybjogMCBv
biBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBmYWlsdXJlDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgc2Nt
X3NldHVwX2lycShzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCWludCByYzsN
Cj4gKwl1NjQgaXJxX2FkZHI7DQo+ICsNCj4gKwlyYyA9IG9jeGxfYWZ1X2lycV9hbGxvYyhzY21f
ZGF0YS0+b2N4bF9jb250ZXh0LCAmc2NtX2RhdGEtPmlycV9pZFswXSk7DQo+ICsJaWYgKHJjKQ0K
PiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwlyYyA9IG9jeGxfaXJxX3NldF9oYW5kbGVyKHNjbV9k
YXRhLT5vY3hsX2NvbnRleHQsIHNjbV9kYXRhLT5pcnFfaWRbMF0sDQo+ICsJCQkJICBzY21faW1u
MF9oYW5kbGVyLCBOVUxMLCBzY21fZGF0YSk7DQo+ICsNCj4gKwlpcnFfYWRkciA9IG9jeGxfYWZ1
X2lycV9nZXRfYWRkcihzY21fZGF0YS0+b2N4bF9jb250ZXh0LCBzY21fZGF0YS0+aXJxX2lkWzBd
KTsNCj4gKwlpZiAoIWlycV9hZGRyKQ0KPiArCQlyZXR1cm4gLUVGQVVMVDsNCj4gKw0KPiArCXNj
bV9kYXRhLT5pcnFfYWRkclswXSA9IGlvcmVtYXAoaXJxX2FkZHIsIFBBR0VfU0laRSk7DQo+ICsJ
aWYgKCFzY21fZGF0YS0+aXJxX2FkZHJbMF0pDQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+
ICsJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3dyaXRlNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9C
QUxfTU1JT19JTUEwX09IUCwNCj4gKwkJCQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sDQo+ICsJ
CQkJICAgICAgKHU2NClzY21fZGF0YS0+aXJxX2FkZHJbMF0pOw0KPiArCWlmIChyYykNCj4gKwkJ
Z290byBvdXRfaXJxMDsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1pb193cml0ZTY0KHNj
bV9kYXRhLT5vY3hsX2FmdSwgR0xPQkFMX01NSU9fSU1BMF9DRlAsDQo+ICsJCQkJICAgICAgT0NY
TF9MSVRUTEVfRU5ESUFOLCAwKTsNCj4gKwlpZiAocmMpDQo+ICsJCWdvdG8gb3V0X2lycTA7DQo+
ICsNCj4gKwlyYyA9IG9jeGxfYWZ1X2lycV9hbGxvYyhzY21fZGF0YS0+b2N4bF9jb250ZXh0LCAm
c2NtX2RhdGEtPmlycV9pZFsxXSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dF9pcnEwOw0K
PiArDQo+ICsNCj4gKwlyYyA9IG9jeGxfaXJxX3NldF9oYW5kbGVyKHNjbV9kYXRhLT5vY3hsX2Nv
bnRleHQsIHNjbV9kYXRhLT5pcnFfaWRbMV0sDQo+ICsJCQkJICBzY21faW1uMV9oYW5kbGVyLCBO
VUxMLCBzY21fZGF0YSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dF9pcnEwOw0KPiArDQo+
ICsJaXJxX2FkZHIgPSBvY3hsX2FmdV9pcnFfZ2V0X2FkZHIoc2NtX2RhdGEtPm9jeGxfY29udGV4
dCwgc2NtX2RhdGEtPmlycV9pZFsxXSk7DQo+ICsJaWYgKCFpcnFfYWRkcikNCj4gKwkJZ290byBv
dXRfaXJxMDsNCj4gKw0KPiArCXNjbV9kYXRhLT5pcnFfYWRkclsxXSA9IGlvcmVtYXAoaXJxX2Fk
ZHIsIFBBR0VfU0laRSk7DQo+ICsJaWYgKCFzY21fZGF0YS0+aXJxX2FkZHJbMV0pDQo+ICsJCWdv
dG8gb3V0X2lycTA7DQo+ICsNCj4gKwlyYyA9IG9jeGxfZ2xvYmFsX21taW9fd3JpdGU2NChzY21f
ZGF0YS0+b2N4bF9hZnUsIEdMT0JBTF9NTUlPX0lNQTFfT0hQLA0KPiArCQkJCSAgICAgIE9DWExf
TElUVExFX0VORElBTiwNCj4gKwkJCQkgICAgICAodTY0KXNjbV9kYXRhLT5pcnFfYWRkclsxXSk7
DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dF9pcnExOw0KPiArDQo+ICsJcmMgPSBvY3hsX2ds
b2JhbF9tbWlvX3dyaXRlNjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1JT19JTUExX0NG
UCwNCj4gKwkJCQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sIDApOw0KPiArCWlmIChyYykNCj4g
KwkJZ290byBvdXRfaXJxMTsNCj4gKw0KPiArCS8vIEVuYWJsZSBkb29yYmVsbHMNCj4gKwlyYyA9
IG9jeGxfZ2xvYmFsX21taW9fc2V0NjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxfTU1JT19D
SElFLA0KPiArCQkJCSAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sDQo+ICsJCQkJICAgIEdMT0JBTF9N
TUlPX0NISV9FTEEgfCBHTE9CQUxfTU1JT19DSElfQ0RBIHwNCj4gKwkJCQkgICAgR0xPQkFMX01N
SU9fQ0hJX0NGRlMgfCBHTE9CQUxfTU1JT19DSElfQ0hGUyB8DQo+ICsJCQkJICAgIEdMT0JBTF9N
TUlPX0NISV9OU0NSQSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlnb3RvIG91dF9pcnExOw0KPiArDQo+
ICsJcmV0dXJuIDA7DQo+ICsNCj4gK291dF9pcnExOg0KPiArCWlvdW5tYXAoc2NtX2RhdGEtPmly
cV9hZGRyWzFdKTsNCj4gKwlzY21fZGF0YS0+aXJxX2FkZHJbMV0gPSBOVUxMOw0KPiArDQo+ICtv
dXRfaXJxMDoNCj4gKwlpb3VubWFwKHNjbV9kYXRhLT5pcnFfYWRkclswXSk7DQo+ICsJc2NtX2Rh
dGEtPmlycV9hZGRyWzBdID0gTlVMTDsNCj4gKw0KPiArCXJldHVybiByYzsNCj4gK30NCj4gKw0K
PiArLyoqDQo+ICsgKiBzY21fcHJvYmVfZnVuY3Rpb25fMCAtIFNldCB1cCBmdW5jdGlvbiAwIGZv
ciBhbiBPcGVuQ0FQSSBTdG9yYWdlIENsYXNzIE1lbW9yeSBkZXZpY2UNCj4gKyAqIFRoaXMgaXMg
aW1wb3J0YW50IGFzIGl0IGVuYWJsZXMgaGlnaGVyIHRoYW4gMCBhY3Jvc3MgYWxsIG90aGVyIGZ1
bmN0aW9ucywNCj4gKyAqIHdoaWNoIGluIHR1cm4gZW5hYmxlcyBoaWdoZXIgYmFuZHdpZHRoIGFj
Y2Vzc2VzDQo+ICsgKiBAcGRldjogdGhlIFBDSSBkZXZpY2UgaW5mb3JtYXRpb24gc3RydWN0DQo+
ICsgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgbmVnYXRpdmUgb24gZmFpbHVyZQ0KPiArICovDQo+
ICtzdGF0aWMgaW50IHNjbV9wcm9iZV9mdW5jdGlvbl8wKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQ0K
PiArew0KPiArCXN0cnVjdCBzY21fZnVuY3Rpb25fMCAqc2NtX2Z1bmNfMCA9IE5VTEw7DQo+ICsN
Cj4gKwlzY21fZnVuY18wID0ga3phbGxvYyhzaXplb2YoKnNjbV9mdW5jXzApLCBHRlBfS0VSTkVM
KTsNCj4gKwlpZiAoIXNjbV9mdW5jXzApDQo+ICsJCXJldHVybiAtRU5PTUVNOw0KPiArDQo+ICsJ
c2NtX2Z1bmNfMC0+cGRldiA9IHBkZXY7DQo+ICsJc2NtX2Z1bmNfMC0+b2N4bF9mbiA9IG9jeGxf
ZnVuY3Rpb25fb3BlbihwZGV2KTsNCj4gKwlpZiAoSVNfRVJSKHNjbV9mdW5jXzAtPm9jeGxfZm4p
KSB7DQo+ICsJCWtmcmVlKHNjbV9mdW5jXzApOw0KPiArCQlkZXZfZXJyKCZwZGV2LT5kZXYsICJm
YWlsZWQgdG8gb3BlbiBPQ1hMIGZ1bmN0aW9uXG4iKTsNCj4gKwkJcmV0dXJuIC1FRkFVTFQ7DQo+
ICsJfQ0KPiArDQo+ICsJcGNpX3NldF9kcnZkYXRhKHBkZXYsIHNjbV9mdW5jXzApOw0KPiArDQo+
ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogc2NtX3Byb2JlIC0gSW5pdCBh
biBPcGVuQ0FQSSBTdG9yYWdlIENsYXNzIE1lbW9yeSBkZXZpY2UNCj4gKyAqIEBwZGV2OiB0aGUg
UENJIGRldmljZSBpbmZvcm1hdGlvbiBzdHJ1Y3QNCj4gKyAqIEBlbnQ6IFRoZSBlbnRyeSBmcm9t
IHNjbV9wY2lfdGJsDQo+ICsgKiBSZXR1cm46IDAgb24gc3VjY2VzcywgbmVnYXRpdmUgb24gZmFp
bHVyZQ0KPiArICovDQo+ICtzdGF0aWMgaW50IHNjbV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRl
diwgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgKmVudCkNCj4gK3sNCj4gKwlzdHJ1Y3Qgc2Nt
X2RhdGEgKnNjbV9kYXRhID0gTlVMTDsNCj4gKwlpbnQgZWxhcHNlZDsNCj4gKwl1NjQgY2hpOw0K
PiArDQo+ICsJaWYgKFBDSV9GVU5DKHBkZXYtPmRldmZuKSA9PSAwKQ0KPiArCQlyZXR1cm4gc2Nt
X3Byb2JlX2Z1bmN0aW9uXzAocGRldik7DQo+ICsJZWxzZSBpZiAoUENJX0ZVTkMocGRldi0+ZGV2
Zm4pICE9IDEpDQo+ICsJCXJldHVybiAwOw0KPiArDQo+ICsJc2NtX2RhdGEgPSBremFsbG9jKHNp
emVvZigqc2NtX2RhdGEpLCBHRlBfS0VSTkVMKTsNCj4gKwlpZiAoIXNjbV9kYXRhKQ0KPiArCQln
b3RvIGVycjsNCj4gKwlzY21fZGF0YS0+cGRldiA9IHBkZXY7DQo+ICsJbXV0ZXhfaW5pdCgmc2Nt
X2RhdGEtPmFkbWluX2NvbW1hbmQubG9jayk7DQo+ICsJbXV0ZXhfaW5pdCgmc2NtX2RhdGEtPm5z
X2NvbW1hbmQubG9jayk7DQo+ICsNCj4gKw0KPiArCXNjbV9kYXRhLT50aW1lb3V0c1tBRE1JTl9D
T01NQU5EX0VSUkxPR10gPSAyMDAwOyAvLyBtcw0KPiArCXNjbV9kYXRhLT50aW1lb3V0c1tBRE1J
Tl9DT01NQU5EX0hFQVJUQkVBVF0gPSAxMDA7IC8vIG1zDQo+ICsJc2NtX2RhdGEtPnRpbWVvdXRz
W0FETUlOX0NPTU1BTkRfU01BUlRdID0gMTAwOyAvLyBtcw0KPiArCXNjbV9kYXRhLT50aW1lb3V0
c1tBRE1JTl9DT01NQU5EX0NPTlRST0xMRVJfRFVNUF0gPSAxMDAwOyAvLyBtcw0KPiArCXNjbV9k
YXRhLT50aW1lb3V0c1tBRE1JTl9DT01NQU5EX0NPTlRST0xMRVJfU1RBVFNdID0gMTAwOyAvLyBt
cw0KPiArCXNjbV9kYXRhLT50aW1lb3V0c1tBRE1JTl9DT01NQU5EX1NIVVRET1dOXSA9IDEwMDA7
IC8vIG1zDQo+ICsJc2NtX2RhdGEtPnRpbWVvdXRzW0FETUlOX0NPTU1BTkRfRldfVVBEQVRFXSA9
IDE2MDAwOyAvLyBtcw0KPiArDQo+ICsJcGNpX3NldF9kcnZkYXRhKHBkZXYsIHNjbV9kYXRhKTsN
Cj4gKw0KPiArCXNjbV9kYXRhLT5vY3hsX2ZuID0gb2N4bF9mdW5jdGlvbl9vcGVuKHBkZXYpOw0K
PiArCWlmIChJU19FUlIoc2NtX2RhdGEtPm9jeGxfZm4pKSB7DQo+ICsJCWtmcmVlKHNjbV9kYXRh
KTsNCj4gKwkJc2NtX2RhdGEgPSBOVUxMOw0KPiArCQlwY2lfc2V0X2RydmRhdGEocGRldiwgTlVM
TCk7DQo+ICsJCWRldl9lcnIoJnBkZXYtPmRldiwgImZhaWxlZCB0byBvcGVuIE9DWEwgZnVuY3Rp
b25cbiIpOw0KPiArCQlnb3RvIGVycjsNCj4gKwl9DQo+ICsNCj4gKwlzY21fZGF0YS0+b2N4bF9h
ZnUgPSBvY3hsX2Z1bmN0aW9uX2ZldGNoX2FmdShzY21fZGF0YS0+b2N4bF9mbiwgMCk7DQo+ICsJ
aWYgKHNjbV9kYXRhLT5vY3hsX2FmdSA9PSBOVUxMKQ0KPiArCQlnb3RvIGVycjsNCj4gKw0KPiAr
CW9jeGxfYWZ1X2dldChzY21fZGF0YS0+b2N4bF9hZnUpOw0KPiArDQo+ICsJaWYgKHNjbV9yZWdp
c3RlcihzY21fZGF0YSkgPCAwKQ0KPiArCQlnb3RvIGVycjsNCj4gKw0KPiArCWlmIChvY3hsX2Nv
bnRleHRfYWxsb2MoJnNjbV9kYXRhLT5vY3hsX2NvbnRleHQsIHNjbV9kYXRhLT5vY3hsX2FmdSwg
TlVMTCkpDQo+ICsJCWdvdG8gZXJyOw0KPiArDQo+ICsJaWYgKG9jeGxfY29udGV4dF9hdHRhY2go
c2NtX2RhdGEtPm9jeGxfY29udGV4dCwgMCwgTlVMTCkpDQo+ICsJCWdvdG8gZXJyOw0KPiArDQo+
ICsJaWYgKHNjbV9zZXR1cF9kZXZpY2VfbWV0YWRhdGEoc2NtX2RhdGEpKQ0KPiArCQlnb3RvIGVy
cjsNCj4gKw0KPiArCWlmIChzY21fc2V0dXBfaXJxKHNjbV9kYXRhKSkNCj4gKwkJZ290byBlcnI7
DQo+ICsNCj4gKwlpZiAoc2NtX3NldHVwX2NvbW1hbmRfbWV0YWRhdGEoc2NtX2RhdGEpKQ0KPiAr
CQlnb3RvIGVycjsNCj4gKw0KPiArCWlmIChzY21fY3JlYXRlX2NkZXYoc2NtX2RhdGEpKQ0KPiAr
CQlnb3RvIGVycjsNCj4gKw0KPiArCWlmIChzY21fc3lzZnNfYWRkKHNjbV9kYXRhKSkNCj4gKwkJ
Z290byBlcnI7DQo+ICsNCj4gKwlpZiAoc2NtX2hlYXJ0YmVhdChzY21fZGF0YSkpDQo+ICsJCWdv
dG8gZXJyOw0KPiArDQo+ICsJZWxhcHNlZCA9IDA7DQo+ICsJd2hpbGUgKCFzY21faXNfdXNhYmxl
KHNjbV9kYXRhKSkgew0KPiArCQlpZiAoZWxhcHNlZCsrID4gU0NNX1VTQUJMRV9USU1FT1VUKSB7
DQo+ICsJCQlkZXZfd2Fybigmc2NtX2RhdGEtPmRldiwgIlNDTSByZWFkeSB0aW1lb3V0LlxuIik7
DQo+ICsJCQlnb3RvIGVycjsNCj4gKwkJfQ0KPiArDQo+ICsJCWRldl93YXJuKCZzY21fZGF0YS0+
ZGV2LA0KPiArCQkJICJXYWl0aW5nIGZvciBTQ00gdG8gYmVjb21lIHVzYWJsZSAoJWQvJWQgc2Vj
b25kcylcbiIsDQo+ICsJCQkgZWxhcHNlZCwgU0NNX1VTQUJMRV9USU1FT1VUKTsNCj4gKwkJbXNs
ZWVwKDEwMDApOw0KPiArCX0NCj4gKw0KPiArCWlmIChzY21fcmVnaXN0ZXJfbHBjX21lbShzY21f
ZGF0YSkpDQo+ICsJCWdvdG8gZXJyOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICsNCj4gK2VycjoN
Cj4gKwlpZiAoc2NtX2RhdGEgJiYNCj4gKwkJICAgIChzY21fY2hpKHNjbV9kYXRhLCAmY2hpKSA9
PSAwKSAmJg0KPiArCQkgICAgKGNoaSAmIEdMT0JBTF9NTUlPX0NISV9FTEEpKQ0KPiArCQlzY21f
ZHVtcF9lcnJvcl9sb2coc2NtX2RhdGEpOw0KPiArDQo+ICsJZGV2X2VycigmcGRldi0+ZGV2LA0K
PiArCQkiRXJyb3IgZGV0ZWN0ZWQsIHdpbGwgbm90IHJlZ2lzdGVyIHN0b3JhZ2UgY2xhc3MgbWVt
b3J5XG4iKTsNCj4gKwlyZXR1cm4gLUVOWElPOw0KPiArfQ0KPiArDQo+ICtzdHJ1Y3QgcGNpX2Ry
aXZlciBzY21fcGNpX2RyaXZlciA9IHsNCj4gKwkubmFtZSA9ICJvY3hsLXNjbSIsDQo+ICsJLmlk
X3RhYmxlID0gc2NtX3BjaV90YmwsDQo+ICsJLnByb2JlID0gc2NtX3Byb2JlLA0KPiArCS5yZW1v
dmUgPSBzY21fcmVtb3ZlLA0KPiArCS5zaHV0ZG93biA9IHNjbV9yZW1vdmUsDQo+ICt9Ow0KPiAr
DQo+ICtzdGF0aWMgaW50IHNjbV9maWxlX2luaXQodm9pZCkNCj4gK3sNCj4gKwlpbnQgcmM7DQo+
ICsNCj4gKwltdXRleF9pbml0KCZtaW5vcnNfaWRyX2xvY2spOw0KPiArCWlkcl9pbml0KCZtaW5v
cnNfaWRyKTsNCj4gKw0KPiArCXJjID0gYWxsb2NfY2hyZGV2X3JlZ2lvbigmc2NtX2RldiwgMCwg
U0NNX05VTV9NSU5PUlMsICJzY20iKTsNCj4gKwlpZiAocmMpIHsNCj4gKwkJcHJfZXJyKCJVbmFi
bGUgdG8gYWxsb2NhdGUgc2NtIG1ham9yIG51bWJlcjogJWRcbiIsIHJjKTsNCj4gKwkJcmV0dXJu
IHJjOw0KPiArCX0NCj4gKw0KPiArCXNjbV9jbGFzcyA9IGNsYXNzX2NyZWF0ZShUSElTX01PRFVM
RSwgInNjbSIpOw0KPiArCWlmIChJU19FUlIoc2NtX2NsYXNzKSkgew0KPiArCQlwcl9lcnIoIlVu
YWJsZSB0byBjcmVhdGUgc2NtIGNsYXNzXG4iKTsNCj4gKwkJdW5yZWdpc3Rlcl9jaHJkZXZfcmVn
aW9uKHNjbV9kZXYsIFNDTV9OVU1fTUlOT1JTKTsNCj4gKwkJcmV0dXJuIFBUUl9FUlIoc2NtX2Ns
YXNzKTsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIHZv
aWQgc2NtX2ZpbGVfZXhpdCh2b2lkKQ0KPiArew0KPiArCWNsYXNzX2Rlc3Ryb3koc2NtX2NsYXNz
KTsNCj4gKwl1bnJlZ2lzdGVyX2NocmRldl9yZWdpb24oc2NtX2RldiwgU0NNX05VTV9NSU5PUlMp
Ow0KPiArCWlkcl9kZXN0cm95KCZtaW5vcnNfaWRyKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGlu
dCBfX2luaXQgc2NtX2luaXQodm9pZCkNCj4gK3sNCj4gKwlpbnQgcmMgPSAwOw0KPiArDQo+ICsJ
cmMgPSBzY21fZmlsZV9pbml0KCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsN
Cj4gKwlyYyA9IHBjaV9yZWdpc3Rlcl9kcml2ZXIoJnNjbV9wY2lfZHJpdmVyKTsNCj4gKwlpZiAo
cmMpIHsNCj4gKwkJc2NtX2ZpbGVfZXhpdCgpOw0KPiArCQlyZXR1cm4gcmM7DQo+ICsJfQ0KPiAr
DQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHNjbV9leGl0KHZvaWQp
DQo+ICt7DQo+ICsJcGNpX3VucmVnaXN0ZXJfZHJpdmVyKCZzY21fcGNpX2RyaXZlcik7DQo+ICsJ
c2NtX2ZpbGVfZXhpdCgpOw0KPiArfQ0KPiArDQo+ICttb2R1bGVfaW5pdChzY21faW5pdCk7DQo+
ICttb2R1bGVfZXhpdChzY21fZXhpdCk7DQo+ICsNCj4gK01PRFVMRV9ERVNDUklQVElPTigiU3Rv
cmFnZSBDbGFzcyBNZW1vcnkiKTsNCj4gK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsNCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbnZkaW1tL29jeGwtc2NtX2ludGVybmFsLmMgYi9kcml2ZXJzL252ZGlt
bS9vY3hsLXNjbV9pbnRlcm5hbC5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGluZGV4IDAw
MDAwMDAwMDAwMC4uZTdjMjQ3ODM1ODE3DQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIvZHJpdmVy
cy9udmRpbW0vb2N4bC1zY21faW50ZXJuYWwuYw0KPiBAQCAtMCwwICsxLDIzMiBAQA0KPiArLy8g
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArDQo+ICsvLyBDb3B5cmlnaHQgMjAxOSBJ
Qk0gQ29ycC4NCj4gKw0KPiArI2luY2x1ZGUgPG1pc2Mvb2N4bC5oPg0KPiArI2luY2x1ZGUgPGxp
bnV4L2RlbGF5Lmg+DQo+ICsjaW5jbHVkZSAib2N4bC1zY21faW50ZXJuYWwuaCINCj4gKw0KPiAr
aW50IHNjbV9jaGkoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwgdTY0ICpjaGkpDQo+
ICt7DQo+ICsJdTY0IHZhbDsNCj4gKwlpbnQgcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3JlYWQ2NChz
Y21fZGF0YS0+b2N4bF9hZnUsIEdMT0JBTF9NTUlPX0NISSwNCj4gKwkJCQkJIE9DWExfTElUVExF
X0VORElBTiwgJnZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4gcmM7DQo+ICsNCj4gKwkq
Y2hpID0gdmFsOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK2Jvb2wgc2NtX2Nv
bnRyb2xsZXJfaXNfcmVhZHkoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSkNCj4gK3sN
Cj4gKwl1NjQgdmFsID0gMDsNCj4gKwlpbnQgcmMgPSBzY21fY2hpKHNjbV9kYXRhLCAmdmFsKTsN
Cj4gKw0KPiArCVdBUk5fT04ocmMgPCAwKTsNCj4gKw0KPiArCXJldHVybiAodmFsICYgR0xPQkFM
X01NSU9fQ0hJX0NSRFkpICE9IDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgc2NtX2NvbW1h
bmRfcmVxdWVzdChjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJICAgICAg
IHN0cnVjdCBjb21tYW5kX21ldGFkYXRhICpjbWQsIHU4IG9wX2NvZGUpDQo+ICt7DQo+ICsJdTY0
IHZhbCA9IG9wX2NvZGU7DQo+ICsJaW50IHJjOw0KPiArCXU4IGk7DQo+ICsNCj4gKwlpZiAoIXNj
bV9jb250cm9sbGVyX2lzX3JlYWR5KHNjbV9kYXRhKSkNCj4gKwkJcmV0dXJuIC1FSU87DQo+ICsN
Cj4gKwljbWQtPm9wX2NvZGUgPSBvcF9jb2RlOw0KPiArCWNtZC0+aWQrKzsNCj4gKw0KPiArCXZh
bCB8PSAoKHU2NCljbWQtPmlkKSA8PCAxNjsNCj4gKw0KPiArCXJjID0gb2N4bF9nbG9iYWxfbW1p
b193cml0ZTY0KHNjbV9kYXRhLT5vY3hsX2FmdSwgY21kLT5yZXF1ZXN0X29mZnNldCwNCj4gKwkJ
CQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sIHZhbCk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1
cm4gcmM7DQo+ICsNCj4gKwlmb3IgKGkgPSAweDA4OyBpIDw9IDB4Mzg7IGkgKz0gMHgwOCkgew0K
PiArCQlyYyA9IG9jeGxfZ2xvYmFsX21taW9fd3JpdGU2NChzY21fZGF0YS0+b2N4bF9hZnUsDQo+
ICsJCQkJCSAgICAgIGNtZC0+cmVxdWVzdF9vZmZzZXQgKyBpLA0KPiArCQkJCQkgICAgICBPQ1hM
X0xJVFRMRV9FTkRJQU4sIDApOw0KPiArCQlpZiAocmMpDQo+ICsJCQlyZXR1cm4gcmM7DQo+ICsJ
fQ0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK2ludCBzY21fYWRtaW5fY29tbWFu
ZF9yZXF1ZXN0KHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEsIHU4IG9wX2NvZGUpDQo+ICt7DQo+
ICsJcmV0dXJuIHNjbV9jb21tYW5kX3JlcXVlc3Qoc2NtX2RhdGEsICZzY21fZGF0YS0+YWRtaW5f
Y29tbWFuZCwgb3BfY29kZSk7DQo+ICt9DQo+ICsNCj4gK2ludCBzY21fY29tbWFuZF9yZXNwb25z
ZShjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJIGNvbnN0IHN0cnVjdCBj
b21tYW5kX21ldGFkYXRhICpjbWQpDQo+ICt7DQo+ICsJdTY0IHZhbDsNCj4gKwl1MTYgaWQ7DQo+
ICsJdTggc3RhdHVzOw0KPiArCWludCByYyA9IG9jeGxfZ2xvYmFsX21taW9fcmVhZDY0KHNjbV9k
YXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkJIGNtZC0+cmVzcG9uc2Vfb2Zmc2V0LA0KPiArCQkJCQkg
T0NYTF9MSVRUTEVfRU5ESUFOLCAmdmFsKTsNCj4gKwlpZiAocmMpDQo+ICsJCXJldHVybiByYzsN
Cj4gKw0KPiArCXN0YXR1cyA9IHZhbCAmIDB4ZmY7DQo+ICsJaWQgPSAodmFsID4+IDE2KSAmIDB4
ZmZmZjsNCj4gKw0KPiArCWlmIChpZCAhPSBjbWQtPmlkKSB7DQo+ICsJCWRldl93YXJuKCZzY21f
ZGF0YS0+ZGV2LA0KPiArCQkJICJFeHBlY3RlZCByZXNwb25zZSBmb3IgY29tbWFuZCAlZCwgYnV0
IHJlY2VpdmVkIHJlc3BvbnNlIGZvciBjb21tYW5kICVkIGluc3RlYWQuXG4iLA0KPiArCQkJIGNt
ZC0+aWQsIGlkKTsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gc3RhdHVzOw0KPiArfQ0KPiArDQo+
ICtpbnQgc2NtX2FkbWluX3Jlc3BvbnNlKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEp
DQo+ICt7DQo+ICsJcmV0dXJuIHNjbV9jb21tYW5kX3Jlc3BvbnNlKHNjbV9kYXRhLCAmc2NtX2Rh
dGEtPmFkbWluX2NvbW1hbmQpOw0KPiArfQ0KPiArDQo+ICsNCj4gK2ludCBzY21fYWRtaW5fY29t
bWFuZF9leGVjdXRlKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJ
cmV0dXJuIG9jeGxfZ2xvYmFsX21taW9fc2V0NjQoc2NtX2RhdGEtPm9jeGxfYWZ1LCBHTE9CQUxf
TU1JT19IQ0ksDQo+ICsJCQkJICAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLCBHTE9CQUxfTU1JT19I
Q0lfQUNSVyk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBib29sIHNjbV9hZG1pbl9jb21tYW5kX2Nv
bXBsZXRlKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpDQo+ICt7DQo+ICsJdTY0IHZh
bCA9IDA7DQo+ICsNCj4gKwlpbnQgcmMgPSBzY21fY2hpKHNjbV9kYXRhLCAmdmFsKTsNCj4gKw0K
PiArCVdBUk5fT04ocmMpOw0KPiArDQo+ICsJcmV0dXJuICh2YWwgJiBHTE9CQUxfTU1JT19DSElf
QUNSQSkgIT0gMDsNCj4gK30NCj4gKw0KPiAraW50IHNjbV9hZG1pbl9jb21tYW5kX2NvbXBsZXRl
X3RpbWVvdXQoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCQkgICAgICAg
aW50IGNvbW1hbmQpDQo+ICt7DQo+ICsJdTMyIHRpbWVvdXQgPSBzY21fZGF0YS0+dGltZW91dHNb
Y29tbWFuZF07DQo+ICsJdGltZW91dCsrOw0KPiArCXRpbWVvdXQgLz0gMzI7DQo+ICsJaWYgKCF0
aW1lb3V0KQ0KPiArCQl0aW1lb3V0ID0gU0NNX0RFRkFVTFRfVElNRU9VVCAvIDMyOw0KPiArDQo+
ICsJd2hpbGUgKHRpbWVvdXQtLSA+IDApIHsNCj4gKwkJaWYgKHNjbV9hZG1pbl9jb21tYW5kX2Nv
bXBsZXRlKHNjbV9kYXRhKSkNCj4gKwkJCXJldHVybiAwOw0KPiArCQltc2xlZXAoMzIpOw0KPiAr
CX0NCj4gKw0KPiArCXJldHVybiAtRUJVU1k7DQo+ICt9DQo+ICsNCj4gK2ludCBzY21fYWRtaW5f
cmVzcG9uc2VfaGFuZGxlZChjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKQ0KPiArew0K
PiArCXJldHVybiBvY3hsX2dsb2JhbF9tbWlvX3NldDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwgR0xP
QkFMX01NSU9fQ0hJQywNCj4gKwkJCQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sIEdMT0JBTF9N
TUlPX0NISV9BQ1JBKTsNCj4gK30NCj4gKw0KPiAraW50IHNjbV9uc19jb21tYW5kX3JlcXVlc3Qo
c3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwgdTggb3BfY29kZSkNCj4gK3sNCj4gKwlyZXR1cm4g
c2NtX2NvbW1hbmRfcmVxdWVzdChzY21fZGF0YSwgJnNjbV9kYXRhLT5uc19jb21tYW5kLCBvcF9j
b2RlKTsNCj4gK30NCj4gKw0KPiAraW50IHNjbV9uc19yZXNwb25zZShjb25zdCBzdHJ1Y3Qgc2Nt
X2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCXJldHVybiBzY21fY29tbWFuZF9yZXNwb25zZShz
Y21fZGF0YSwgJnNjbV9kYXRhLT5uc19jb21tYW5kKTsNCj4gK30NCj4gKw0KPiAraW50IHNjbV9u
c19jb21tYW5kX2V4ZWN1dGUoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSkNCj4gK3sN
Cj4gKwlyZXR1cm4gb2N4bF9nbG9iYWxfbW1pb19zZXQ2NChzY21fZGF0YS0+b2N4bF9hZnUsIEdM
T0JBTF9NTUlPX0hDSSwNCj4gKwkJCQkgICAgICBPQ1hMX0xJVFRMRV9FTkRJQU4sIEdMT0JBTF9N
TUlPX0hDSV9OU0NSVyk7DQo+ICt9DQo+ICsNCj4gK2Jvb2wgc2NtX25zX2NvbW1hbmRfY29tcGxl
dGUoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSkNCj4gK3sNCj4gKwl1NjQgdmFsID0g
MDsNCj4gKwlpbnQgcmMgPSBzY21fY2hpKHNjbV9kYXRhLCAmdmFsKTsNCj4gKw0KPiArCVdBUk5f
T04ocmMpOw0KPiArDQo+ICsJcmV0dXJuICh2YWwgJiBHTE9CQUxfTU1JT19DSElfTlNDUkEpICE9
IDA7DQo+ICt9DQo+ICsNCj4gK2ludCBzY21fbnNfcmVzcG9uc2VfaGFuZGxlZChjb25zdCBzdHJ1
Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKQ0KPiArew0KPiArCXJldHVybiBvY3hsX2dsb2JhbF9tbWlv
X3NldDY0KHNjbV9kYXRhLT5vY3hsX2FmdSwgR0xPQkFMX01NSU9fQ0hJQywNCj4gKwkJCQkgICAg
ICBPQ1hMX0xJVFRMRV9FTkRJQU4sIEdMT0JBTF9NTUlPX0NISV9OU0NSQSk7DQo+ICt9DQo+ICsN
Cj4gKw0KPiArdm9pZCBzY21fd2Fybl9zdGF0dXMoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21f
ZGF0YSwgY29uc3QgY2hhciAqbWVzc2FnZSwNCj4gKwkJICAgICB1OCBzdGF0dXMpDQo+ICt7DQo+
ICsJY29uc3QgY2hhciAqdGV4dCA9ICJVbmtub3duIjsNCj4gKw0KPiArCXN3aXRjaCAoc3RhdHVz
KSB7DQo+ICsJY2FzZSBTVEFUVVNfU1VDQ0VTUzoNCj4gKwkJdGV4dCA9ICJTdWNjZXNzIjsNCj4g
KwkJYnJlYWs7DQo+ICsNCj4gKwljYXNlIFNUQVRVU19NRU1fVU5BVkFJTEFCTEU6DQo+ICsJCXRl
eHQgPSAiUGVyc2lzdGVudCBtZW1vcnkgdW5hdmFpbGFibGUiOw0KPiArCQlicmVhazsNCj4gKw0K
PiArCWNhc2UgU1RBVFVTX0JBRF9PUENPREU6DQo+ICsJCXRleHQgPSAiQmFkIG9wY29kZSI7DQo+
ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBTVEFUVVNfQkFEX1JFUVVFU1RfUEFSTToNCj4gKwkJ
dGV4dCA9ICJCYWQgcmVxdWVzdCBwYXJhbWV0ZXIiOw0KPiArCQlicmVhazsNCj4gKw0KPiArCWNh
c2UgU1RBVFVTX0JBRF9EQVRBX1BBUk06DQo+ICsJCXRleHQgPSAiQmFkIGRhdGEgcGFyYW1ldGVy
IjsNCj4gKwkJYnJlYWs7DQo+ICsNCj4gKwljYXNlIFNUQVRVU19ERUJVR19CTE9DS0VEOg0KPiAr
CQl0ZXh0ID0gIkRlYnVnIGFjdGlvbiBibG9ja2VkIjsNCj4gKwkJYnJlYWs7DQo+ICsNCj4gKwlj
YXNlIFNUQVRVU19GQUlMOg0KPiArCQl0ZXh0ID0gIkZhaWxlZCI7DQo+ICsJCWJyZWFrOw0KPiAr
CX0NCj4gKw0KPiArCWRldl93YXJuKCZzY21fZGF0YS0+ZGV2LCAiJXM6ICVzICgleClcbiIsIG1l
c3NhZ2UsIHRleHQsIHN0YXR1cyk7DQo+ICt9DQo+ICsNCj4gK3ZvaWQgc2NtX3dhcm5fc3RhdHVz
X2Z3X3VwZGF0ZShjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLA0KPiArCQkJICAgICAg
IGNvbnN0IGNoYXIgKm1lc3NhZ2UsIHU4IHN0YXR1cykNCj4gK3sNCj4gKwljb25zdCBjaGFyICp0
ZXh0Ow0KPiArDQo+ICsJc3dpdGNoIChzdGF0dXMpIHsNCj4gKwljYXNlIFNUQVRVU19GV19VUERB
VEVfQkxPQ0tFRDoNCj4gKwkJdGV4dCA9ICJGaXJtd2FyZSB1cGRhdGUgaXMgYmxvY2tlZCwgcGxl
YXNlIHRyeSBhZ2FpbiBsYXRlciI7DQo+ICsJCWJyZWFrOw0KPiArDQo+ICsJY2FzZSBTVEFUVVNf
RldfQVJHX0lOVkFMSUQ6DQo+ICsJCXRleHQgPSAiSW50ZXJuYWwgZXJyb3IgaW4gU0NNIGZpcm13
YXJlIHVwZGF0ZSBtZWNoYW5pc20iOw0KPiArCQlicmVhazsNCj4gKw0KPiArCWNhc2UgU1RBVFVT
X0ZXX0lOVkFMSUQ6DQo+ICsJCXRleHQgPSAiRmlybXdhcmUgY29udGVudCBpcyBpbnZhbGlkLCBw
bGVhc2UgdmVyaWZ5IGZpcm13YXJlIHVwZGF0ZSBmaWxlIjsNCj4gKwkJYnJlYWs7DQo+ICsNCj4g
KwlkZWZhdWx0Og0KPiArCQlyZXR1cm4gc2NtX3dhcm5fc3RhdHVzKHNjbV9kYXRhLCBtZXNzYWdl
LCBzdGF0dXMpOw0KPiArCX0NCj4gKw0KPiArCWRldl93YXJuKCZzY21fZGF0YS0+ZGV2LCAiJXM6
ICVzICgleClcbiIsIG1lc3NhZ2UsIHRleHQsIHN0YXR1cyk7DQo+ICt9DQo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL252ZGltbS9vY3hsLXNjbV9pbnRlcm5hbC5oIGIvZHJpdmVycy9udmRpbW0vb2N4
bC1zY21faW50ZXJuYWwuaA0KPiBuZXcgZmlsZSBtb2RlIDEwMDY0NA0KPiBpbmRleCAwMDAwMDAw
MDAwMDAuLmMyMzZkODA5MmM2ZA0KPiAtLS0gL2Rldi9udWxsDQo+ICsrKyBiL2RyaXZlcnMvbnZk
aW1tL29jeGwtc2NtX2ludGVybmFsLmgNCj4gQEAgLTAsMCArMSwzMzEgQEANCj4gKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KPiArLy8gQ29weXJpZ2h0IDIwMTkgSUJNIENv
cnAuDQo+ICsNCj4gKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9j
ZGV2Lmg+DQo+ICsjaW5jbHVkZSA8bWlzYy9vY3hsLmg+DQo+ICsjaW5jbHVkZSA8bGludXgvbGli
bnZkaW1tLmg+DQo+ICsjaW5jbHVkZSA8dWFwaS9saW51eC9vY3hsLXNjbS5oPg0KPiArI2luY2x1
ZGUgPGxpbnV4L21tLmg+DQo+ICsNCj4gKyNkZWZpbmUgU0NNX0RFRkFVTFRfVElNRU9VVCAxMDAN
Cj4gKw0KPiArI2RlZmluZSBHTE9CQUxfTU1JT19DSEkJCTB4MDAwDQo+ICsjZGVmaW5lIEdMT0JB
TF9NTUlPX0NISUMJMHgwMDgNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fQ0hJRQkweDAxMA0KPiAr
I2RlZmluZSBHTE9CQUxfTU1JT19DSElFQwkweDAxOA0KPiArI2RlZmluZSBHTE9CQUxfTU1JT19I
Q0kJCTB4MDIwDQo+ICsjZGVmaW5lIEdMT0JBTF9NTUlPX0hDSUMJMHgwMjgNCj4gKyNkZWZpbmUg
R0xPQkFMX01NSU9fSU1BMF9PSFAJMHgwNDANCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fSU1BMF9D
RlAJMHgwNDgNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fSU1BMV9PSFAJMHgwNTANCj4gKyNkZWZp
bmUgR0xPQkFMX01NSU9fSU1BMV9DRlAJMHgwNTgNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fQUNN
QV9DUkVRTwkweDEwMA0KPiArI2RlZmluZSBHTE9CQUxfTU1JT19BQ01BX0NSU1BPCTB4MTA0DQo+
ICsjZGVmaW5lIEdMT0JBTF9NTUlPX0FDTUFfQ0RCTwkweDEwOA0KPiArI2RlZmluZSBHTE9CQUxf
TU1JT19BQ01BX0NEQlMJMHgxMGMNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fTlNDTUFfQ1JFUU8J
MHgxMjANCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fTlNDTUFfQ1JTUE8JMHgxMjQNCj4gKyNkZWZp
bmUgR0xPQkFMX01NSU9fTlNDTUFfQ0RCTwkweDEyOA0KPiArI2RlZmluZSBHTE9CQUxfTU1JT19O
U0NNQV9DREJTCTB4MTJjDQo+ICsjZGVmaW5lIEdMT0JBTF9NTUlPX0NTVFMJMHgxNDANCj4gKyNk
ZWZpbmUgR0xPQkFMX01NSU9fRldWRVIJMHgxNDgNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fQ0NB
UDAJMHgxNjANCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fQ0NBUDEJMHgxNjgNCj4gKw0KPiArI2Rl
ZmluZSBHTE9CQUxfTU1JT19DSElfQUNSQQlCSVRfVUxMKDApDQo+ICsjZGVmaW5lIEdMT0JBTF9N
TUlPX0NISV9OU0NSQQlCSVRfVUxMKDEpDQo+ICsjZGVmaW5lIEdMT0JBTF9NTUlPX0NISV9DUkRZ
CUJJVF9VTEwoNCkNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fQ0hJX0NGRlMJQklUX1VMTCg1KQ0K
PiArI2RlZmluZSBHTE9CQUxfTU1JT19DSElfTUEJQklUX1VMTCg2KQ0KPiArI2RlZmluZSBHTE9C
QUxfTU1JT19DSElfRUxBCUJJVF9VTEwoNykNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fQ0hJX0NE
QQlCSVRfVUxMKDgpDQo+ICsjZGVmaW5lIEdMT0JBTF9NTUlPX0NISV9DSEZTCUJJVF9VTEwoOSkN
Cj4gKw0KPiArI2RlZmluZSBHTE9CQUxfTU1JT19DSElfQUxMCShHTE9CQUxfTU1JT19DSElfQUNS
QSB8IFwNCj4gKwkJCQkgR0xPQkFMX01NSU9fQ0hJX05TQ1JBIHwgXA0KPiArCQkJCSBHTE9CQUxf
TU1JT19DSElfQ1JEWSB8IFwNCj4gKwkJCQkgR0xPQkFMX01NSU9fQ0hJX0NGRlMgfCBcDQo+ICsJ
CQkJIEdMT0JBTF9NTUlPX0NISV9NQSB8IFwNCj4gKwkJCQkgR0xPQkFMX01NSU9fQ0hJX0VMQSB8
IFwNCj4gKwkJCQkgR0xPQkFMX01NSU9fQ0hJX0NEQSB8IFwNCj4gKwkJCQkgR0xPQkFMX01NSU9f
Q0hJX0NIRlMpDQo+ICsNCj4gKyNkZWZpbmUgR0xPQkFMX01NSU9fSENJX0FDUlcJCQkJQklUX1VM
TCgwKQ0KPiArI2RlZmluZSBHTE9CQUxfTU1JT19IQ0lfTlNDUlcJCQkJQklUX1VMTCgxKQ0KPiAr
I2RlZmluZSBHTE9CQUxfTU1JT19IQ0lfQUZVX1JFU0VUCQkJQklUX1VMTCgyKQ0KPiArI2RlZmlu
ZSBHTE9CQUxfTU1JT19IQ0lfRldfREVCVUcJCQlCSVRfVUxMKDMpDQo+ICsjZGVmaW5lIEdMT0JB
TF9NTUlPX0hDSV9DT05UUk9MTEVSX0RVTVAJCQlCSVRfVUxMKDQpDQo+ICsjZGVmaW5lIEdMT0JB
TF9NTUlPX0hDSV9DT05UUk9MTEVSX0RVTVBfQ09MTEVDVEVECUJJVF9VTEwoNSkNCj4gKyNkZWZp
bmUgR0xPQkFMX01NSU9fSENJX1JFUV9IRUFMVEhfUEVSRgkJCUJJVF9VTEwoNikNCj4gKw0KPiAr
I2RlZmluZSBBRE1JTl9DT01NQU5EX0hFQVJUQkVBVAkJMHgwMHUNCj4gKyNkZWZpbmUgQURNSU5f
Q09NTUFORF9TSFVURE9XTgkJMHgwMXUNCj4gKyNkZWZpbmUgQURNSU5fQ09NTUFORF9GV19VUERB
VEUJCTB4MDJ1DQo+ICsjZGVmaW5lIEFETUlOX0NPTU1BTkRfRldfREVCVUcJCTB4MDN1DQo+ICsj
ZGVmaW5lIEFETUlOX0NPTU1BTkRfRVJSTE9HCQkweDA0dQ0KPiArI2RlZmluZSBBRE1JTl9DT01N
QU5EX1NNQVJUCQkweDA1dQ0KPiArI2RlZmluZSBBRE1JTl9DT01NQU5EX0NPTlRST0xMRVJfU1RB
VFMJMHgwNnUNCj4gKyNkZWZpbmUgQURNSU5fQ09NTUFORF9DT05UUk9MTEVSX0RVTVAJMHgwN3UN
Cj4gKyNkZWZpbmUgQURNSU5fQ09NTUFORF9DTURfQ0FQUwkJMHgwOHUNCj4gKyNkZWZpbmUgQURN
SU5fQ09NTUFORF9NQVgJCTB4MDh1DQo+ICsNCj4gKyNkZWZpbmUgTlNfQ09NTUFORF9TRUNVUkVf
RVJBU0UJMHgyMHVsbA0KPiArDQo+ICsjZGVmaW5lIE5TX1JFU1BPTlNFX1NFQ1VSRV9FUkFTRV9B
Q0NFU1NJQkxFX1NVQ0NFU1MgMHgyMA0KPiArI2RlZmluZSBOU19SRVNQT05TRV9TRUNVUkVfRVJB
U0VfQUNDRVNTSUJMRV9BVFRFTVBURUQgMHgyOA0KPiArI2RlZmluZSBOU19SRVNQT05TRV9TRUNV
UkVfRVJBU0VfREVGRUNUSVZFX1NVQ0NFU1MgMHgzMA0KPiArI2RlZmluZSBOU19SRVNQT05TRV9T
RUNVUkVfRVJBU0VfREVGRUNUSVZFX0FUVEVNUFRFRCAweDM4DQo+ICsNCj4gKw0KPiArDQo+ICsj
ZGVmaW5lIFNUQVRVU19TVUNDRVNTCQkweDAwDQo+ICsjZGVmaW5lIFNUQVRVU19NRU1fVU5BVkFJ
TEFCTEUJMHgyMA0KPiArI2RlZmluZSBTVEFUVVNfQkFEX09QQ09ERQkweDUwDQo+ICsjZGVmaW5l
IFNUQVRVU19CQURfUkVRVUVTVF9QQVJNCTB4NTENCj4gKyNkZWZpbmUgU1RBVFVTX0JBRF9EQVRB
X1BBUk0JMHg1Mg0KPiArI2RlZmluZSBTVEFUVVNfREVCVUdfQkxPQ0tFRAkweDcwDQo+ICsjZGVm
aW5lIFNUQVRVU19GQUlMCQkweEZGDQo+ICsNCj4gKyNkZWZpbmUgU1RBVFVTX0ZXX1VQREFURV9C
TE9DS0VEIDB4MjENCj4gKyNkZWZpbmUgU1RBVFVTX0ZXX0FSR19JTlZBTElECTB4NTENCj4gKyNk
ZWZpbmUgU1RBVFVTX0ZXX0lOVkFMSUQJMHg1Mg0KPiArDQo+ICsjZGVmaW5lIFNDTV9MQUJFTF9B
UkVBX1NJWkUJKDFVTCA8PCBQQV9TRUNUSU9OX1NISUZUKQ0KPiArDQo+ICtzdHJ1Y3QgY29tbWFu
ZF9tZXRhZGF0YSB7DQo+ICsJdTMyIHJlcXVlc3Rfb2Zmc2V0Ow0KPiArCXUzMiByZXNwb25zZV9v
ZmZzZXQ7DQo+ICsJdTMyIGRhdGFfb2Zmc2V0Ow0KPiArCXUzMiBkYXRhX3NpemU7DQo+ICsJc3Ry
dWN0IG11dGV4IGxvY2s7DQo+ICsJdTE2IGlkOw0KPiArCXU4IG9wX2NvZGU7DQo+ICt9Ow0KPiAr
DQo+ICtzdHJ1Y3Qgc2NtX2Z1bmN0aW9uXzAgew0KPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0K
PiArCXN0cnVjdCBvY3hsX2ZuICpvY3hsX2ZuOw0KPiArfTsNCj4gKw0KPiArZW51bSBvdmVyd3Jp
dGVfc3RhdGUgew0KPiArCVNDTV9PVkVSV1JJVEVfSURMRSA9IDAsDQo+ICsJU0NNX09WRVJXUklU
RV9CVVNZLA0KPiArCVNDTV9PVkVSV1JJVEVfU1VDQ0VTUywNCj4gKwlTQ01fT1ZFUldSSVRFX0ZB
SUxFRA0KPiArfTsNCj4gKw0KPiArI2RlZmluZSBTQ01fU01BUlRfQVRUUl9QT1dFUl9PTl9IT1VS
UwkweDA5DQo+ICsjZGVmaW5lIFNDTV9TTUFSVF9BVFRSX1RFTVBFUkFUVVJFCTB4QzINCj4gKyNk
ZWZpbmUgU0NNX1NNQVJUX0FUVFJfTElGRV9SRU1BSU5JTkcJMHhDQQ0KPiArDQo+ICtzdHJ1Y3Qg
c2NtX3NtYXJ0X2F0dHJpYiB7DQo+ICsJX191OCBpZDsgLyogb3V0LCBTZWUgZGVmaW5lcyBhYm92
ZSAqLw0KPiArCV9fdTE2IGF0dHJpYnV0ZV9mbGFnczsNCj4gKwlfX3U4IGN1cnJlbnRfdmFsOw0K
PiArCV9fdTggdGhyZXNob2xkX3ZhbDsNCj4gKwlfX3U4IHdvcnN0X3ZhbDsNCj4gKwlfX3U4IHJl
c2VydmVkOw0KPiArCV9fdTY0IHJhd192YWw7DQo+ICt9Ow0KPiArDQo+ICtzdHJ1Y3Qgc2NtX3Nt
YXJ0X2F0dHJpYnMgew0KPiArCXN0cnVjdCBzY21fc21hcnRfYXR0cmliIHBvd2VyX29uX2hvdXJz
Ow0KPiArCXN0cnVjdCBzY21fc21hcnRfYXR0cmliIHRlbXBlcmF0dXJlOw0KPiArCXN0cnVjdCBz
Y21fc21hcnRfYXR0cmliIGxpZmVfcmVtYWluaW5nOw0KPiArfTsNCj4gKw0KPiArc3RydWN0IHNj
bV9kYXRhIHsNCj4gKwlzdHJ1Y3QgZGV2aWNlIGRldjsNCj4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRl
djsNCj4gKwlzdHJ1Y3QgY2RldiBjZGV2Ow0KPiArCXN0cnVjdCBvY3hsX2ZuICpvY3hsX2ZuOw0K
PiArI2RlZmluZSBTQ01fSVJRX0NPVU5UIDINCj4gKwlpbnQgaXJxX2lkW1NDTV9JUlFfQ09VTlRd
Ow0KPiArCXN0cnVjdCBkZXZfcGFnZW1hcCBpcnFfcGdtYXBbU0NNX0lSUV9DT1VOVF07DQo+ICsJ
dm9pZCAqaXJxX2FkZHJbU0NNX0lSUV9DT1VOVF07DQo+ICsJc3RydWN0IG5kX2ludGVybGVhdmVf
c2V0IG5kX3NldDsNCj4gKwlzdHJ1Y3QgbnZkaW1tX2J1c19kZXNjcmlwdG9yIGJ1c19kZXNjOw0K
PiArCXN0cnVjdCBudmRpbW1fYnVzICpudmRpbW1fYnVzOw0KPiArCXN0cnVjdCBvY3hsX2FmdSAq
b2N4bF9hZnU7DQo+ICsJc3RydWN0IG9jeGxfY29udGV4dCAqb2N4bF9jb250ZXh0Ow0KPiArCXZv
aWQgKm1ldGFkYXRhX2FkZHI7DQo+ICsJc3RydWN0IHNjbV9nbG9iYWxfbW1pbyAqZ2xvYmFsX21t
aW87DQo+ICsJc3RydWN0IGNvbW1hbmRfbWV0YWRhdGEgYWRtaW5fY29tbWFuZDsNCj4gKwlzdHJ1
Y3QgY29tbWFuZF9tZXRhZGF0YSBuc19jb21tYW5kOw0KPiArCWVudW0gb3ZlcndyaXRlX3N0YXRl
IG92ZXJ3cml0ZV9zdGF0ZTsNCj4gKwlzdHJ1Y3QgcmVzb3VyY2Ugc2NtX3JlczsNCj4gKwlzdHJ1
Y3QgbmRfcmVnaW9uICpuZF9yZWdpb247DQo+ICsJc3RydWN0IGV2ZW50ZmRfY3R4ICpldl9jdHg7
DQo+ICsJc3RydWN0IHNjbV9zbWFydF9hdHRyaWJzIHNtYXJ0Ow0KPiArCWNoYXIgZndfdmVyc2lv
bls4KzFdOw0KPiArCXUzMiB0aW1lb3V0c1tBRE1JTl9DT01NQU5EX01BWCsxXTsNCj4gKw0KPiAr
CXUxNiBzY21fcmV2aXNpb247IC8vIG1ham9yL21pbm9yDQo+ICsJdTE2IHJlYWRpbmVzc190aW1l
b3V0OyAvKiBUaGUgd29yc3QgY2FzZSB0aW1lIChpbiBtaWxsaXNlY29uZHMpIHRoYXQgdGhlIGhv
c3Qgc2hhbGwNCj4gKwkJCQkqIHdhaXQgZm9yIHRoZSBjb250cm9sbGVyIHRvIGJlY29tZSBvcGVy
YXRpb25hbCBmb2xsb3dpbmcgYSByZXNldCAoQ0hJLkNSRFkpLg0KPiArCQkJCSovDQo+ICsJdTE2
IHJlYWRfbGF0ZW5jeTsgLyogVGhlIG5vbWluYWwgbWVhc3VyZSBvZiBsYXRlbmN5IChpbiBuYW5v
c2Vjb25kcykNCj4gKwkJCSAgICogYXNzb2NpYXRlZCB3aXRoIGFuIHVuYXNzaXN0ZWQgcmVhZCBv
ZiBhIG1lbW9yeSBibG9jay4NCj4gKwkJCSAgICogVGhpcyByZXByZXNlbnRzIHRoZSBjYXBhYmls
aXR5IG9mIHRoZSByYXcgbWVkaWEgdGVjaG5vbG9neSB3aXRob3V0IGFzc2lzdGFuY2UNCj4gKwkJ
CSAgICovDQo+ICsJdTMyIG1heF9jb250cm9sbGVyX2R1bXBfc2l6ZTsgLy8gYnl0ZXMNCj4gK307
DQo+ICsNCj4gKy8qKg0KPiArICogQ3JlYXRlIHN5c2ZzIGVudHJpZXMgZm9yIGFuIFNDTSBkZXZp
Y2UNCj4gKyAqIHNjbV9kYXRhOiBUaGUgU0NNIG1ldGFkYXRhDQo+ICsgKi8NCj4gK2ludCBzY21f
c3lzZnNfYWRkKHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpOw0KPiArDQo+ICsvKioNCj4gKyAq
IEdldCB0aGUgdmFsdWUgb2YgdGhlIENISSByZWdpc3RlcjoNCj4gKyAqIHNjbV9kYXRhOiBUaGUg
U0NNIG1ldGFkYXRhDQo+ICsgKiBjaGk6IHJldHVybnMgdGhlIENISSB2YWx1ZQ0KPiArICoNCj4g
KyAqIFJldHVybnMgMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBlcnJvcg0KPiArICovDQo+ICtp
bnQgc2NtX2NoaShjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLCB1NjQgKmNoaSk7DQo+
ICsNCj4gKy8qKg0KPiArICogc2NtX2NvbnRyb2xsZXJfaXNfcmVhZHkgLSBJcyB0aGUgY29udHJv
bGxlciByZWFkeT8NCj4gKyAqIEBzY21fZGF0YTogYSBwb2ludGVyIHRvIHRoZSBTQ00gZGV2aWNl
IGRhdGENCj4gKyAqIFJldHVybiB0cnVlIGlmIHRoZSBjb250cm9sbGVyIGlzIHJlYWR5DQo+ICsg
Ki8NCj4gK2Jvb2wgc2NtX2NvbnRyb2xsZXJfaXNfcmVhZHkoY29uc3Qgc3RydWN0IHNjbV9kYXRh
ICpzY21fZGF0YSk7DQo+ICsNCj4gKy8qKg0KPiArICogSXNzdWUgYW4gYWRtaW4gY29tbWFuZCBy
ZXF1ZXN0DQo+ICsgKg0KPiArICogc2NtX2RhdGE6IGEgcG9pbnRlciB0byB0aGUgU0NNIGRldmlj
ZSBkYXRhDQo+ICsgKiBvcF9jb2RlOiBUaGUgb3AtY29kZSBmb3IgdGhlIGNvbW1hbmQNCj4gKyAq
DQo+ICsgKiBSZXR1cm5zIGFuIGlkZW50aWZpZXIgZm9yIHRoZSBjb21tYW5kLCBvciBuZWdhdGl2
ZSBvbiBlcnJvcg0KPiArICovDQo+ICtpbnQgc2NtX2FkbWluX2NvbW1hbmRfcmVxdWVzdChzdHJ1
Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhLCB1OCBvcF9jb2RlKTsNCj4gKw0KPiArLyoqDQo+ICsgKiBW
YWxpZGF0ZSBhbiBhZG1pbiByZXNwb25zZQ0KPiArICoNCj4gKyAqIHNjbV9kYXRhOiBhIHBvaW50
ZXIgdG8gdGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiArICoNCj4gKyAqIFJldHVybnMgdGhlIHN0YXR1
cyBjb2RlIG9mIHRoZSBjb21tYW5kLCBvciBuZWdhdGl2ZSBvbiBlcnJvcg0KPiArICovDQo+ICtp
bnQgc2NtX2FkbWluX3Jlc3BvbnNlKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpOw0K
PiArDQo+ICsvKioNCj4gKyAqIE5vdGlmeSB0aGUgY29udHJvbGxlciB0byBzdGFydCBwcm9jZXNz
aW5nIGEgcGVuZGluZyBhZG1pbiBjb21tYW5kDQo+ICsgKg0KPiArICogc2NtX2RhdGE6IGEgcG9p
bnRlciB0byB0aGUgU0NNIGRldmljZSBkYXRhDQo+ICsgKg0KPiArICogUmV0dXJucyAwIG9uIHN1
Y2Nlc3MsIG5lZ2F0aXZlIG9uIGVycm9yDQo+ICsgKi8NCj4gK2ludCBzY21fYWRtaW5fY29tbWFu
ZF9leGVjdXRlKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEpOw0KPiArDQo+ICsvKioN
Cj4gKyAqIFdhaXQgZm9yIGFuIGFkbWluIGNvbW1hbmQgdG8gZmluaXNoIGV4ZWN1dGluZw0KPiAr
ICoNCj4gKyAqIHNjbV9kYXRhOiBhIHBvaW50ZXIgdG8gdGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiAr
ICogY29tbWFuZDogdGhlIGFkbWluIGNvbW1hbmQgdG8gd2FpdCBmb3IgY29tcGxldGlvbiAoZGV0
ZXJtaW5lcyB0aGUgdGltZW91dCkNCj4gKyAqDQo+ICsgKiBSZXR1cm5zIDAgb24gc3VjY2Vzcywg
LUVCVVNZIG9uIHRpbWVvdXQNCj4gKyAqLw0KPiAraW50IHNjbV9hZG1pbl9jb21tYW5kX2NvbXBs
ZXRlX3RpbWVvdXQoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCQkgICAg
ICAgaW50IGNvbW1hbmQpOw0KPiArDQo+ICsvKioNCj4gKyAqIE5vdGlmeSB0aGUgY29udHJvbGxl
ciB0aGF0IHRoZSBhZG1pbiByZXNwb25zZSBoYXMgYmVlbiBoYW5kbGVkDQo+ICsgKg0KPiArICog
c2NtX2RhdGE6IGEgcG9pbnRlciB0byB0aGUgU0NNIGRldmljZSBkYXRhDQo+ICsgKg0KPiArICog
UmV0dXJucyAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIG9uIGZhaWx1cmUNCj4gKyAqLw0KPiAraW50
IHNjbV9hZG1pbl9yZXNwb25zZV9oYW5kbGVkKGNvbnN0IHN0cnVjdCBzY21fZGF0YSAqc2NtX2Rh
dGEpOw0KPiArDQo+ICsvKioNCj4gKyAqIElzc3VlIGEgbmVhciBzdG9yYWdlIGNvbW1hbmQgcmVx
dWVzdA0KPiArICoNCj4gKyAqIHNjbV9kYXRhOiBhIHBvaW50ZXIgdG8gdGhlIFNDTSBkZXZpY2Ug
ZGF0YQ0KPiArICogb3BfY29kZTogVGhlIG9wLWNvZGUgZm9yIHRoZSBjb21tYW5kDQo+ICsgKg0K
PiArICogUmV0dXJucyBhbiBpZGVudGlmaWVyIGZvciB0aGUgY29tbWFuZCwgb3IgbmVnYXRpdmUg
b24gZXJyb3INCj4gKyAqLw0KPiAraW50IHNjbV9uc19jb21tYW5kX3JlcXVlc3Qoc3RydWN0IHNj
bV9kYXRhICpzY21fZGF0YSwgdTggb3BfY29kZSk7DQo+ICsNCj4gKy8qKg0KPiArICogVmFsaWRh
dGUgYSBuZWFyIHN0b3JhZ2UgcmVzcG9uc2UNCj4gKyAqDQo+ICsgKiBzY21fZGF0YTogYSBwb2lu
dGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqDQo+ICsgKiBSZXR1cm5zIHRoZSBzdGF0
dXMgY29kZSBvZiB0aGUgY29tbWFuZCwgb3IgbmVnYXRpdmUgb24gZXJyb3INCj4gKyAqLw0KPiAr
aW50IHNjbV9uc19yZXNwb25zZShjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKTsNCj4g
Kw0KPiArLyoqDQo+ICsgKiBOb3RpZnkgdGhlIGNvbnRyb2xsZXIgdG8gc3RhcnQgcHJvY2Vzc2lu
ZyBhIHBlbmRpbmcgbmVhciBzdG9yYWdlIGNvbW1hbmQNCj4gKyAqDQo+ICsgKiBzY21fZGF0YTog
YSBwb2ludGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqDQo+ICsgKiBSZXR1cm5zIDAg
b24gc3VjY2VzcywgbmVnYXRpdmUgb24gZXJyb3INCj4gKyAqLw0KPiAraW50IHNjbV9uc19jb21t
YW5kX2V4ZWN1dGUoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSk7DQo+ICsNCj4gKy8q
Kg0KPiArICogSXMgYSBuZWFyIHN0b3JhZ2UgY29tbWFuZCBleGVjdXRpbmcNCj4gKyAqDQo+ICsg
KiBzY21fZGF0YTogYSBwb2ludGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqDQo+ICsg
KiBSZXR1cm5zIHRydWUgaWYgdGhlIHByZXZpb3VzIGFkbWluIGNvbW1hbmQgaGFzIGNvbXBsZXRl
ZA0KPiArICovDQo+ICtib29sIHNjbV9uc19jb21tYW5kX2NvbXBsZXRlKGNvbnN0IHN0cnVjdCBz
Y21fZGF0YSAqc2NtX2RhdGEpOw0KPiArDQo+ICsvKioNCj4gKyAqIE5vdGlmeSB0aGUgY29udHJv
bGxlciB0aGF0IHRoZSBuZWFyIHN0b3JhZ2UgcmVzcG9uc2UgaGFzIGJlZW4gaGFuZGxlZA0KPiAr
ICoNCj4gKyAqIHNjbV9kYXRhOiBhIHBvaW50ZXIgdG8gdGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiAr
ICoNCj4gKyAqIFJldHVybnMgMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBmYWlsdXJlDQo+ICsg
Ki8NCj4gK2ludCBzY21fbnNfcmVzcG9uc2VfaGFuZGxlZChjb25zdCBzdHJ1Y3Qgc2NtX2RhdGEg
KnNjbV9kYXRhKTsNCj4gKw0KPiArLyoqDQo+ICsgKiBFbWl0IGEga2VybmVsIHdhcm5pbmcgc2hv
d2luZyBhIGNvbW1hbmQgc3RhdHVzLg0KPiArICoNCj4gKyAqIHNjbV9kYXRhOiBhIHBvaW50ZXIg
dG8gdGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiArICogbWVzc2FnZTogQSBtZXNzYWdlIHRvIGFjY29t
cGFueSB0aGUgd2FybmluZw0KPiArICogc3RhdHVzOiBUaGUgY29tbWFuZCBzdGF0dXMNCj4gKyAq
Lw0KPiArdm9pZCBzY21fd2Fybl9zdGF0dXMoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0
YSwgY29uc3QgY2hhciAqbWVzc2FnZSwNCj4gKwkJICAgICB1OCBzdGF0dXMpOw0KPiArDQo+ICsv
KioNCj4gKyAqIEVtaXQgYSBrZXJuZWwgd2FybmluZyBzaG93aW5nIGEgY29tbWFuZCBzdGF0dXMu
DQo+ICsgKg0KPiArICogc2NtX2RhdGE6IGEgcG9pbnRlciB0byB0aGUgU0NNIGRldmljZSBkYXRh
DQo+ICsgKiBtZXNzYWdlOiBBIG1lc3NhZ2UgdG8gYWNjb21wYW55IHRoZSB3YXJuaW5nDQo+ICsg
KiBzdGF0dXM6IFRoZSBjb21tYW5kIHN0YXR1cw0KPiArICovDQo+ICt2b2lkIHNjbV93YXJuX3N0
YXR1c19md191cGRhdGUoY29uc3Qgc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSwNCj4gKwkJCSAg
ICAgICBjb25zdCBjaGFyICptZXNzYWdlLCB1OCBzdGF0dXMpOw0KPiArDQo+ICsvKioNCj4gKyAq
IFJlcXVlc3QgYSBjb250cm9sbGVyIGR1bXANCj4gKyAqDQo+ICsgKiBzY21fZGF0YTogYSBwb2lu
dGVyIHRvIHRoZSBTQ00gZGV2aWNlIGRhdGENCj4gKyAqLw0KPiAraW50IHNjbV9yZXF1ZXN0X2Nv
bnRyb2xsZXJfZHVtcChzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhKTsNCj4gKw0KPiArLyoqDQo+
ICsgKiBSZXF1ZXN0IGhlYWx0aCAmIHBlcmZvcm1hbmNlIGRhdGEgKHRoaXMgd2lsbCBlbWl0IGVy
cm9yIGxvZ3Mgd2l0aCB0aGUgaW5mb3JtYXRpb24pDQo+ICsgKg0KPiArICogc2NtX2RhdGE6IGEg
cG9pbnRlciB0byB0aGUgU0NNIGRldmljZSBkYXRhDQo+ICsgKi8NCj4gK2ludCBzY21fcmVxX2Nv
bnRyb2xsZXJfaGVhbHRoX3BlcmYoc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSk7DQo+ICsNCj4g
Kw0KPiArLyoqDQo+ICsgKiBzY21fb3ZlcndyaXRlKCkgLSBPdmVyd3JpdGUgYWxsIGRhdGEgb24g
dGhlIGNhcmQNCj4gKyAqIEBzY21fZGF0YTogVGhlIFNDTSBkZXZpY2UgZGF0YQ0KPiArICogUmV0
dXJuOiAwIG9uIHN1Y2Nlc3MNCj4gKyAqLw0KPiAraW50IHNjbV9vdmVyd3JpdGUoc3RydWN0IHNj
bV9kYXRhICpzY21fZGF0YSk7DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL252ZGltbS9vY3hsLXNj
bV9zeXNmcy5jIGIvZHJpdmVycy9udmRpbW0vb2N4bC1zY21fc3lzZnMuYw0KPiBuZXcgZmlsZSBt
b2RlIDEwMDY0NA0KPiBpbmRleCAwMDAwMDAwMDAwMDAuLjA4MGJiZGViMGU1Ng0KPiAtLS0gL2Rl
di9udWxsDQo+ICsrKyBiL2RyaXZlcnMvbnZkaW1tL29jeGwtc2NtX3N5c2ZzLmMNCj4gQEAgLTAs
MCArMSwyMTkgQEANCj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KPiAr
Ly8gQ29weXJpZ2h0IDIwMTggSUJNIENvcnAuDQo+ICsNCj4gKyNpbmNsdWRlIDxsaW51eC9zeXNm
cy5oPg0KPiArI2luY2x1ZGUgPGxpbnV4L2NhcGFiaWxpdHkuaD4NCj4gKyNpbmNsdWRlIDxsaW51
eC9saW1pdHMuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9maXJtd2FyZS5oPg0KPiArI2luY2x1ZGUg
Im9jeGwtc2NtX2ludGVybmFsLmgiDQo+ICsNCj4gK3N0YXRpYyBzc2l6ZV90IGFkbWluX2NvbW1h
bmRfYnVmZmVyX3NpemVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXZpY2UsDQo+ICsJc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsDQo+ICsJY2hhciAqYnVmKQ0KPiArew0KPiArCXN0cnVjdCBz
Y21fZGF0YSAqc2NtX2RhdGEgPSBjb250YWluZXJfb2YoZGV2aWNlLCBzdHJ1Y3Qgc2NtX2RhdGEs
IGRldik7DQo+ICsNCj4gKwlyZXR1cm4gc2NucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRcbiIs
IHNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmRhdGFfc2l6ZSk7DQo+ICt9DQo+ICsNCj4gK3N0YXRp
YyBzc2l6ZV90IGZ3X3ZlcnNpb25fc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXZpY2UsDQo+ICsJCQkg
ICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikNCj4gK3sNCj4g
KwlzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhID0gY29udGFpbmVyX29mKGRldmljZSwgc3RydWN0
IHNjbV9kYXRhLCBkZXYpOw0KPiArDQo+ICsJcmV0dXJuIHNjbnByaW50ZihidWYsIFBBR0VfU0la
RSwgIiVzXG4iLCBzY21fZGF0YS0+ZndfdmVyc2lvbik7DQo+ICt9DQo+ICsNCj4gKyNkZWZpbmUg
U0NNX0ZXVVBEQVRFX0JMT0NLX1NJWkUJMzI3NjgNCj4gKw0KPiArLyoqDQo+ICsgKiBzY21fdXBk
YXRlX2Zpcm13YXJlKCkgLSBXcml0ZSBhIDMya0IgYmxvY2sgb2YgZGF0YSB0byBmaXJtd2FyZQ0K
PiArICogVGhlIGJsb2NrIG1heSBiZSBsZXNzIHRoYW4gMzJrQiBpZiBpdCBpcyB0aGUgbGFzdCBv
bmUNCj4gKyAqDQo+ICsgKiBzY21fZGF0YSB0aGUgU0NNIGRldmljZSBtZXRhZGF0YQ0KPiArICog
b2Zmc2V0OiB0aGUgb2Zmc2V0IG9mIHRoZSBzdGFydCBvZiB0aGUgYmxvY2sNCj4gKyAqIGJ1Zjog
dGhlIGJsb2NrIGRhdGENCj4gKyAqIHNpemU6IHRoZSBzaXplIG9mIHRoZSBibG9jaw0KPiArICov
DQo+ICtzdGF0aWMgc3NpemVfdCBzY21fdXBkYXRlX2Zpcm13YXJlKHN0cnVjdCBzY21fZGF0YSAq
c2NtX2RhdGEsIHNpemVfdCBvZmZzZXQsDQo+ICsJCQkJICAgY29uc3QgY2hhciAqYnVmLCBzaXpl
X3Qgc2l6ZSkNCj4gK3sNCj4gKwlpbnQgcmM7DQo+ICsJc2l6ZV90IGk7DQo+ICsJdTY0IHZhbDsN
Cj4gKw0KPiArCWlmIChzaXplID4gU0NNX0ZXVVBEQVRFX0JMT0NLX1NJWkUpDQo+ICsJCXJldHVy
biAtRUlOVkFMOw0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fY29tbWFuZF9yZXF1ZXN0KHNjbV9k
YXRhLCBBRE1JTl9DT01NQU5EX0ZXX1VQREFURSk7DQo+ICsJaWYgKHJjKQ0KPiArCQlyZXR1cm4g
cmM7DQo+ICsNCj4gKwl2YWwgPSAoKCh1NjQpb2Zmc2V0KSA8PCAzMikgfCBzaXplOw0KPiArCXJj
ID0gb2N4bF9nbG9iYWxfbW1pb193cml0ZTY0KHNjbV9kYXRhLT5vY3hsX2FmdSwNCj4gKwkJCQkg
ICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFuZC5yZXF1ZXN0X29mZnNldCArIDgsDQo+ICsJCQkJ
ICAgICAgT0NYTF9MSVRUTEVfRU5ESUFOLCB2YWwpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0dXJu
IHJjOw0KPiArDQo+ICsJZm9yIChpID0gMDsgaSA8IHNpemU7IGkgKz0gOCkgew0KPiArCQl2YWwg
PSAqKHU2NCAqKShidWYgKyBpKTsNCj4gKwkJcmMgPSBvY3hsX2dsb2JhbF9tbWlvX3dyaXRlNjQo
c2NtX2RhdGEtPm9jeGxfYWZ1LA0KPiArCQkJCQkgICAgICBzY21fZGF0YS0+YWRtaW5fY29tbWFu
ZC5kYXRhX29mZnNldCArIGksDQo+ICsJCQkJCSAgICAgIE9DWExfSE9TVF9FTkRJQU4sIHZhbCk7
DQo+ICsJCWlmIChyYykNCj4gKwkJCXJldHVybiByYzsNCj4gKwl9DQo+ICsNCj4gKwlyYyA9IHNj
bV9hZG1pbl9jb21tYW5kX2V4ZWN1dGUoc2NtX2RhdGEpOw0KPiArCWlmIChyYykNCj4gKwkJcmV0
dXJuIHJjOw0KPiArDQo+ICsJcmMgPSBzY21fYWRtaW5fY29tbWFuZF9jb21wbGV0ZV90aW1lb3V0
KHNjbV9kYXRhLA0KPiArCQkJCQkJQURNSU5fQ09NTUFORF9GV19VUERBVEUpOw0KPiArCWlmIChy
YyA8IDApIHsNCj4gKwkJZGV2X2Vycigmc2NtX2RhdGEtPmRldiwgIkZpcm13YXJlIHVwZGF0ZSB0
aW1lb3V0XG4iKTsNCj4gKwkJcmV0dXJuIHJjOw0KPiArCX0NCj4gKw0KPiArCXJjID0gc2NtX2Fk
bWluX3Jlc3BvbnNlKHNjbV9kYXRhKTsNCj4gKwlpZiAocmMgPCAwKQ0KPiArCQlyZXR1cm4gcmM7
DQo+ICsJaWYgKHJjICE9IFNUQVRVU19TVUNDRVNTKSB7DQo+ICsJCXNjbV93YXJuX3N0YXR1c19m
d191cGRhdGUoc2NtX2RhdGEsICJGVyBVcGRhdGUiLCByYyk7DQo+ICsJCXJldHVybiByYzsNCj4g
Kwl9DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArLyoNCj4gKyAqIFBhcnNlIG91
dCBhIGZpcm13YXJlIGZpbGVuYW1lIGZyb20gc3lzZnMsIHJldHJpZXZlIGl0J3MgY29udGVudHMg
YW5kIHdyaXRlIGl0DQo+ICsgKiB0byB0aGUgU0NNIGRldmljZSBmaXJtd2FyZSBzdG9yYWdlDQo+
ICsgKi8NCj4gK3N0YXRpYyBzc2l6ZV90IGZ3X3VwZGF0ZV9maWxlbmFtZV9zdG9yZShzdHJ1Y3Qg
ZGV2aWNlICpkZXZpY2UsDQo+ICsJCQkJCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLA0K
PiArCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBzaXplKQ0KPiArew0KPiArCWNoYXIgcGF0
aFtOQU1FX01BWCsxXTsNCj4gKwljb25zdCBjaGFyICplbmQ7DQo+ICsJY29uc3Qgc3RydWN0IGZp
cm13YXJlICpmaXJtd2FyZSA9IE5VTEw7DQo+ICsJc2l6ZV90IG9mZnNldDsNCj4gKwlpbnQgcmM7
DQo+ICsJc3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSA9IGNvbnRhaW5lcl9vZihkZXZpY2UsIHN0
cnVjdCBzY21fZGF0YSwgZGV2KTsNCj4gKw0KPiArCWlmICghY2FwYWJsZShDQVBfU1lTX0FETUlO
KSkNCj4gKwkJcmV0dXJuIC1FQUNDRVM7DQo+ICsNCj4gKwllbmQgPSBzdHJuY2hyKGJ1Ziwgc2l6
ZSwgJ1xuJyk7DQo+ICsJaWYgKGVuZCA9PSBOVUxMKQ0KPiArCQllbmQgPSBidWYgKyBzdHJubGVu
KGJ1Ziwgc2l6ZSk7DQo+ICsNCj4gKwlpZiAoKGVuZCAtIGJ1ZikgPiBOQU1FX01BWCkgew0KPiAr
CQlkZXZfZXJyKGRldmljZSwgIkZpcm13YXJlIGZpbGVuYW1lICclLS4qcycgdG9vIGxvbmdcbiIs
DQo+ICsJCQkoaW50KShlbmQgLSBidWYpLCBidWYpOw0KPiArCQlyZXR1cm4gLUVJTzsNCj4gKwl9
DQo+ICsNCj4gKwltZW1jcHkocGF0aCwgYnVmLCBlbmQgLSBidWYpOw0KPiArCXBhdGhbZW5kIC0g
YnVmXSA9ICdcMCc7DQo+ICsNCj4gKwlpZiAocmVxdWVzdF9maXJtd2FyZSgmZmlybXdhcmUsIHBh
dGgsIGRldmljZSkpIHsNCj4gKwkJZGV2X2VycihkZXZpY2UsICJGaXJtd2FyZSBmaWxlICVzIG5v
dCBmb3VuZFxuIiwgcGF0aCk7DQo+ICsJCXJldHVybiAtRUlPOw0KPiArCX0NCj4gKw0KPiArCWlm
IChmaXJtd2FyZS0+c2l6ZSAlIDgpIHsNCj4gKwkJcmVsZWFzZV9maXJtd2FyZShmaXJtd2FyZSk7
DQo+ICsJCWRldl9lcnIoZGV2aWNlLCAiRmlybXdhcmUgJyVzJyBzaG91bGQgYmUgYSBtdWx0aXBs
ZSBvZiA4IGJ5dGVzIiwgcGF0aCk7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0K
PiArCW11dGV4X2xvY2soJnNjbV9kYXRhLT5hZG1pbl9jb21tYW5kLmxvY2spOw0KPiArDQo+ICsJ
Zm9yIChvZmZzZXQgPSAwOyBvZmZzZXQgPCBmaXJtd2FyZS0+c2l6ZTsgb2Zmc2V0ICs9IFNDTV9G
V1VQREFURV9CTE9DS19TSVpFKSB7DQo+ICsJCXNpemVfdCByZW1haW5kZXIgPSBmaXJtd2FyZS0+
c2l6ZSAtIG9mZnNldDsNCj4gKwkJc2l6ZV90IGJsb2NrX3NpemU7DQo+ICsNCj4gKwkJYmxvY2tf
c2l6ZSA9IChyZW1haW5kZXIgPiBTQ01fRldVUERBVEVfQkxPQ0tfU0laRSkgPw0KPiArCQkJICAg
ICAgU0NNX0ZXVVBEQVRFX0JMT0NLX1NJWkUgOiByZW1haW5kZXI7DQo+ICsJCXJjID0gc2NtX3Vw
ZGF0ZV9maXJtd2FyZShzY21fZGF0YSwgb2Zmc2V0LA0KPiArCQkJCQkgZmlybXdhcmUtPmRhdGEg
KyBvZmZzZXQsIGJsb2NrX3NpemUpOw0KPiArCQlpZiAocmMpIHsNCj4gKwkJCW11dGV4X3VubG9j
aygmc2NtX2RhdGEtPmFkbWluX2NvbW1hbmQubG9jayk7DQo+ICsJCQlyZXR1cm4gLUVGQVVMVDsN
Cj4gKwkJfQ0KPiArCX0NCj4gKw0KPiArCW11dGV4X3VubG9jaygmc2NtX2RhdGEtPmFkbWluX2Nv
bW1hbmQubG9jayk7DQo+ICsNCj4gKwlyZXR1cm4gc2l6ZTsNCj4gK30NCj4gKw0KPiArLyoNCj4g
KyAqIFRyaWdnZXIgYSBjb250cm9sbGVyIGR1bXANCj4gKyAqLw0KPiArc3RhdGljIHNzaXplX3Qg
Y29udHJvbGxlcl9kdW1wX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldmljZSwNCj4gKwkJCQkgICAg
IHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLA0KPiArCQkJCSAgICAgY29uc3QgY2hhciAq
YnVmLCBzaXplX3Qgc2l6ZSkNCj4gK3sNCj4gKwlzdHJ1Y3Qgc2NtX2RhdGEgKnNjbV9kYXRhID0g
Y29udGFpbmVyX29mKGRldmljZSwgc3RydWN0IHNjbV9kYXRhLCBkZXYpOw0KPiArDQo+ICsJc2Nt
X3JlcXVlc3RfY29udHJvbGxlcl9kdW1wKHNjbV9kYXRhKTsNCj4gKw0KPiArCXJldHVybiBzaXpl
Ow0KPiArfQ0KPiArDQo+ICsvKg0KPiArICogUmVxdWVzdCBoZWFsdGggJiBwZXJmb3JtYW5jZSBk
YXRhDQo+ICsgKi8NCj4gK3N0YXRpYyBzc2l6ZV90IGhlYWx0aF9yZXF1ZXN0X3N0b3JlKHN0cnVj
dCBkZXZpY2UgKmRldmljZSwNCj4gKwkJCQkgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0
dHIsDQo+ICsJCQkJICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IHNpemUpDQo+ICt7DQo+ICsJ
c3RydWN0IHNjbV9kYXRhICpzY21fZGF0YSA9IGNvbnRhaW5lcl9vZihkZXZpY2UsIHN0cnVjdCBz
Y21fZGF0YSwgZGV2KTsNCj4gKw0KPiArCXNjbV9yZXFfY29udHJvbGxlcl9oZWFsdGhfcGVyZihz
Y21fZGF0YSk7DQo+ICsNCj4gKwlyZXR1cm4gc2l6ZTsNCj4gK30NCj4gKw0KPiArLyoNCj4gKyAq
IE92ZXJ3cml0ZSBhbGwgbWVkaWENCj4gKyAqLw0KPiArc3RhdGljIHNzaXplX3Qgb3ZlcndyaXRl
X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldmljZSwNCj4gKwkJCSAgICAgICBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0ciwNCj4gKwkJCSAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBz
aXplKQ0KPiArew0KPiArCXN0cnVjdCBzY21fZGF0YSAqc2NtX2RhdGEgPSBjb250YWluZXJfb2Yo
ZGV2aWNlLCBzdHJ1Y3Qgc2NtX2RhdGEsIGRldik7DQo+ICsNCj4gKwlzY21fb3ZlcndyaXRlKHNj
bV9kYXRhKTsNCj4gKw0KPiArCXJldHVybiBzaXplOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgc2NtX2F0dHJzW10gPSB7DQo+ICsJX19BVFRSX1JPKGFkbWlu
X2NvbW1hbmRfYnVmZmVyX3NpemUpLA0KPiArCV9fQVRUUl9STyhmd192ZXJzaW9uKSwNCj4gKwlf
X0FUVFJfV08oZndfdXBkYXRlX2ZpbGVuYW1lKSwNCj4gKwlfX0FUVFJfV08oY29udHJvbGxlcl9k
dW1wKSwNCj4gKwlfX0FUVFJfV08oaGVhbHRoX3JlcXVlc3QpLA0KPiArCV9fQVRUUl9XTyhvdmVy
d3JpdGUpLA0KPiArfTsNCj4gKw0KPiAraW50IHNjbV9zeXNmc19hZGQoc3RydWN0IHNjbV9kYXRh
ICpzY21fZGF0YSkNCj4gK3sNCj4gKwlpbnQgaSwgcmM7DQo+ICsNCj4gKwlmb3IgKGkgPSAwOyBp
IDwgQVJSQVlfU0laRShzY21fYXR0cnMpOyBpKyspIHsNCj4gKwkJcmMgPSBkZXZpY2VfY3JlYXRl
X2ZpbGUoJnNjbV9kYXRhLT5kZXYsICZzY21fYXR0cnNbaV0pOw0KPiArCQlpZiAocmMpIHsNCj4g
KwkJCWZvciAoOyAtLWkgPj0gMDspDQo+ICsJCQkJZGV2aWNlX3JlbW92ZV9maWxlKCZzY21fZGF0
YS0+ZGV2LCAmc2NtX2F0dHJzW2ldKTsNCj4gKw0KPiArCQkJcmV0dXJuIHJjOw0KPiArCQl9DQo+
ICsJfQ0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArRVhQT1JUX1NZTUJPTF9HUEwoc2NtX3N5c2Zz
X2FkZCk7DQo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL3VhcGkvbGludXgvb2N4bC1zY20uaCBiL2lu
Y2x1ZGUvdWFwaS9saW51eC9vY3hsLXNjbS5oDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGlu
ZGV4IDAwMDAwMDAwMDAwMC4uNmRjN2U1MTk2ZGEyDQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIv
aW5jbHVkZS91YXBpL2xpbnV4L29jeGwtc2NtLmgNCj4gQEAgLTAsMCArMSwxMjggQEANCj4gKy8q
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKyBXSVRIIExpbnV4LXN5c2NhbGwtbm90
ZSAqLw0KPiArLyogQ29weXJpZ2h0IDIwMTcgSUJNIENvcnAuICovDQo+ICsjaWZuZGVmIF9VQVBJ
X09DWExfU0NNX0gNCj4gKyNkZWZpbmUgX1VBUElfT0NYTF9TQ01fSA0KPiArDQo+ICsjaW5jbHVk
ZSA8bGludXgvdHlwZXMuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9pb2N0bC5oPg0KPiArDQo+ICtl
bnVtIHNjbV9md2RlYnVnX2FjdGlvbiB7DQo+ICsJU0NNX0ZXREVCVUdfUkVBRF9DT05UUk9MTEVS
X01FTU9SWSA9IDB4MDEsDQo+ICsJU0NNX0ZXREVCVUdfV1JJVEVfQ09OVFJPTExFUl9NRU1PUlkg
PSAweDAyLA0KPiArCVNDTV9GV0RFQlVHX0VOQUJMRV9GVU5DVElPTiA9IDB4MDMsDQo+ICsJU0NN
X0ZXREVCVUdfRElTQUJMRV9GVU5DVElPTiA9IDB4MDQsDQo+ICsJU0NNX0ZXREVCVUdfR0VUX1BF
TCA9IDB4MDUsIC8vIFJldHJpZXZlIFBlcnNpc3RlbnQgRXJyb3IgTG9nDQo+ICt9Ow0KPiArDQo+
ICtzdHJ1Y3Qgc2NtX2lvY3RsX2J1ZmZlcl9pbmZvIHsNCj4gKwlfX3UzMglhZG1pbl9jb21tYW5k
X2J1ZmZlcl9zaXplOyAvLyBvdXQNCj4gKwlfX3UzMgluZWFyX3N0b3JhZ2VfYnVmZmVyX3NpemU7
IC8vIG91dA0KPiArfTsNCj4gKw0KPiArc3RydWN0IHNjbV9pb2N0bF9md2RlYnVnIHsgLy8gQWxs
IGFyZ3MgYXJlIGlucHV0cw0KPiArCWVudW0gc2NtX2Z3ZGVidWdfYWN0aW9uIGRlYnVnX2FjdGlv
bjsNCj4gKwlfX3UxNiBmdW5jdGlvbl9jb2RlOw0KPiArCV9fdTE2IGJ1Zl9zaXplOyAvLyBTaXpl
IG9mIG9wdGlvbmFsIGRhdGEgYnVmZmVyDQo+ICsJX191NjQgZGVidWdfcGFyYW1ldGVyXzE7DQo+
ICsJX191NjQgZGVidWdfcGFyYW1ldGVyXzI7DQo+ICsJX191OCAqYnVmOyAvLyBQb2ludGVyIHRv
IG9wdGlvbmFsIGluL291dCBkYXRhIGJ1ZmZlcg0KPiArfTsNCj4gKw0KPiArI2RlZmluZSBTQ01f
RVJST1JfTE9HX0FDVElPTl9SRVNFVAkoMSA8PCAoMzItMzIpKQ0KPiArI2RlZmluZSBTQ01fRVJS
T1JfTE9HX0FDVElPTl9DSEtGVwkoMSA8PCAoNTMtMzIpKQ0KPiArI2RlZmluZSBTQ01fRVJST1Jf
TE9HX0FDVElPTl9SRVBMQUNFCSgxIDw8ICg1NC0zMikpDQo+ICsjZGVmaW5lIFNDTV9FUlJPUl9M
T0dfQUNUSU9OX0RVTVAJKDEgPDwgKDU1LTMyKSkNCj4gKw0KPiArI2RlZmluZSBTQ01fRVJST1Jf
TE9HX1RZUEVfR0VORVJBTAkJKDB4MDApDQo+ICsjZGVmaW5lIFNDTV9FUlJPUl9MT0dfVFlQRV9Q
UkVESUNUSVZFX0ZBSUxVUkUJKDB4MDEpDQo+ICsjZGVmaW5lIFNDTV9FUlJPUl9MT0dfVFlQRV9U
SEVSTUFMX1dBUk5JTkcJKDB4MDIpDQo+ICsjZGVmaW5lIFNDTV9FUlJPUl9MT0dfVFlQRV9EQVRB
X0xPU1MJCSgweDAzKQ0KPiArI2RlZmluZSBTQ01fRVJST1JfTE9HX1RZUEVfSEVBTFRIX1BFUkZP
Uk1BTkNFCSgweDA0KQ0KPiArDQo+ICtzdHJ1Y3Qgc2NtX2lvY3RsX2Vycm9yX2xvZyB7DQo+ICsJ
X191MzIgbG9nX2lkZW50aWZpZXI7IC8vIG91dA0KPiArCV9fdTMyIHByb2dyYW1fcmVmZXJlbmNl
X2NvZGU7IC8vIG91dA0KPiArCV9fdTMyIGFjdGlvbl9mbGFnczsgLy9vdXQsIHJlY29tbWVuZGVk
IGNvdXJzZSBvZiBhY3Rpb24NCj4gKwlfX3UzMiBwb3dlcl9vbl9zZWNvbmRzOyAvLyBvdXQsIE51
bWJlciBvZiBzZWNvbmRzIHRoZSBjb250cm9sbGVyIGhhcyBiZWVuIG9uIHdoZW4gdGhlIGVycm9y
IG9jY3VycmVkDQo+ICsJX191NjQgdGltZXN0YW1wOyAvLyBvdXQsIHJlbGF0aXZlIHRpbWUgc2lu
Y2UgdGhlIGN1cnJlbnQgSVBMDQo+ICsJX191NjQgd3dpZFsyXTsgLy8gb3V0LCB0aGUgTkFBIGZv
cm1hdHRlZCBXV0lEIGFzc29jaWF0ZWQgd2l0aCB0aGUgY29udHJvbGxlcg0KPiArCWNoYXIgIGZ3
X3JldmlzaW9uWzgrMV07IC8vIG91dCwgZmlybXdhcmUgcmV2aXNpb24gYXMgbnVsbCB0ZXJtaW5h
dGVkIHRleHQNCj4gKwlfX3UxNiBidWZfc2l6ZTsgLyogaW4vb3V0LCBidWZmZXIgc2l6ZSBwcm92
aWRlZC9yZXF1aXJlZC4NCj4gKwkJCSAqIElmIHJlcXVpcmVkIGlzIGdyZWF0ZXIgdGhhbiBwcm92
aWRlZCwgdGhlIGJ1ZmZlcg0KPiArCQkJICogd2lsbCBiZSB0cnVuY2F0ZWQgdG8gdGhlIGFtb3Vu
dCBwcm92aWRlZC4gSWYgaXRzDQo+ICsJCQkgKiBsZXNzLCB0aGVuIG9ubHkgdGhlIHJlcXVpcmVk
IGJ5dGVzIHdpbGwgYmUgcG9wdWxhdGVkLg0KPiArCQkJICogSWYgaXQgaXMgMCwgdGhlbiB0aGVy
ZSBhcmUgbm8gbW9yZSBlcnJvciBsb2cgZW50cmllcy4NCj4gKwkJCSAqLw0KPiArCV9fdTggIGVy
cm9yX2xvZ190eXBlOw0KPiArCV9fdTggIHJlc2VydmVkMTsNCj4gKwlfX3UzMiByZXNlcnZlZDI7
DQo+ICsJX191NjQgcmVzZXJ2ZWQzWzJdOw0KPiArCV9fdTggKmJ1ZjsgLy8gcG9pbnRlciB0byBv
dXRwdXQgYnVmZmVyDQo+ICt9Ow0KPiArDQo+ICtzdHJ1Y3Qgc2NtX2lvY3RsX2NvbnRyb2xsZXJf
ZHVtcF9kYXRhIHsNCj4gKwlfX3U4ICpidWY7IC8vIHBvaW50ZXIgdG8gb3V0cHV0IGJ1ZmZlcg0K
PiArCV9fdTE2IGJ1Zl9zaXplOyAvKiBpbi9vdXQsIGJ1ZmZlciBzaXplIHByb3ZpZGVkL3JlcXVp
cmVkLg0KPiArCQkJICogSWYgcmVxdWlyZWQgaXMgZ3JlYXRlciB0aGFuIHByb3ZpZGVkLCB0aGUg
YnVmZmVyDQo+ICsJCQkgKiB3aWxsIGJlIHRydW5jYXRlZCB0byB0aGUgYW1vdW50IHByb3ZpZGVk
LiBJZiBpdHMNCj4gKwkJCSAqIGxlc3MsIHRoZW4gb25seSB0aGUgcmVxdWlyZWQgYnl0ZXMgd2ls
bCBiZSBwb3B1bGF0ZWQuDQo+ICsJCQkgKiBJZiBpdCBpcyAwLCB0aGVuIHRoZXJlIGlzIG5vIG1v
cmUgZHVtcCBkYXRhIGF2YWlsYWJsZS4NCj4gKwkJCSAqLw0KPiArCV9fdTMyIG9mZnNldDsgLy8g
aW4sIE9mZnNldCB3aXRoaW4gdGhlIGR1bXANCj4gKwlfX3U2NCByZXNlcnZlZFs4XTsNCj4gK307
DQo+ICsNCj4gK3N0cnVjdCBzY21faW9jdGxfY29udHJvbGxlcl9zdGF0cyB7DQo+ICsJX191MzIg
cmVzZXRfY291bnQ7DQo+ICsJX191MzIgcmVzZXRfdXB0aW1lOyAvLyBzZWNvbmRzDQo+ICsJX191
MzIgcG93ZXJfb25fdXB0aW1lOyAvLyBzZWNvbmRzDQo+ICsJX191NjQgaG9zdF9sb2FkX2NvdW50
Ow0KPiArCV9fdTY0IGhvc3Rfc3RvcmVfY291bnQ7DQo+ICsJX191NjQgbWVkaWFfcmVhZF9jb3Vu
dDsNCj4gKwlfX3U2NCBtZWRpYV93cml0ZV9jb3VudDsNCj4gKwlfX3U2NCBjYWNoZV9oaXRfY291
bnQ7DQo+ICsJX191NjQgY2FjaGVfbWlzc19jb3VudDsNCj4gKwlfX3U2NCBtZWRpYV9yZWFkX2xh
dGVuY3k7IC8vIG5hbm9zZWNvbmRzDQo+ICsJX191NjQgbWVkaWFfd3JpdGVfbGF0ZW5jeTsgLy8g
bmFub3NlY29uZHMNCj4gKwlfX3U2NCBjYWNoZV9yZWFkX2xhdGVuY3k7IC8vIG5hbm9zZWNvbmRz
DQo+ICsJX191NjQgY2FjaGVfd3JpdGVfbGF0ZW5jeTsgLy8gbmFub3NlY29uZHMNCj4gK307DQo+
ICsNCj4gK3N0cnVjdCBzY21faW9jdGxfbW1pbyB7DQo+ICsJX191NjQgYWRkcmVzczsgLy8gT2Zm
c2V0IGluIGdsb2JhbCBNTUlPIHNwYWNlDQo+ICsJX191NjQgdmFsOyAvLyB2YWx1ZSB0byB3cml0
ZS93YXMgcmVhZA0KPiArfTsNCj4gKw0KPiArc3RydWN0IHNjbV9pb2N0bF9ldmVudGZkIHsNCj4g
KwlfX3MzMiBldmVudGZkOw0KPiArCV9fdTMyIHJlc2VydmVkOw0KPiArfTsNCj4gKw0KPiArI2lm
bmRlZiBCSVRfVUxMDQo+ICsjZGVmaW5lIEJJVF9VTEwobnIpCSgxVUxMIDw8IChucikpDQo+ICsj
ZW5kaWYNCj4gKw0KPiArI2RlZmluZSBTQ01fSU9DVExfRVZFTlRfQ09OVFJPTExFUl9EVU1QX0FW
QUlMQUJMRQlCSVRfVUxMKDApDQo+ICsjZGVmaW5lIFNDTV9JT0NUTF9FVkVOVF9FUlJPUl9MT0df
QVZBSUxBQkxFCQlCSVRfVUxMKDEpDQo+ICsjZGVmaW5lIFNDTV9JT0NUTF9FVkVOVF9IQVJEV0FS
RV9GQVRBTAkJCUJJVF9VTEwoMikNCj4gKyNkZWZpbmUgU0NNX0lPQ1RMX0VWRU5UX0ZJUk1XQVJF
X0ZBVEFMCQkJQklUX1VMTCgzKQ0KPiArDQo+ICsvKiBpb2N0bCBudW1iZXJzICovDQo+ICsjZGVm
aW5lIFNDTV9NQUdJQyAweDVDDQo+ICsvKiBTQ00gZGV2aWNlcyAqLw0KPiArI2RlZmluZSBTQ01f
SU9DVExfQlVGRkVSX0lORk8JX0lPUihTQ01fTUFHSUMsIDB4MDAsIHN0cnVjdCBzY21faW9jdGxf
YnVmZmVyX2luZm8pDQo+ICsjZGVmaW5lIFNDTV9JT0NUTF9FUlJPUl9MT0cJX0lPV1IoU0NNX01B
R0lDLCAweDAxLCBzdHJ1Y3Qgc2NtX2lvY3RsX2Vycm9yX2xvZykNCj4gKyNkZWZpbmUgU0NNX0lP
Q1RMX0NPTlRST0xMRVJfRFVNUCBfSU8oU0NNX01BR0lDLCAweDAyKQ0KPiArI2RlZmluZSBTQ01f
SU9DVExfQ09OVFJPTExFUl9EVU1QX0RBVEEgX0lPV1IoU0NNX01BR0lDLCAweDAzLCBzdHJ1Y3Qg
c2NtX2lvY3RsX2NvbnRyb2xsZXJfZHVtcF9kYXRhKQ0KPiArI2RlZmluZSBTQ01fSU9DVExfQ09O
VFJPTExFUl9EVU1QX0NPTVBMRVRFIF9JTyhTQ01fTUFHSUMsIDB4MDQpDQo+ICsjZGVmaW5lIFND
TV9JT0NUTF9DT05UUk9MTEVSX1NUQVRTIF9JTyhTQ01fTUFHSUMsIDB4MDUpDQo+ICsjZGVmaW5l
IFNDTV9JT0NUTF9FVkVOVEZECV9JT1coU0NNX01BR0lDLCAweDA2LCBzdHJ1Y3Qgc2NtX2lvY3Rs
X2V2ZW50ZmQpDQo+ICsjZGVmaW5lIFNDTV9JT0NUTF9FVkVOVF9DSEVDSwlfSU9SKFNDTV9NQUdJ
QywgMHgwNywgX191NjQpDQo+ICsjZGVmaW5lIFNDTV9JT0NUTF9SRVFVRVNUX0hFQUxUSCBfSU8o
U0NNX01BR0lDLCAweDA4KQ0KPiArDQo+ICsjZGVmaW5lIFNDTV9JT0NUTF9GV0RFQlVHCV9JT1dS
KFNDTV9NQUdJQywgMHhmMCwgc3RydWN0IHNjbV9pb2N0bF9md2RlYnVnKQ0KPiArI2RlZmluZSBT
Q01fSU9DVExfTU1JT19XUklURQlfSU9XKFNDTV9NQUdJQywgMHhmMSwgc3RydWN0IHNjbV9pb2N0
bF9tbWlvKQ0KPiArI2RlZmluZSBTQ01fSU9DVExfTU1JT19SRUFECV9JT1dSKFNDTV9NQUdJQywg
MHhmMiwgc3RydWN0IHNjbV9pb2N0bF9tbWlvKQ0KPiArI2RlZmluZSBTQ01fSU9DVExfU0hVVERP
V04JX0lPKFNDTV9NQUdJQywgMHhmMykNCj4gKw0KPiArI2VuZGlmIC8qIF9VQVBJX09DWExfU0NN
X0ggKi8NCj4gZGlmZiAtLWdpdCBhL21tL21lbW9yeV9ob3RwbHVnLmMgYi9tbS9tZW1vcnlfaG90
cGx1Zy5jDQo+IGluZGV4IGIzOTgyN2RiZDA3MS4uMzc2NTAwZjRlM2EyIDEwMDY0NA0KPiAtLS0g
YS9tbS9tZW1vcnlfaG90cGx1Zy5jDQo+ICsrKyBiL21tL21lbW9yeV9ob3RwbHVnLmMNCj4gQEAg
LTI3OSw3ICsyNzksNyBAQCBzdGF0aWMgaW50IGNoZWNrX3Bmbl9zcGFuKHVuc2lnbmVkIGxvbmcg
cGZuLCB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzLA0KPiAgIH0NCj4gICANCj4gICBpbnQgY2hlY2tf
aG90cGx1Z19tZW1vcnlfYWRkcmVzc2FibGUodW5zaWduZWQgbG9uZyBwZm4sDQo+IC0JCQkJCSAg
ICB1bnNpZ25lZCBsb25nIG5yX3BhZ2VzKQ0KPiArCQkJCSAgICAgdW5zaWduZWQgbG9uZyBucl9w
YWdlcykNCj4gICB7DQo+ICAgCWNvbnN0IHU2NCBtYXhfYWRkciA9IFBGTl9QSFlTKHBmbiArIG5y
X3BhZ2VzKSAtIDE7DQo+ICAgDQo+IA0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KTGludXgtbnZkaW1tIG1haWxpbmcgbGlzdCAtLSBsaW51eC1udmRpbW1A
bGlzdHMuMDEub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1haWwgdG8gbGludXgtbnZkaW1t
LWxlYXZlQGxpc3RzLjAxLm9yZwo=
